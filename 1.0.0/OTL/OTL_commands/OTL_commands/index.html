
<!doctype html>
<html lang="ru" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://example.com/1.0.0/OTL/OTL_commands/OTL_commands/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>Команды языка OTL - WDC.Платформа. Документация</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Перейти к содержанию
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
            <div class="md-banner__inner md-grid md-typeset">
              
  Вы просматриваете не актуальную версию документации.
  <a href="../../../.."> 
    <strong>Нажмите здесь что бы переключится на актуальную.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          
        </aside>
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Верхний колонтитул">
    <a href="../../.." title="WDC.Платформа. Документация" class="md-header__button md-logo" aria-label="WDC.Платформа. Документация" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WDC.Платформа. Документация
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Команды языка OTL
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Поиск" placeholder="Поиск" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Поиск">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Очистить" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Инициализация поиска
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Вкладки" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      WDC.Платформа
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../General/General_description/General_description/" class="md-tabs__link">
        Общие описания
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="./" class="md-tabs__link md-tabs__link--active">
        Языки OTL и SMaLL
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../Optional/GrafanaPlugin/GrafanaPlugin/" class="md-tabs__link">
        Компоненты WDC.Платформы
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Навигация" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="WDC.Платформа. Документация" class="md-nav__button md-logo" aria-label="WDC.Платформа. Документация" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    WDC.Платформа. Документация
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        WDC.Платформа
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          Общие описания
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Общие описания" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Общие описания
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../General/General_description/General_description/" class="md-nav__link">
        Общее описание WDC.Платформы
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../General/Installation/Install/" class="md-nav__link">
        Установка WDC.Платформы
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../General/Beginning/Beginning_of_work/" class="md-nav__link">
        Начало работы с WDC.Платформой
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../General/EVA/EVA/" class="md-nav__link">
        EVA
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Языки OTL и SMaLL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Языки OTL и SMaLL" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Языки OTL и SMaLL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Команды языка OTL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Команды языка OTL
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Содержание раздела">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Содержание раздела
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#otl" class="md-nav__link">
    Команды языка OTL
  </a>
  
    <nav class="md-nav" aria-label="Команды языка OTL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    Введение
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#addcoltotals" class="md-nav__link">
    ADDCOLTOTALS
  </a>
  
    <nav class="md-nav" aria-label="ADDCOLTOTALS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#addinfo" class="md-nav__link">
    ADDINFO
  </a>
  
    <nav class="md-nav" aria-label="ADDINFO">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#addtotals" class="md-nav__link">
    ADDTOTALS
  </a>
  
    <nav class="md-nav" aria-label="ADDTOTALS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#append-union" class="md-nav__link">
    APPEND (UNION)
  </a>
  
    <nav class="md-nav" aria-label="APPEND (UNION)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendcols" class="md-nav__link">
    APPENDCOLS
  </a>
  
    <nav class="md-nav" aria-label="APPENDCOLS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendpipe" class="md-nav__link">
    APPENDPIPE
  </a>
  
    <nav class="md-nav" aria-label="APPENDPIPE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bin" class="md-nav__link">
    BIN
  </a>
  
    <nav class="md-nav" aria-label="BIN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chart" class="md-nav__link">
    CHART
  </a>
  
    <nav class="md-nav" aria-label="CHART">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    Синтаксис команды
  </a>
  
    <nav class="md-nav" aria-label="Синтаксис команды">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    Статистические функции
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#collect" class="md-nav__link">
    COLLECT
  </a>
  
    <nav class="md-nav" aria-label="COLLECT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command" class="md-nav__link">
    COMMAND
  </a>
  
    <nav class="md-nav" aria-label="COMMAND">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convert" class="md-nav__link">
    CONVERT
  </a>
  
    <nav class="md-nav" aria-label="CONVERT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dedup" class="md-nav__link">
    DEDUP
  </a>
  
    <nav class="md-nav" aria-label="DEDUP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delta" class="md-nav__link">
    DELTA
  </a>
  
    <nav class="md-nav" aria-label="DELTA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eval" class="md-nav__link">
    EVAL
  </a>
  
    <nav class="md-nav" aria-label="EVAL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    Синтаксис команды
  </a>
  
    <nav class="md-nav" aria-label="Синтаксис команды">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    Операторы
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    Имена полей
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    Поддерживаемые функции
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eventstats" class="md-nav__link">
    EVENTSTATS
  </a>
  
    <nav class="md-nav" aria-label="EVENTSTATS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_49" class="md-nav__link">
    Синтаксис команды
  </a>
  
    <nav class="md-nav" aria-label="Синтаксис команды">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_50" class="md-nav__link">
    Статистические функции
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_51" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_52" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fields-table" class="md-nav__link">
    FIELDS (TABLE)
  </a>
  
    <nav class="md-nav" aria-label="FIELDS (TABLE)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_53" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_54" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_55" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fieldsummary" class="md-nav__link">
    FIELDSUMMARY
  </a>
  
    <nav class="md-nav" aria-label="FIELDSUMMARY">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_56" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_57" class="md-nav__link">
    Использование команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_58" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_59" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filldown" class="md-nav__link">
    FILLDOWN
  </a>
  
    <nav class="md-nav" aria-label="FILLDOWN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_60" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_61" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_62" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fillnull" class="md-nav__link">
    FILLNULL
  </a>
  
    <nav class="md-nav" aria-label="FILLNULL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_63" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_64" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_65" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#foreach" class="md-nav__link">
    FOREACH
  </a>
  
    <nav class="md-nav" aria-label="FOREACH">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_66" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_67" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_68" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#head" class="md-nav__link">
    HEAD
  </a>
  
    <nav class="md-nav" aria-label="HEAD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_69" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_70" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_71" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inputlookup" class="md-nav__link">
    INPUTLOOKUP
  </a>
  
    <nav class="md-nav" aria-label="INPUTLOOKUP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_72" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_73" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_74" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#join" class="md-nav__link">
    JOIN
  </a>
  
    <nav class="md-nav" aria-label="JOIN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_75" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_76" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_77" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lookup" class="md-nav__link">
    LOOKUP
  </a>
  
    <nav class="md-nav" aria-label="LOOKUP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_78" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_79" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_80" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#makemv" class="md-nav__link">
    MAKEMV
  </a>
  
    <nav class="md-nav" aria-label="MAKEMV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_81" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_82" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_83" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#makeresults" class="md-nav__link">
    MAKERESULTS
  </a>
  
    <nav class="md-nav" aria-label="MAKERESULTS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_84" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_85" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_86" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mvcombine" class="md-nav__link">
    MVCOMBINE
  </a>
  
    <nav class="md-nav" aria-label="MVCOMBINE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_87" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_88" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_89" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mvexpand" class="md-nav__link">
    MVEXPAND
  </a>
  
    <nav class="md-nav" aria-label="MVEXPAND">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_90" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_91" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_92" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nomv" class="md-nav__link">
    NOMV
  </a>
  
    <nav class="md-nav" aria-label="NOMV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_93" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_94" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_95" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#otloadjob" class="md-nav__link">
    OTLOADJOB
  </a>
  
    <nav class="md-nav" aria-label="OTLOADJOB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_96" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_97" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_98" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#otstats" class="md-nav__link">
    OTSTATS
  </a>
  
    <nav class="md-nav" aria-label="OTSTATS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_99" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_100" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_101" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outputlookup" class="md-nav__link">
    OUTPUTLOOKUP
  </a>
  
    <nav class="md-nav" aria-label="OUTPUTLOOKUP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_102" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_103" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_104" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rangemap" class="md-nav__link">
    RANGEMAP
  </a>
  
    <nav class="md-nav" aria-label="RANGEMAP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_105" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_106" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_107" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rare" class="md-nav__link">
    RARE
  </a>
  
    <nav class="md-nav" aria-label="RARE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_108" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_109" class="md-nav__link">
    Пример использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_110" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rename" class="md-nav__link">
    RENAME
  </a>
  
    <nav class="md-nav" aria-label="RENAME">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_111" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_112" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_113" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#replace" class="md-nav__link">
    REPLACE
  </a>
  
    <nav class="md-nav" aria-label="REPLACE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_114" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_115" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_116" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#return" class="md-nav__link">
    RETURN
  </a>
  
    <nav class="md-nav" aria-label="RETURN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_117" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_118" class="md-nav__link">
    Пример использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_119" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reverse" class="md-nav__link">
    REVERSE
  </a>
  
    <nav class="md-nav" aria-label="REVERSE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_120" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_121" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_122" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rex" class="md-nav__link">
    REX
  </a>
  
    <nav class="md-nav" aria-label="REX">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_123" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_124" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_125" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#search-filter" class="md-nav__link">
    SEARCH (FILTER)
  </a>
  
    <nav class="md-nav" aria-label="SEARCH (FILTER)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_126" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_127" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_128" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sort" class="md-nav__link">
    SORT
  </a>
  
    <nav class="md-nav" aria-label="SORT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_129" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_130" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_131" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spath" class="md-nav__link">
    SPATH
  </a>
  
    <nav class="md-nav" aria-label="SPATH">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_132" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_133" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_134" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stats" class="md-nav__link">
    STATS
  </a>
  
    <nav class="md-nav" aria-label="STATS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_135" class="md-nav__link">
    Синтаксис команды
  </a>
  
    <nav class="md-nav" aria-label="Синтаксис команды">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_136" class="md-nav__link">
    Статистические функции
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_137" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_138" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#streamstats" class="md-nav__link">
    STREAMSTATS
  </a>
  
    <nav class="md-nav" aria-label="STREAMSTATS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_139" class="md-nav__link">
    Синтаксис команды
  </a>
  
    <nav class="md-nav" aria-label="Синтаксис команды">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_140" class="md-nav__link">
    Статистические функции
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_141" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_142" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#superjoin" class="md-nav__link">
    SUPERJOIN
  </a>
  
    <nav class="md-nav" aria-label="SUPERJOIN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_143" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_144" class="md-nav__link">
    Пример использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_145" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tail" class="md-nav__link">
    TAIL
  </a>
  
    <nav class="md-nav" aria-label="TAIL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_146" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_147" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_148" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timechart" class="md-nav__link">
    TIMECHART
  </a>
  
    <nav class="md-nav" aria-label="TIMECHART">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_149" class="md-nav__link">
    Синтаксис команды
  </a>
  
    <nav class="md-nav" aria-label="Синтаксис команды">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_150" class="md-nav__link">
    Статистические функции
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_151" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_152" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#top" class="md-nav__link">
    TOP
  </a>
  
    <nav class="md-nav" aria-label="TOP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_153" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_154" class="md-nav__link">
    Пример использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_155" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transaction" class="md-nav__link">
    TRANSACTION
  </a>
  
    <nav class="md-nav" aria-label="TRANSACTION">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_156" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_157" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_158" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transpose" class="md-nav__link">
    TRANSPOSE
  </a>
  
    <nav class="md-nav" aria-label="TRANSPOSE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_159" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_160" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_161" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#untable" class="md-nav__link">
    UNTABLE
  </a>
  
    <nav class="md-nav" aria-label="UNTABLE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_162" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_163" class="md-nav__link">
    Пример использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_164" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where" class="md-nav__link">
    WHERE
  </a>
  
    <nav class="md-nav" aria-label="WHERE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_165" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_166" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_167" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xyseries" class="md-nav__link">
    XYSERIES
  </a>
  
    <nav class="md-nav" aria-label="XYSERIES">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_168" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_169" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_170" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_171" class="md-nav__link">
    Приложение
  </a>
  
    <nav class="md-nav" aria-label="Приложение">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_172" class="md-nav__link">
    Использование макросов в запросах
  </a>
  
    <nav class="md-nav" aria-label="Использование макросов в запросах">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_173" class="md-nav__link">
    Синтаксис использования макроса
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_174" class="md-nav__link">
    Конфигурационный файл макроса
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_175" class="md-nav__link">
    Конфигурационный файл алиасов
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_176" class="md-nav__link">
    Механизм работы
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/SMaLL/" class="md-nav__link">
        SMaLL
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../../SMaLL/">Плагин MLCore</a>
          
            <label for="__nav_3_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Плагин MLCore" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Плагин MLCore
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/datasets/" class="md-nav__link">
        Демонстрационные датасеты
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_3" type="checkbox" id="__nav_3_3_3" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_3">
          Классификация
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Классификация" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_3_3">
          <span class="md-nav__icon md-icon"></span>
          Классификация
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/classification/logreg/" class="md-nav__link">
        Логистическая регрессия
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/classification/decision_tree/" class="md-nav__link">
        Решающее дерево
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/classification/rf/" class="md-nav__link">
        Случайный лес
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/classification/gb/" class="md-nav__link">
        Градиентный бустинг
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/classification/catboost/" class="md-nav__link">
        CatBoost
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_4" type="checkbox" id="__nav_3_3_4" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_4">
          Регрессия
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Регрессия" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_3_4">
          <span class="md-nav__icon md-icon"></span>
          Регрессия
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/regression/lr/" class="md-nav__link">
        Линейная регрессия
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/regression/rf/" class="md-nav__link">
        Случайный лес
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/regression/gb/" class="md-nav__link">
        Градиентный бустинг
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/regression/catboost/" class="md-nav__link">
        CatBoost
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_5" type="checkbox" id="__nav_3_3_5" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_5">
          Кластеризация
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Кластеризация" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_3_5">
          <span class="md-nav__icon md-icon"></span>
          Кластеризация
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/clustering/kmeans/" class="md-nav__link">
        K-Means
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/clustering/dbscan/" class="md-nav__link">
        DBSCAN
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_6" type="checkbox" id="__nav_3_3_6" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_6">
          Временные ряды
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Временные ряды" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_3_6">
          <span class="md-nav__icon md-icon"></span>
          Временные ряды
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/ts/trend_detection/" class="md-nav__link">
        Определение тренда
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/ts/predict/" class="md-nav__link">
        Прогнозирование
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_7" type="checkbox" id="__nav_3_3_7" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_7">
          Поиск аномалий
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Поиск аномалий" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_3_7">
          <span class="md-nav__icon md-icon"></span>
          Поиск аномалий
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/anomaly/lof/" class="md-nav__link">
        Local Outlier Factor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/anomaly/zscore/" class="md-nav__link">
        Z-score
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/anomaly/iqr/" class="md-nav__link">
        IQR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/anomaly/mad/" class="md-nav__link">
        MAD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/anomaly/if/" class="md-nav__link">
        Isolation Forest
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_8" type="checkbox" id="__nav_3_3_8" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_8">
          Работа с признаками
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Работа с признаками" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_3_8">
          <span class="md-nav__icon md-icon"></span>
          Работа с признаками
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/features/pca/" class="md-nav__link">
        PCA
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_8_2" type="checkbox" id="__nav_3_3_8_2" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_8_2">
          Заполнение пропусков
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Заполнение пропусков" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_3_8_2">
          <span class="md-nav__icon md-icon"></span>
          Заполнение пропусков
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/features/fillna/" class="md-nav__link">
        Fill NA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/features/imputer/" class="md-nav__link">
        Imputer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/features/sample/" class="md-nav__link">
        Сэмплирование
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/features/scaling/" class="md-nav__link">
        Масштабирование (scaling)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_9" type="checkbox" id="__nav_3_3_9" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_9">
          Статистические функции
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Статистические функции" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_3_9">
          <span class="md-nav__icon md-icon"></span>
          Статистические функции
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/stats/correlation/" class="md-nav__link">
        Корреляции Пирсона и Спирмена
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/BPM_Commands/" class="md-nav__link">
        Плагин ВРМ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../SMaLL/InstallingExtensions/" class="md-nav__link">
        Установка расширений языка SMaLL
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Компоненты WDC.Платформы
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Компоненты WDC.Платформы" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Компоненты WDC.Платформы
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Optional/GrafanaPlugin/GrafanaPlugin/" class="md-nav__link">
        Плагин для Grafana
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../Optional/ConsoleQueryLauncher/ConsoleQueryLauncher/" class="md-nav__link">
        Консольная утилита запуска запросов
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Содержание раздела">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Содержание раздела
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#otl" class="md-nav__link">
    Команды языка OTL
  </a>
  
    <nav class="md-nav" aria-label="Команды языка OTL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    Введение
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#addcoltotals" class="md-nav__link">
    ADDCOLTOTALS
  </a>
  
    <nav class="md-nav" aria-label="ADDCOLTOTALS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#addinfo" class="md-nav__link">
    ADDINFO
  </a>
  
    <nav class="md-nav" aria-label="ADDINFO">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#addtotals" class="md-nav__link">
    ADDTOTALS
  </a>
  
    <nav class="md-nav" aria-label="ADDTOTALS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#append-union" class="md-nav__link">
    APPEND (UNION)
  </a>
  
    <nav class="md-nav" aria-label="APPEND (UNION)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendcols" class="md-nav__link">
    APPENDCOLS
  </a>
  
    <nav class="md-nav" aria-label="APPENDCOLS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendpipe" class="md-nav__link">
    APPENDPIPE
  </a>
  
    <nav class="md-nav" aria-label="APPENDPIPE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bin" class="md-nav__link">
    BIN
  </a>
  
    <nav class="md-nav" aria-label="BIN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chart" class="md-nav__link">
    CHART
  </a>
  
    <nav class="md-nav" aria-label="CHART">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    Синтаксис команды
  </a>
  
    <nav class="md-nav" aria-label="Синтаксис команды">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    Статистические функции
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#collect" class="md-nav__link">
    COLLECT
  </a>
  
    <nav class="md-nav" aria-label="COLLECT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command" class="md-nav__link">
    COMMAND
  </a>
  
    <nav class="md-nav" aria-label="COMMAND">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convert" class="md-nav__link">
    CONVERT
  </a>
  
    <nav class="md-nav" aria-label="CONVERT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dedup" class="md-nav__link">
    DEDUP
  </a>
  
    <nav class="md-nav" aria-label="DEDUP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delta" class="md-nav__link">
    DELTA
  </a>
  
    <nav class="md-nav" aria-label="DELTA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eval" class="md-nav__link">
    EVAL
  </a>
  
    <nav class="md-nav" aria-label="EVAL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    Синтаксис команды
  </a>
  
    <nav class="md-nav" aria-label="Синтаксис команды">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    Операторы
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    Имена полей
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    Поддерживаемые функции
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eventstats" class="md-nav__link">
    EVENTSTATS
  </a>
  
    <nav class="md-nav" aria-label="EVENTSTATS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_49" class="md-nav__link">
    Синтаксис команды
  </a>
  
    <nav class="md-nav" aria-label="Синтаксис команды">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_50" class="md-nav__link">
    Статистические функции
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_51" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_52" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fields-table" class="md-nav__link">
    FIELDS (TABLE)
  </a>
  
    <nav class="md-nav" aria-label="FIELDS (TABLE)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_53" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_54" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_55" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fieldsummary" class="md-nav__link">
    FIELDSUMMARY
  </a>
  
    <nav class="md-nav" aria-label="FIELDSUMMARY">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_56" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_57" class="md-nav__link">
    Использование команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_58" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_59" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filldown" class="md-nav__link">
    FILLDOWN
  </a>
  
    <nav class="md-nav" aria-label="FILLDOWN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_60" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_61" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_62" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fillnull" class="md-nav__link">
    FILLNULL
  </a>
  
    <nav class="md-nav" aria-label="FILLNULL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_63" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_64" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_65" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#foreach" class="md-nav__link">
    FOREACH
  </a>
  
    <nav class="md-nav" aria-label="FOREACH">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_66" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_67" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_68" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#head" class="md-nav__link">
    HEAD
  </a>
  
    <nav class="md-nav" aria-label="HEAD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_69" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_70" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_71" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inputlookup" class="md-nav__link">
    INPUTLOOKUP
  </a>
  
    <nav class="md-nav" aria-label="INPUTLOOKUP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_72" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_73" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_74" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#join" class="md-nav__link">
    JOIN
  </a>
  
    <nav class="md-nav" aria-label="JOIN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_75" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_76" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_77" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lookup" class="md-nav__link">
    LOOKUP
  </a>
  
    <nav class="md-nav" aria-label="LOOKUP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_78" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_79" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_80" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#makemv" class="md-nav__link">
    MAKEMV
  </a>
  
    <nav class="md-nav" aria-label="MAKEMV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_81" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_82" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_83" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#makeresults" class="md-nav__link">
    MAKERESULTS
  </a>
  
    <nav class="md-nav" aria-label="MAKERESULTS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_84" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_85" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_86" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mvcombine" class="md-nav__link">
    MVCOMBINE
  </a>
  
    <nav class="md-nav" aria-label="MVCOMBINE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_87" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_88" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_89" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mvexpand" class="md-nav__link">
    MVEXPAND
  </a>
  
    <nav class="md-nav" aria-label="MVEXPAND">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_90" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_91" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_92" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nomv" class="md-nav__link">
    NOMV
  </a>
  
    <nav class="md-nav" aria-label="NOMV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_93" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_94" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_95" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#otloadjob" class="md-nav__link">
    OTLOADJOB
  </a>
  
    <nav class="md-nav" aria-label="OTLOADJOB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_96" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_97" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_98" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#otstats" class="md-nav__link">
    OTSTATS
  </a>
  
    <nav class="md-nav" aria-label="OTSTATS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_99" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_100" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_101" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outputlookup" class="md-nav__link">
    OUTPUTLOOKUP
  </a>
  
    <nav class="md-nav" aria-label="OUTPUTLOOKUP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_102" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_103" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_104" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rangemap" class="md-nav__link">
    RANGEMAP
  </a>
  
    <nav class="md-nav" aria-label="RANGEMAP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_105" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_106" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_107" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rare" class="md-nav__link">
    RARE
  </a>
  
    <nav class="md-nav" aria-label="RARE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_108" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_109" class="md-nav__link">
    Пример использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_110" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rename" class="md-nav__link">
    RENAME
  </a>
  
    <nav class="md-nav" aria-label="RENAME">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_111" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_112" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_113" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#replace" class="md-nav__link">
    REPLACE
  </a>
  
    <nav class="md-nav" aria-label="REPLACE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_114" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_115" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_116" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#return" class="md-nav__link">
    RETURN
  </a>
  
    <nav class="md-nav" aria-label="RETURN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_117" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_118" class="md-nav__link">
    Пример использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_119" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reverse" class="md-nav__link">
    REVERSE
  </a>
  
    <nav class="md-nav" aria-label="REVERSE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_120" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_121" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_122" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rex" class="md-nav__link">
    REX
  </a>
  
    <nav class="md-nav" aria-label="REX">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_123" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_124" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_125" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#search-filter" class="md-nav__link">
    SEARCH (FILTER)
  </a>
  
    <nav class="md-nav" aria-label="SEARCH (FILTER)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_126" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_127" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_128" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sort" class="md-nav__link">
    SORT
  </a>
  
    <nav class="md-nav" aria-label="SORT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_129" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_130" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_131" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spath" class="md-nav__link">
    SPATH
  </a>
  
    <nav class="md-nav" aria-label="SPATH">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_132" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_133" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_134" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stats" class="md-nav__link">
    STATS
  </a>
  
    <nav class="md-nav" aria-label="STATS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_135" class="md-nav__link">
    Синтаксис команды
  </a>
  
    <nav class="md-nav" aria-label="Синтаксис команды">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_136" class="md-nav__link">
    Статистические функции
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_137" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_138" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#streamstats" class="md-nav__link">
    STREAMSTATS
  </a>
  
    <nav class="md-nav" aria-label="STREAMSTATS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_139" class="md-nav__link">
    Синтаксис команды
  </a>
  
    <nav class="md-nav" aria-label="Синтаксис команды">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_140" class="md-nav__link">
    Статистические функции
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_141" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_142" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#superjoin" class="md-nav__link">
    SUPERJOIN
  </a>
  
    <nav class="md-nav" aria-label="SUPERJOIN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_143" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_144" class="md-nav__link">
    Пример использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_145" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tail" class="md-nav__link">
    TAIL
  </a>
  
    <nav class="md-nav" aria-label="TAIL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_146" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_147" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_148" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timechart" class="md-nav__link">
    TIMECHART
  </a>
  
    <nav class="md-nav" aria-label="TIMECHART">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_149" class="md-nav__link">
    Синтаксис команды
  </a>
  
    <nav class="md-nav" aria-label="Синтаксис команды">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_150" class="md-nav__link">
    Статистические функции
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_151" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_152" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#top" class="md-nav__link">
    TOP
  </a>
  
    <nav class="md-nav" aria-label="TOP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_153" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_154" class="md-nav__link">
    Пример использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_155" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transaction" class="md-nav__link">
    TRANSACTION
  </a>
  
    <nav class="md-nav" aria-label="TRANSACTION">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_156" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_157" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_158" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transpose" class="md-nav__link">
    TRANSPOSE
  </a>
  
    <nav class="md-nav" aria-label="TRANSPOSE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_159" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_160" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_161" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#untable" class="md-nav__link">
    UNTABLE
  </a>
  
    <nav class="md-nav" aria-label="UNTABLE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_162" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_163" class="md-nav__link">
    Пример использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_164" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where" class="md-nav__link">
    WHERE
  </a>
  
    <nav class="md-nav" aria-label="WHERE">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_165" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_166" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_167" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xyseries" class="md-nav__link">
    XYSERIES
  </a>
  
    <nav class="md-nav" aria-label="XYSERIES">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_168" class="md-nav__link">
    Синтаксис команды
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_169" class="md-nav__link">
    Примеры использования
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_170" class="md-nav__link">
    
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_171" class="md-nav__link">
    Приложение
  </a>
  
    <nav class="md-nav" aria-label="Приложение">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_172" class="md-nav__link">
    Использование макросов в запросах
  </a>
  
    <nav class="md-nav" aria-label="Использование макросов в запросах">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_173" class="md-nav__link">
    Синтаксис использования макроса
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_174" class="md-nav__link">
    Конфигурационный файл макроса
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_175" class="md-nav__link">
    Конфигурационный файл алиасов
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_176" class="md-nav__link">
    Механизм работы
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h2 id="_1"></h2>
<h1 id="otl">Команды языка OTL</h1>
<h2 id="_2">Введение</h2>
<p><strong>OTL</strong> – <strong>O</strong>pen <strong>T</strong>echnology <strong>L</strong>anguage – высокоуровневый язык для работы
с данными, не требующий от пользователя навыков программирования.</p>
<p>Язык OTL применяется в интерактивной среде разработки EVA для создания поисковых
запросов к различным источникам данных для последующей визуализации и анализа
данных.</p>
<p>Структура поиска на языке OTL выглядит следующим образом:</p>
<p><strong>данные из индекса &lt;аргументы&gt; | команда1 &lt;аргументы&gt; | команда2
&lt;аргументы&gt; | ...</strong></p>
<p>Запрос состоит из серии команд, разделенных конвейером (|), который принимает
выходные данные одной команды и передает их в следующую.</p>
<p>Команды в запросе используются для получения индексированных данных, фильтрации
нежелательной и извлечения дополнительной информации, вычисления значений и
проведения статистического анализа.</p>
<p>Результаты поиска, извлеченные из индекса, можно рассматривать как динамически
создаваемую таблицу.</p>
<p>В документе представлены команды языка OTL.</p>
<p>Описание каждой команды снабжено многочисленными примерами, позволяющими
наглядно продемонстрировать её возможности в решении разноплановых задач
обработки данных.</p>
<h1 id="addcoltotals">ADDCOLTOTALS</h1>
<p>Команда добавляет сумму каждого числового поля в конец набора результатов
запроса. Если указан аргумент <strong>labelfield</strong>, в таблицу результатов добавляется
столбец с указанным именем.</p>
<h3 id="_3">Синтаксис команды</h3>
<pre><code>addcoltotals [labelfield=&lt;fieldname&gt;] [label=&lt;string&gt;]
</code></pre>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>labelfield=&lt;fieldname></strong> – определяет имя поля для добавления в набор
    результатов.</p>
</li>
<li>
<p><strong>labe=&lt;string>l</strong> – используется с аргументом <strong>labelfield</strong> для
    добавления метки в итоговое событие. Если аргумент <strong>labelfield</strong>
    отсутствует, аргумент <strong>label</strong> не имеет никакого эффекта.</p>
</li>
</ul>
<h3 id="_4">Примеры использования</h3>
<p><strong>Пример 1</strong>.</p>
<p>Добавляет общую сумму всех транзакций в конец набора результатов поля <em>sum</em>:</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... | addcoltotals labelfield=All_Transactions
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
<th><strong>All_Transactions</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
<td></td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
<td></td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
<td></td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
<td></td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
<td></td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>67</td>
<td>Total</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong>.</p>
<p>Выводит количество рейсов (вылетов и прилетов) по всем терминалам аэропорта:</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>Terminal</strong></th>
<th><strong>Arrivals</strong></th>
<th><strong>Departures</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Terminal1</td>
<td>80000</td>
<td>40000</td>
</tr>
<tr>
<td>Terminal2</td>
<td>30000</td>
<td>50000</td>
</tr>
<tr>
<td>Terminal3</td>
<td>60000</td>
<td>90000</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... | addcoltotals labelfield=Total label=Flights
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Terminal</strong></th>
<th><strong>Arrivals</strong></th>
<th><strong>Departures</strong></th>
<th><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Terminal1</td>
<td>80000</td>
<td>40000</td>
<td></td>
</tr>
<tr>
<td>Terminal2</td>
<td>30000</td>
<td>50000</td>
<td></td>
</tr>
<tr>
<td>Terminal3</td>
<td>60000</td>
<td>90000</td>
<td></td>
</tr>
<tr>
<td></td>
<td>170000</td>
<td>180000</td>
<td>Flights</td>
</tr>
</tbody>
</table>
<h1 id="_5"></h1>
<h1 id="addinfo">ADDINFO</h1>
<p>Команда добавляет поля, общую информацию об идентификаторе запроса и временных
интервалах.</p>
<h3 id="_6">Синтаксис команды</h3>
<p>addinfo</p>
<p>Следующие поля добавляются к каждому событию при использовании команды
<strong>addinfo</strong>:</p>
<table>
<thead>
<tr>
<th><strong>Поле</strong></th>
<th><strong>Описание</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>info_min_time</strong></td>
<td>Самая ранняя временная граница для поиска.</td>
</tr>
<tr>
<td><strong>info_max_time</strong></td>
<td>Самая поздняя временная граница для поиска.</td>
</tr>
<tr>
<td><strong>info_sid</strong></td>
<td>Идентификатор поиска, который сгенерировал событие.</td>
</tr>
</tbody>
</table>
<h3 id="_7">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Добавляет служебную информацию о поиске к каждому событию.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... | addinfo
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
<th><strong>info_min_time</strong></th>
<th><strong>info_max_time</strong></th>
<th><strong>info_sid</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
<td>1587045000</td>
<td>1587048000</td>
<td>13102</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
<td>1587045000</td>
<td>1587048000</td>
<td>13102</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
<td>1587045000</td>
<td>1587048000</td>
<td>13102</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
<td>1587045000</td>
<td>1587048000</td>
<td>13102</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
<td>1587045000</td>
<td>1587048000</td>
<td>13102</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
<td>1587045000</td>
<td>1587048000</td>
<td>13102</td>
</tr>
</tbody>
</table>
<h1 id="_8"></h1>
<h1 id="addtotals">ADDTOTALS</h1>
<p>Команда вычисляет арифметическую сумму числовых полей для каждого результата
запроса. Сумма помещается в новое поле. Если установлен параметр <strong>col</strong> <em>=
true</em>, команда <strong>addtotals</strong> добавляет сумму каждого числового поля в конец
набора результатов запроса. Кроме того, вместо использования команды
<strong>addtotals</strong> с параметром <strong>col</strong> = <em>true</em>, можно использовать команду
<a href="#addcoltotals"><strong>addcoltotals</strong></a> для вычисления итогового события.</p>
<h3 id="_9">Синтаксис команды</h3>
<pre><code>addtotals [row=&lt;bool&gt;] [fieldname=&lt;field&gt;] [col=&lt;bool&gt;] [labelfield=&lt;field&gt;] [label=&lt;string&gt;] &lt;field-list&gt;
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>field-list</strong> – одно или несколько числовых полей для вычисления
    суммирующего значения.</li>
</ul>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>row=&lt;bool></strong> – указывает, следует ли рассчитывать сумму <strong>field-list</strong>
    для каждого события. Это похоже на вычисление итога для каждой строки в
    таблице. Сумма помещается в новое поле. Имя поля по умолчанию – <em>Total</em>.
    Если необходимо указать другое имя для поля, используется параметр
    <strong>fieldname</strong>. Значение по умолчанию: <em>true</em>.</p>
</li>
<li>
<p><strong>fieldname=&lt;field></strong> – используется для указания имени поля, которое
    содержит рассчитанную сумму списка полей для каждого события. Параметр
    <strong>fieldname</strong> действителен только тогда, когда <strong>row</strong> = <em>true</em>.</p>
</li>
<li>
<p><strong>col=&lt;bool></strong> – указывает на необходимость добавления нового события,
    называемого сводным событием, вниз списка событий. Сводное событие
    отображает сумму каждого поля в событиях, аналогично вычислению итоговых
    значений столбцов в таблице.</p>
<p>Значение по умолчанию: <em>false</em>.</p>
</li>
<li>
<p><strong>labelfield=&lt;field></strong> – используется для указания поля метки сводного
    события. Аргумент <strong>labelfield</strong> действителен только тогда, когда <strong>col</strong> =
    <em>true</em>.</p>
</li>
<li>
<p><strong>label=&lt;string></strong> – используется для указания метки строки для сводного
    события.</p>
</li>
</ul>
<h3 id="_10">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Выводит размер транзакций по каждой из валют в разрезе стран и считает с помощью
команды <strong>addtotals</strong> общую сумму:</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... 
| chart sum(sum) over currency by dest 
| fillnull 
| addtotals  Germany Russia USA fieldname=SUM 
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>currency</strong></th>
<th><strong>Germany</strong></th>
<th><strong>Russia</strong></th>
<th><strong>USA</strong></th>
<th><strong>SUM</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>EUR</td>
<td>21</td>
<td>7</td>
<td>3</td>
<td>31</td>
</tr>
<tr>
<td>RUB</td>
<td>19</td>
<td>10</td>
<td>0</td>
<td>29</td>
</tr>
<tr>
<td>USD</td>
<td>0</td>
<td>7</td>
<td>0</td>
<td>7</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Считает общее количество прилётов в аэропорту за каждые сутки и для каждого
терминала за все дни.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>Terminal</strong></th>
<th><strong>Date</strong></th>
<th><strong>Arrivals</strong></th>
<th><strong>Departures</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>TerminalA</td>
<td>27.03.2019</td>
<td>235</td>
<td>321</td>
</tr>
<tr>
<td>TerminalB</td>
<td>27.03.2019</td>
<td>178</td>
<td>167</td>
</tr>
<tr>
<td>TerminalC</td>
<td>27.03.2019</td>
<td>79</td>
<td>68</td>
</tr>
<tr>
<td>TerminalA</td>
<td>28.03.2019</td>
<td>216</td>
<td>278</td>
</tr>
<tr>
<td>TerminalB</td>
<td>28.03.2019</td>
<td>165</td>
<td>145</td>
</tr>
<tr>
<td>TerminalC</td>
<td>28.03.2019</td>
<td>64</td>
<td>60</td>
</tr>
<tr>
<td>TerminalA</td>
<td>29.03.2019</td>
<td>223</td>
<td>216</td>
</tr>
<tr>
<td>TerminalB</td>
<td>29.03.2019</td>
<td>143</td>
<td>120</td>
</tr>
<tr>
<td>TerminalC</td>
<td>29.03.2019</td>
<td>87</td>
<td>98</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... 
| chart sum(Arrivals) by Terminal over Date 
| addtotals fieldname=Arrivals/day col=true labelfield=Arrivals/Terminal TerminalA TerminalB TerminalC
</code></pre>
<p>В этом примере используется команда <a href="#chart"><strong>chart</strong></a> для представления
количества прибывающих рейсов в разрезе даты и терминала аэропорта.</p>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Date</strong></th>
<th><strong>Terminal A</strong></th>
<th><strong>Terminal B</strong></th>
<th><strong>Terminal C</strong></th>
<th><strong>Arrivals/day</strong></th>
<th><strong>Arrivals/Terminal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>27.03.2019</td>
<td>235</td>
<td>178</td>
<td>79</td>
<td>492</td>
<td></td>
</tr>
<tr>
<td>28.03.2019</td>
<td>216</td>
<td>165</td>
<td>64</td>
<td>445</td>
<td></td>
</tr>
<tr>
<td>29.03.2019</td>
<td>223</td>
<td>143</td>
<td>87</td>
<td>453</td>
<td></td>
</tr>
<tr>
<td></td>
<td>674</td>
<td>486</td>
<td>230</td>
<td>1390</td>
<td>Total</td>
</tr>
</tbody>
</table>
<h1 id="_11"></h1>
<h1 id="append-union">APPEND (UNION)</h1>
<p>Команда добавляет результаты подзапроса к текущим результатам. Синоним команды –
<strong>union</strong>.</p>
<h3 id="_12">Синтаксис команды</h3>
<pre><code>append &lt;subsearch&gt;
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>subsearch</strong> – дополнительный запрос, результаты выполнения которого
    необходимо добавить. Подзапрос должен быть заключен в квадратные скобки.</li>
</ul>
<h3 id="_13">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Подсчитывает количество различных IP-адресов, с которых обращались к
веб-серверу. Затем находит пользователя, который обращался к веб-серверу в
разрезе типа запроса (<em>method</em>).</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>_time</strong></th>
<th><strong>clientip</strong></th>
<th><strong>method</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2020-04-20 18:22:16</td>
<td>91.205.189.15</td>
<td>GET</td>
</tr>
<tr>
<td>2020-04-20 18:20:56</td>
<td>182.236.164.11</td>
<td>GET</td>
</tr>
<tr>
<td>2020-04-20 18:18:59</td>
<td>198.35.1.75</td>
<td>GET</td>
</tr>
<tr>
<td>2020-04-20 18:16:29</td>
<td>221.204.246.72</td>
<td>POST</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>index=access_web_server 
| stats dc(clientip), count by method 
| append [search index=access_web_server | top 1 clientip by method]
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>method</strong></th>
<th><strong>dc(clientip)</strong></th>
<th><strong>count</strong></th>
<th><strong>clientip</strong></th>
<th><strong>percent</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>182</td>
<td>24866</td>
<td></td>
<td></td>
</tr>
<tr>
<td>POST</td>
<td>182</td>
<td>14666</td>
<td></td>
<td></td>
</tr>
<tr>
<td>GET</td>
<td></td>
<td>651</td>
<td>87.194.216.51</td>
<td>2.618033</td>
</tr>
<tr>
<td>POST</td>
<td></td>
<td>385</td>
<td>87.194.216.51</td>
<td>2.625119</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong>.</p>
<p>Выводит статистику по транзакциям (самые частые и редкие валюты, самые маленькие
и большие суммы транзакций, топ мест назначения) в разрезе стран.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... 
| stats max(currency), min(currency), max(sum), min(sum) by dest 
| rename  max(currency) as &quot;most frequent currency&quot;, min(currency) as &quot;rarest currency&quot;, max(sum) as &quot;maximum amount&quot;, min(sum) as &quot;minimum amount&quot; 
| append [| ... | top dest | rename count as &quot;top dest&quot;]
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>dest</strong></th>
<th><strong>most frequent currency</strong></th>
<th><strong>rarest currency</strong></th>
<th><strong>maximum amount</strong></th>
<th><strong>minimum amount</strong></th>
<th><strong>top dest</strong></th>
<th><strong>percent</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>USA</td>
<td>USD</td>
<td>USD</td>
<td>3</td>
<td>3</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Germany</td>
<td>EUR</td>
<td>EUR</td>
<td>21</td>
<td>19</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Russia</td>
<td>RUB</td>
<td>EUR</td>
<td>10</td>
<td>7</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Russia</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>3</td>
<td>50</td>
</tr>
<tr>
<td>Germany</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>2</td>
<td>33.333333333333336</td>
</tr>
<tr>
<td>USA</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>1</td>
<td>16.666666666666668</td>
</tr>
</tbody>
</table>
<h1 id="_14"></h1>
<h1 id="appendcols">APPENDCOLS</h1>
<p>Команда добавляет результаты подзапроса, как новые поля текущего запроса.</p>
<h3 id="_15">Синтаксис команды</h3>
<pre><code>appendcols &lt;subsearch&gt;
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>subsearch</strong> — подзапрос, результаты выполнения которого будут добавлены в
    основной запрос.</li>
</ul>
<h3 id="_16">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Дополняет информацию о работе аэропорта метеорологическими сводками.</p>
<p>Запрос:</p>
<pre><code>| serach index=LA_Air 
| appendcols subsearch=[search index=weather]
</code></pre>
<p><strong>Пример 2</strong></p>
<p>Дополняет данные о транзакциях информацией о курсе валют:</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>USD exchange</strong></th>
<th><strong>EUR exchange</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>77,28</td>
<td>83,63</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>| otstats index=transactions 
| appendcols [otstats index=currencies]
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
<th><strong>USD exchange</strong></th>
<th><strong>EUR exchange</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
<td>77,28</td>
<td>83,63</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Пример 3</strong></p>
<p>Подсчитывает сколько раз встречается определённое поле в логах сервера и
использует это значение для вычисления других полей.</p>
<pre><code>... 
| stats dc(userID) as totalUsers
| appendcols [ ... AND &quot;text&quot; | addinfo | where _time &gt;= info_min_time AND _time &lt;=info_max_time | stats count(field) as variableA ]
| eval variableB = (variableA/totalUsers)
</code></pre>
<p>Сначала в запросе используется команда <a href="#stats"><strong>stats</strong></a> для подсчета
количества отдельных пользователей на сервере, это значение присваивается полю
<em>totalUsers</em>.</p>
<p>Затем используется команда <strong>appendcols</strong> для добавления информации о том,
сколько раз за определённое время встречается интересующее нас поле –
<em>variableA</em>.</p>
<p>В конце подсчитываем новое поле <em>variableB</em> на основе полученных данных.</p>
<h1 id="_17"></h1>
<h1 id="appendpipe">APPENDPIPE</h1>
<p>Команда добавляет дополнительные преобразования (subpipeline) к результатам
основного запроса. В отличие от подзапроса (subsearch), subpipeline не
запускается первым. Subpipeline запускается тогда, когда запрос достигает
команды <strong>appendpipe</strong>.</p>
<h3 id="_18">Синтаксис команды</h3>
<pre><code>appendpipe &lt;subpipeline&gt;
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>subpipeline</strong> – список преобразований, которые применяются к результатам
    выполнения основного запроса.</li>
</ul>
<h3 id="_19">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Считает сумму прилётов за день во все терминалы аэропорта.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>Terminal</strong></th>
<th><strong>Date</strong></th>
<th><strong>Arrivals</strong></th>
<th><strong>Departures</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>TerminalA</td>
<td>27.03.2019</td>
<td>235</td>
<td>321</td>
</tr>
<tr>
<td>TerminalB</td>
<td>27.03.2019</td>
<td>178</td>
<td>167</td>
</tr>
<tr>
<td>TerminalC</td>
<td>27.03.2019</td>
<td>79</td>
<td>68</td>
</tr>
<tr>
<td>TerminalA</td>
<td>28.03.2019</td>
<td>216</td>
<td>278</td>
</tr>
<tr>
<td>TerminalB</td>
<td>28.03.2019</td>
<td>165</td>
<td>145</td>
</tr>
<tr>
<td>TerminalC</td>
<td>28.03.2019</td>
<td>64</td>
<td>60</td>
</tr>
<tr>
<td>TerminalA</td>
<td>29.03.2019</td>
<td>223</td>
<td>216</td>
</tr>
<tr>
<td>TerminalB</td>
<td>29.03.2019</td>
<td>143</td>
<td>120</td>
</tr>
<tr>
<td>TerminalC</td>
<td>29.03.2019</td>
<td>87</td>
<td>98</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... 
| chart sum(Arrivals) by Terminal over Date 
| appendpipe [| eval SUM=TerminalA+TerminalB+TerminalC]
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Date</strong></th>
<th><strong>TerminalA</strong></th>
<th><strong>TerminalB</strong></th>
<th><strong>TerminalC</strong></th>
<th><strong>SUM</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>27.03.2019</td>
<td>235</td>
<td>178</td>
<td>79</td>
<td>492</td>
</tr>
<tr>
<td>28.03.2019</td>
<td>216</td>
<td>165</td>
<td>64</td>
<td>453</td>
</tr>
<tr>
<td>29.03.2019</td>
<td>223</td>
<td>143</td>
<td>87</td>
<td>445</td>
</tr>
</tbody>
</table>
<h1 id="_20"></h1>
<h1 id="bin">BIN</h1>
<p>Команда отображает числовые значения поля в дискретный набор значений таким
образом, что все значения из заданного диапазона значений этого же поля
принимают одно из значений дискретного ряда.</p>
<h3 id="_21">Синтаксис команды</h3>
<pre><code>bin [&lt;bin-options&gt;...] &lt;field&gt; [AS &lt;newfield&gt;]
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>field</strong> – поле, к которому будет применяться дискретизация.</li>
</ul>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>bin-options</strong> — опции команды <strong>bin</strong>:</p>
<ul>
<li>
<p><em>bins</em> – устанавливает максимальное число фрагментов отображения
    (дискретизации).</p>
</li>
<li>
<p><em>span</em> – устанавливает размер каждого фрагмента отображения
    (дискретизации) в единицах времени. Параметр применим только к полю
    _<em>time</em>.</p>
</li>
</ul>
</li>
<li>
<p><strong>AS &lt;newfield></strong> – имя нового поля, в которое будет записано значение
    после операции отображения (дискретизации).</p>
</li>
</ul>
<h3 id="_22">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Делит весь диапазон значений поля <em>location_id</em> на 10 частей. Записывает
результат в поле <em>location_id_range</em>. Считает количество уникальных
пользователей в каждом из диапазонов значений поля <em>id</em>.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>location_id</strong></th>
<th><strong>user</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>5</td>
<td>John</td>
</tr>
<tr>
<td>18</td>
<td>Mary</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>54</td>
<td>Sam</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>99</td>
<td>Bob</td>
</tr>
<tr>
<td>16</td>
<td>Phil</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>...
| bin bins=10 location_id as location_id_range 
| stats dc(user)  by location_id_range
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>location_id_range</strong></th>
<th><strong>dc(user)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0-10</td>
<td>6</td>
</tr>
<tr>
<td>11-20</td>
<td>11</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
</tr>
<tr>
<td>90-99</td>
<td>3</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Исходные данные:</p>
<p>Для каждого хоста возвращает значение пропускной способности (<em>throughput</em>),
усредненное по минутным интервалам времени.</p>
<table>
<thead>
<tr>
<th><strong>_time</strong></th>
<th><strong>host</strong></th>
<th><strong>throughput</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2019-10-02 12:20:00</td>
<td>host1</td>
<td>13</td>
</tr>
<tr>
<td>2019-10-02 12:20:33</td>
<td>host2</td>
<td>14</td>
</tr>
<tr>
<td>2019-10-02 12:20:55</td>
<td>host2</td>
<td>2</td>
</tr>
<tr>
<td>2019-10-02 12:21:03</td>
<td>host1</td>
<td>25</td>
</tr>
<tr>
<td>2019-10-02 12:21:34</td>
<td>host2</td>
<td>2</td>
</tr>
<tr>
<td>2019-10-02 12:21:45</td>
<td>host1</td>
<td>23</td>
</tr>
<tr>
<td>2019-10-02 12:21:55</td>
<td>host2</td>
<td>18</td>
</tr>
<tr>
<td>2019-10-02 12:22:07</td>
<td>host2</td>
<td>9</td>
</tr>
<tr>
<td>2019-10-02 12:22:08</td>
<td>host1</td>
<td>11</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... 
| bin _time span=1m 
| stats avg(throughput) by _time host
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>_time</strong></th>
<th><strong>host</strong></th>
<th><strong>avg(throughput)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2019-10-02 12:20:00</td>
<td>host1</td>
<td>13</td>
</tr>
<tr>
<td>2019-10-02 12:20:00</td>
<td>host2</td>
<td>8</td>
</tr>
<tr>
<td>2019-10-02 12:21:00</td>
<td>host1</td>
<td>24</td>
</tr>
<tr>
<td>2019-10-02 12:21:00</td>
<td>host2</td>
<td>10</td>
</tr>
<tr>
<td>2019-10-02 12:22:00</td>
<td>host1</td>
<td>11</td>
</tr>
<tr>
<td>2019-10-02 12:22:00</td>
<td>host2</td>
<td>9</td>
</tr>
</tbody>
</table>
<h1 id="_23"></h1>
<h1 id="chart">CHART</h1>
<p>Команда <strong>chart</strong> группирует записи по указанному полю и является
трансформирующей командой, которая возвращает результаты в табличном формате.</p>
<p>Результат, затем, может быть визуализирован в разных форматах – линейный график,
столбчатая диаграмма, круговая диаграмма.</p>
<p>В команде <strong>chart</strong> должна быть определена статистическая функция для агрегации
данных.</p>
<h3 id="_24">Синтаксис команды</h3>
<pre><code>chart &lt;stats-agg-term&gt; [OVER &lt;row-split&gt;] [BY &lt;column-split&gt;]
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li>
<p><strong>stats-agg-term</strong> – статистические функции, применяемые к полям и
    eval-выражениям. Результат выполнения функции может быть помещён в отдельное
    поле с именем, указанным после операнда <em>AS</em>.</p>
<p>Синтаксис: <em>&lt;stats-func>( &lt;evaled-field> | &lt;wc-field> ) [AS
&lt;new-field>]</em>.</p>
<p>Перечень функций представлен в разделе ниже.</p>
</li>
</ul>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>OVER &lt;row-split></strong> – поле, определенное после <em>OVER</em>, появится в первой
    колонке результирующей таблицы. Значения полей в исходных данных станут
    значениями рядов в результирующей таблице. Если далее строить график по этой
    таблице, то эти поля будут отмечены на оси Х.</p>
</li>
<li>
<p><strong>BY &lt;column-split></strong> – одно или несколько полей, значения которых будут
    названиями столбцов в результирующей таблице.</p>
</li>
</ul>
<h4 id="_25">Статистические функции</h4>
<p>Функции позволяют получить различные статистики по полю или eval-выражению, к
которому они применяются.</p>
<p>В таблице представлен перечень функций, сгруппированных по типам:</p>
<table>
<thead>
<tr>
<th><strong>Имя функции</strong></th>
<th><strong>Описание функции</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Агрегирующие функции:</strong></td>
<td></td>
</tr>
<tr>
<td><em>approxdc()</em></td>
<td>Приблизительное количество уникальных значений.</td>
</tr>
<tr>
<td><em>avg()</em></td>
<td>Среднее арифметическое.</td>
</tr>
<tr>
<td><em>count()</em></td>
<td>Количество значений.</td>
</tr>
<tr>
<td><em>distinct_count()</em></td>
<td>Количество уникальных значений.</td>
</tr>
<tr>
<td><em>max()</em></td>
<td>Наибольшее значение.</td>
</tr>
<tr>
<td><em>min()</em></td>
<td>Наименьшее значение.</td>
</tr>
<tr>
<td><em>perc()</em></td>
<td>Процентиль.</td>
</tr>
<tr>
<td><em>percentile_approx()</em></td>
<td></td>
</tr>
<tr>
<td><em>stdev()</em></td>
<td>Стандартное отклонение.</td>
</tr>
<tr>
<td><em>sum()</em></td>
<td>Сумма значений.</td>
</tr>
<tr>
<td><em>var()</em></td>
<td>Дисперсия.</td>
</tr>
<tr>
<td><strong>Порядковые функции:</strong></td>
<td></td>
</tr>
<tr>
<td><em>first()</em></td>
<td>Первое значение в таблице.</td>
</tr>
<tr>
<td><em>last()</em></td>
<td>Последнее значение в таблице.</td>
</tr>
<tr>
<td><strong>Функции для работы с multivalue-полями:</strong></td>
<td></td>
</tr>
<tr>
<td><em>list()</em></td>
<td>Список значений.</td>
</tr>
<tr>
<td><em>values()</em></td>
<td></td>
</tr>
<tr>
<td><strong>Временные функции:</strong></td>
<td></td>
</tr>
<tr>
<td><em>earliest()</em></td>
<td>Первое значение в таблице.</td>
</tr>
<tr>
<td><em>latest()</em></td>
<td>Последнее значение в таблице.</td>
</tr>
</tbody>
</table>
<h3 id="_26">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Считает сумму переводов и вычисляет максимальный перевод в разрезе по стране.</p>
<p>Запрос:</p>
<pre><code>...| chart sum(sum) as total max(sum) as max_sent by dest_country
</code></pre>
<p>Результат выполнения:</p>
<table>
<thead>
<tr>
<th><strong>dest_country</strong></th>
<th><strong>tolal</strong></th>
<th><strong>max_sent</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Germany</td>
<td>40</td>
<td>21</td>
</tr>
<tr>
<td>Russia</td>
<td>34</td>
<td>17</td>
</tr>
<tr>
<td>USA</td>
<td>3</td>
<td>3</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Считает сумму переводов в разрезе по стране и в разрезе валюты перевода. <em>Over</em>
отвечает за <em>row-split</em>, <em>by</em> отвечает за <em>column-split</em>.</p>
<p>Запрос:</p>
<pre><code>... | chart sum(sum) over dest_country by currency
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>dest_country</strong></th>
<th><strong>EUR</strong></th>
<th><strong>RUB</strong></th>
<th><strong>USD</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Germany</td>
<td>21</td>
<td>19</td>
<td></td>
</tr>
<tr>
<td>Russia</td>
<td>17</td>
<td>10</td>
<td>7</td>
</tr>
<tr>
<td>USA</td>
<td>3</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="_27"></h1>
<h1 id="collect">COLLECT</h1>
<p>Команда сохраняет результаты запроса в указанном индексе.</p>
<h3 id="_28">Синтаксис команды</h3>
<pre><code>collect index=&lt;string&gt; [host=&lt;host&gt; source=&lt;source&gt; sourcetype=&lt;sourcetype&gt;]
</code></pre>
<p>Обязательные параметры:</p>
<ul>
<li><strong>index=&lt;string></strong> – имя индекса, в который добавляются события.</li>
</ul>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>host=&lt;host></strong> – имя хоста, указываемое для событий.</p>
</li>
<li>
<p><strong>source=&lt;source></strong> – имя источника, указываемое для событий.</p>
</li>
<li>
<p><strong>sourcetype=&lt;sourcetype></strong> – имя типа источника, указываемое для событий.</p>
</li>
</ul>
<h3 id="_29">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Сохраняет отформатированные данные о транзакциях в новый индекс с указанием
имени и типа источника.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>| otstats index=transactions 
| where dest=&quot;Russia&quot; 
| collect index=transactions_russia source=transactions sourcetype=transactions
</code></pre>
<h1 id="_30"></h1>
<h1 id="command">COMMAND</h1>
<p>Команда позволяет использовать функции <strong>Spark</strong> для обработки полей.</p>
<h3 id="_31">Синтаксис команды</h3>
<pre><code>command &lt;field&gt;=[&lt;spark_function&gt;(&lt;field&gt;, &lt;options&gt;)]
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>field</strong> – имя поля, которому присваивается полученное значение.</li>
</ul>
<p>Опциональный параметр:</p>
<ul>
<li>
<p><strong>spark_function</strong> – функция <strong>Spark</strong>.</p>
<p><a href="https://spark.apache.org/docs/2.4.0/api/sql/index.html">Полный список доступных функций см. в документации на
S</a><a href="https://spark.apache.org/docs/2.4.0/api/sql/index.html">park</a><a href="https://spark.apache.org/docs/2.4.0/api/sql/index.html">.</a></p>
</li>
</ul>
<h3 id="_32">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>id</strong></th>
<th><strong>phrase</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>world is never be the same</td>
</tr>
<tr>
<td>2</td>
<td>be quick or be dad</td>
</tr>
<tr>
<td>3</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Переводим все буквы поля <em>phrase</em> в верхний регистр.</p>
<p>Запрос:</p>
<pre><code>... | command up_phrase=ucase(phrase)
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>id</strong></th>
<th><strong>phrase</strong></th>
<th><strong>up_phrase</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>world is never be the same</td>
<td>WORLD IS NEVER BE THE SAME</td>
</tr>
<tr>
<td>2</td>
<td>be quick or be dad</td>
<td>BE QUICK OR BE DAD</td>
</tr>
<tr>
<td>3</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Проверяем поля на пустые значения. Если поле пустое (значение = NULL), то новому
полю будет присвоен <em>0</em>, если поле не пустое – <em>1</em>.</p>
<pre><code>... | command empty_check=isnotnull(phrase)
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>id</strong></th>
<th><strong>phrase</strong></th>
<th><strong>empty_check</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>world is never be the same</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>be quick or be dad</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td></td>
<td>0</td>
</tr>
</tbody>
</table>
<p><strong>Пример 3</strong></p>
<p>Присваивает полю <em>position</em> номер позиции слова "be" во фразе поля <em>phrase</em> (при
этом просит начать поиск от 4-го символа).</p>
<p>Запрос:</p>
<pre><code>... | command position=locate(&quot;be&quot;, phrase, 4)
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>id</strong></th>
<th><strong>phrase</strong></th>
<th><strong>position</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>world is never be the same</td>
<td>16</td>
</tr>
<tr>
<td>2</td>
<td>be quick or be dad</td>
<td>13</td>
</tr>
<tr>
<td>3</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="_33"></h1>
<h1 id="convert">CONVERT</h1>
<p>Команда конвертирует значения поля в поисковом результате в числовые значения
там, где это возможно.</p>
<h3 id="_34">Синтаксис команды</h3>
<pre><code>convert [timeformat=&lt;string&gt;] (&lt;convert-function&gt; [AS &lt;field&gt;])
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li>
<p><strong>convert-function</strong> – функция конвертирования:</p>
<p><em>ctime()</em> – функция конвертирует время, представленное в Epoch-формате, в
понятный для человека формат. При этом используются опции параметра
<strong>timeformat</strong>, который описывает параметры конвертирования.</p>
</li>
</ul>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>timeformat=&lt;string></strong> – описывает формат конвертирования поля. Формат
    времени по умолчанию: <em>%Y-%m-%d %H:%M:%S</em>.</p>
</li>
<li>
<p><strong>AS &lt;field></strong> – имя нового поля, в которое будет записан результат
    конвертирования. Если <em>AS</em> не использовать, оригинальные значения полей
    будут заменены новыми сконвертированными.</p>
</li>
</ul>
<h3 id="_35">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Конвертирует время из Epoch-формата в формат <em>%Y-%m-%d</em> и создает поле <em>Т</em>, куда
записывается результат.</p>
<p>Запрос:</p>
<pre><code>...|  convert timeformat=&quot;%Y-%m-%d&quot;  ctime(datetime) as T
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
<th><strong>T</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
<td>2019-10-02</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
<td>2019-10-02</td>
</tr>
</tbody>
</table>
<h1 id="_36"></h1>
<h1 id="dedup">DEDUP</h1>
<p>Команда удаляет события, которые содержат повторяющееся значение поля или
повторяющуюся идентичную комбинацию значений полей, заданных как параметры
команды. Такая процедура называется дедупликацией.</p>
<p><strong>Важно! <br />
</strong><em>Порядок, в котором события будут поступать на обработку в команду</em>
<strong>dedup</strong>*, определяется результатом выполнения предыдущих команд. При этом один
и тот же порядок событий не может быть гарантирован для разных запусков запроса.</p>
<p>В случае необходимости сохранения одного и того же порядка событий для разных
запусков запроса, необходимо предусмотреть сортировку событий до их поступления
на вход команды<em> </em><em>dedup</em><em><em>. Для этого, например, можно использовать команду</em>
<a href="#sort"><strong>sort</strong></a></em>.*</p>
<h3 id="_37">Синтаксис команды</h3>
<pre><code>dedup &lt;field-list&gt; [sortby &lt;sort-by-clause&gt;]
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>field-list</strong> – поле или перечень полей, по которым выполняется
    дедупликация.</li>
</ul>
<p>Опциональный параметр:</p>
<ul>
<li>
<p><strong>sortby &lt;sort-by-clause></strong> – порядок сортировки результата дедупликации
    по заданному полю:</p>
<ul>
<li>
<p>в порядке возрастания – при указании префикса '+' перед полем
    сортировки;</p>
</li>
<li>
<p>в порядке убывания – при указании префикса '-' перед полем сортировки.</p>
</li>
</ul>
</li>
</ul>
<h3 id="_38">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Удаляет события, которые содержат идентичное значение поля <em>dest</em> и результат
сортирует по полю <em>sum</em> в порядке возрастания.</p>
<p>Запрос:</p>
<pre><code>... | dedup dest sortby +sum
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
</tbody>
</table>
<h1 id="_39"></h1>
<h1 id="delta">DELTA</h1>
<p>Вычисляет разницу между соседними результатами, используя значение определенного
числового поля. Для каждого события, где поле <em>field</em> является числом, команда
<strong>delta</strong> вычисляет разницу в порядке поиска между значением поля для текущего
события и значением поля для предыдущего события. Команда <strong>delta</strong> записывает
эту разницу в <em>newfield</em>.</p>
<p><strong>Важно! <br />
</strong><em>Порядок, в котором события будут поступать на обработку в команду</em>
<strong>delta</strong><em>, определяется результатами выполнения предыдущих команд. В случае
необходимости сохранения одного и того же порядка событий, необходимо
предусмотреть сортировку событий внутри запроса (использование команды</em>
<a href="#sort"><strong>sort</strong></a><em>).</em></p>
<h3 id="_40">Синтаксис команды</h3>
<pre><code>delta (&lt;field&gt; [AS &lt;newfield&gt;]) [p=&lt;int&gt;]
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>field</strong> – имя поля для анализа.</li>
</ul>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>AS &lt;newfield></strong> – псевдоним для нового поля, в которое будет записана
    вычисляемая разница (дельта).</p>
</li>
<li>
<p><strong>p=&lt;int></strong> – определяет значение какого результата перед текущим
    использовать для сравнения:</p>
<ul>
<li>
<p><strong>p</strong> = <em>1</em> (по умолчанию), текущее значение результата сравнивается со
    значением в первом результате до текущего результата;</p>
</li>
<li>
<p><strong>p</strong> = <em>2</em>, текущее значение результата сравнивается со значением во
    втором результате до текущего результата;</p>
<p>и так далее.</p>
</li>
</ul>
</li>
</ul>
<h3 id="_41">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Считает изменение объёма авиатрафика.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>Date</strong></th>
<th><strong>Departures</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>21.03.2019</td>
<td>150</td>
</tr>
<tr>
<td>22.03.2019</td>
<td>160</td>
</tr>
<tr>
<td>23.03.2019</td>
<td>145</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... | sort Date |delta Departures as Diff
</code></pre>
<p>Результат выполнения:</p>
<table>
<thead>
<tr>
<th><strong>Date</strong></th>
<th><strong>Departures</strong></th>
<th><strong>Diff</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>21.03.2019</td>
<td>150</td>
<td>0</td>
</tr>
<tr>
<td>22.03.2019</td>
<td>160</td>
<td>10</td>
</tr>
<tr>
<td>23.03.2019</td>
<td>145</td>
<td>-15</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Вычисляет дельту транзакций для определённой валюты.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... 
| where currency=&quot;EUR&quot; 
| sort _time 
| delta sum as delta_sum_eur
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
<th><strong>delta_sum_eur</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
<td>0</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
<td>-18</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
<td>4</td>
</tr>
</tbody>
</table>
<h1 id="_42"></h1>
<h1 id="eval">EVAL</h1>
<p>Команда <strong>eval</strong> вычисляет выражение и помещает полученное значение в поле
результатов поиска:</p>
<ul>
<li>
<p>По результатам работы команды <strong>eval</strong> вычисляется новое поле, которое
    добавляется в результаты поиска.</p>
</li>
<li>
<p>Если имя вычисляемого поля совпадает с именем поля, которое уже существует в
    результатах поиска, то результаты выражения <strong>eval</strong> перезаписывают значения
    в существующем поле.</p>
</li>
<li>
<p>Результатом выражения <strong>eval</strong> не может быть логическое значение.</p>
</li>
<li>
<p>Если во время поиска выражение не может быть успешно вычислено для данного
    события, команда <strong>eval</strong> стирает результирующее поле и значением поля
    становится '<em>NULL</em>'.</p>
</li>
<li>
<p>Если выражение ссылается на имя поля, которое не содержит алфавитно-цифровые
    символы за исключением символа подчеркивания (_), то имя поля должно быть
    заключено в кавычки. Например, если имя поля – <em>server-1</em>, указывается <em>new</em>
    = <em>count</em> + <em>"server-1"</em>.</p>
</li>
<li>
<p>Если выражение ссылается на строку (<em>string</em>), то эта строка должна быть
    заключена в кавычки. Например, если имя строки – "server", строка
    указывается как <em>new</em> = "server".</p>
</li>
</ul>
<p>Команда <strong>eval</strong> оценивает математические, строковые и логические выражения.
Можно объединить несколько выражений в одном запросе, используя запятую для
разделения последующих выражений. Запрос обрабатывает несколько выражений
<strong>eval</strong> слева направо и позволяет ссылаться на ранее преобразованные поля в
последующих выражениях.</p>
<h3 id="_43">Синтаксис команды</h3>
<pre><code>eval &lt;field&gt;=&lt;expression&gt;[&quot;,&quot; &lt;field&gt;=&lt;expression&gt;]
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li>
<p><strong>&lt;field>=&lt;expression></strong>:</p>
<ul>
<li>
<p><strong>field</strong> – имя поля назначения для результирующего вычисленного
    значения. Если имя поля уже существует в событиях, <strong>eval</strong>
    перезаписывает значение.</p>
</li>
<li>
<p><strong>expression</strong> – комбинация значений, переменных, операторов и функций,
    которые будут выполнены, чтобы определить значение для размещения в поле
    назначения.</p>
</li>
</ul>
</li>
</ul>
<h4 id="_44">Операторы</h4>
<p>В таблице перечислены основные операции, которые можно выполнить с помощью
команды <strong>eval</strong>. Чтобы эти преобразования работали, значения должны быть
подходящими для конкретного типа операции.</p>
<table>
<thead>
<tr>
<th><strong>Тип операции</strong></th>
<th><strong>Операторы</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Арифметический</td>
<td><strong>+ - * / %</strong></td>
</tr>
<tr>
<td>Логический</td>
<td><strong>AND OR NOT XOR &lt; > &lt;= >= != = == LIKE</strong></td>
</tr>
</tbody>
</table>
<p>Операторы операций над числами:</p>
<ul>
<li>
<p>Оператор плюс (+) принимает два числа для сложения или две строки для
    объединения.</p>
</li>
<li>
<p>Операторы вычитания (-), умножения (*), деления (/) и вычисления остатка от
    деления (%) принимают два числа.</p>
</li>
</ul>
<p>Операторы логических выражений:</p>
<ul>
<li>
<p>Операторы AND и OR принимают два логических значения.</p>
</li>
<li>
<p>Операторы &lt;, >, &lt;=, >=,!=, =, == принимают два числа или две строки.</p>
</li>
<li>
<p>В выражениях одинарный знак равенства (=) является синонимом двойного знака
    равенства (==).</p>
</li>
<li>
<p>Оператор LIKE принимает две строки. Это сопоставление с образцом,
    аналогичное тому, что используется в SQL. Например, строка как шаблон.
    Оператор шаблона поддерживает литеральный текст, символ процента (%) для
    подстановочного знака и символ подчеркивания (<em>) для совпадения одного
    символа. Например, поле LIKE "a% b</em>" соответствует любой строке,
    начинающейся с <em>a</em>, за которой следует что угодно, затем <em>b</em>, за которым
    следует один символ.</p>
</li>
</ul>
<h4 id="_45">Имена полей</h4>
<p>Чтобы указать имя поля из нескольких слов, можно объединить слова или
использовать кавычки при указании имени. Например, чтобы указать имя поля
<em>Account ID</em>, можно указать <em>AccountID</em> или <em>"Account ID"</em>.</p>
<p>Чтобы указать имя поля со специальными символами, такими как точка, можно
использовать кавычки. Например, чтобы указать имя поля <em>www.domain</em>, используйте
"www.domain".</p>
<h4 id="_46">Поддерживаемые функции</h4>
<p>Вместе с командой <strong>eval</strong> можно использовать широкий спектр функций. В таблице
перечислены поддерживаемые функции, разделённые по типу:</p>
<table>
<thead>
<tr>
<th><strong>Тип функции</strong></th>
<th><strong>Поддерживаемые функции</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Сравнительные и условные функции</td>
<td>case(X,"Y",...), coalesce(X,...), if(X,Y,Z), like(TEXT,PATTERN), match(SUBJECT,"REGEX"), nullif(X,Y), true()</td>
</tr>
<tr>
<td>Функции конвертации</td>
<td>printf, tonumber(NUMSTR,BASE), tostring(X,Y)</td>
</tr>
<tr>
<td>Криптографические функции</td>
<td>md5(X), sha1(X)</td>
</tr>
<tr>
<td>Функции даты и времени</td>
<td>now(), relative_time(X,Y), strptime(X,Y)</td>
</tr>
<tr>
<td>Информационные функции</td>
<td>isnotnull(X), isnull(X)</td>
</tr>
<tr>
<td>Математические функции</td>
<td>abs(X), ceiling(X)или ceil(X), exp(X), floor(X), ln(X), log(X,Y), pi(), pow(X,Y), round(X,Y), sqrt(X)</td>
</tr>
<tr>
<td>Функции преобразования для мультизначений</td>
<td>mvappend(X,...), mvcount(MVFIELD), mvdedup(X), mvfind(MVFIELD,"REGEX"), mvindex(MVFIELD,STARTINDEX,ENDINDEX), mvjoin(MVFIELD,STR), mvrange(X,Y,Z), mvsort(X), mvzip(X,Y,"Z"), split(X,"Y")</td>
</tr>
<tr>
<td>Статистические функции</td>
<td>max(X,...), min(X,...)</td>
</tr>
<tr>
<td>Текстовые функции</td>
<td>len(X), lower(X), replace(X,Y,Z), substr(X,Y,Z), upper(X)</td>
</tr>
<tr>
<td>Тригонометрические и гиперболические функции</td>
<td>acos(X), asin(X), atan(X), atan2(Y,X), cos(X), hypot(X,Y), sin(X), tan(X)</td>
</tr>
</tbody>
</table>
<h3 id="_47">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Создаёт новое поле <em>transaction</em>, объединяя значения из трёх существующих полей.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... | eval transaction=sum+&quot; &quot;+currency+&quot; &quot;+dest
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
<th><strong>transaction</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
<td>10 RUB Russia</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
<td>7 USD Russia</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
<td>21 EUR Germany</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
<td>3 EUR USA</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
<td>19 RUB Germany</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
<td>7 EUR Russia</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Преобразует значения поля <em>currency</em> в нижний регистр.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... | eval currency_low=lower(currency)
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
<th><strong>currency_low</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
<td>rub</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
<td>usd</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
<td>eur</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
<td>eur</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
<td>rub</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
<td>eur</td>
</tr>
</tbody>
</table>
<p><strong>Пример 3</strong></p>
<p>Использует функцию if для оценки размера транзакций.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... | eval &quot;Transaction size&quot;=if(sum&gt;15, &quot;Large&quot;, &quot;Small&quot;)
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
<th><strong>Transaction size</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
<td>Small</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
<td>Small</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
<td>Large</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
<td>Small</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
<td>Large</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
<td>Small</td>
</tr>
</tbody>
</table>
<p><strong>Пример 4</strong></p>
<p>Присваивает категорию размеру авиатрафика в терминалах аэропорта в разрезе
календарных суток.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>Terminal</strong></th>
<th><strong>Date</strong></th>
<th><strong>Arrivals</strong></th>
<th><strong>Departures</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>TerminalA</td>
<td>27.03.2019</td>
<td>235</td>
<td>321</td>
</tr>
<tr>
<td>TerminalB</td>
<td>27.03.2019</td>
<td>178</td>
<td>167</td>
</tr>
<tr>
<td>TerminalC</td>
<td>27.03.2019</td>
<td>79</td>
<td>68</td>
</tr>
<tr>
<td>TerminalA</td>
<td>28.03.2019</td>
<td>116</td>
<td>178</td>
</tr>
<tr>
<td>TerminalB</td>
<td>28.03.2019</td>
<td>265</td>
<td>245</td>
</tr>
<tr>
<td>TerminalC</td>
<td>28.03.2019</td>
<td>64</td>
<td>60</td>
</tr>
<tr>
<td>TerminalA</td>
<td>29.03.2019</td>
<td>223</td>
<td>216</td>
</tr>
<tr>
<td>TerminalB</td>
<td>29.03.2019</td>
<td>98</td>
<td>101</td>
</tr>
<tr>
<td>TerminalC</td>
<td>29.03.2019</td>
<td>187</td>
<td>198</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... 
| eval Air_traffic_size=case((Arrivals+Departures)&lt;=200, &quot;Small&quot;, (Arrivals+Departures)&gt;100 AND (Arrivals+Departures)&lt;=400, &quot;Medium&quot;, (Arrivals+Departures)&gt;400, &quot;Large&quot;) 
| chart values(Terminal) by Air_traffic_size over Date
</code></pre>
<p>В этом примере используется команда <a href="#chart"><strong>chart</strong></a> для представления
категории размера трафика в разрезе дней.</p>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Date</strong></th>
<th><strong>Large</strong></th>
<th><strong>Medium</strong></th>
<th><strong>Small</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>27.03.2019</td>
<td>TerminalA</td>
<td>TerminalB</td>
<td>TerminalC</td>
</tr>
<tr>
<td>28.03.2019</td>
<td>TerminalB</td>
<td>TerminalA</td>
<td>TerminalC</td>
</tr>
<tr>
<td>29.03.2019</td>
<td>TerminalA</td>
<td>TerminalC</td>
<td>TerminalB</td>
</tr>
</tbody>
</table>
<h1 id="_48"></h1>
<h1 id="eventstats">EVENTSTATS</h1>
<p>Команда считает статистику из значений полей и сохраняет результат в новом поле.
В статистике участвуют события, имеющие в своем составе поля, для которых должна
быть посчитана статистика.</p>
<h3 id="_49">Синтаксис команды</h3>
<pre><code>eventstats &lt;stats-agg-term&gt; ... [&lt;by-clause&gt;]
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li>
<p><strong>stats-agg-term</strong> – статистические функции, применяемые к полям и
    eval-выражениям. Результат выполнения функции может быть помещён в отдельное
    поле с именем, указанным после операнда <em>AS</em>.</p>
<p>Синтаксис:</p>
</li>
</ul>
<pre><code>&lt;stats-func&gt;( &lt;evaled-field&gt; | &lt;wc-field&gt; ) [AS &lt;new-field&gt;]
</code></pre>
<p>Перечень функций представлен в разделе ниже.</p>
<p>Опциональный параметр:</p>
<ul>
<li>
<p><strong>by-clause</strong> – поле или несколько полей, по которым надо рассчитать
    агрегацию (группировку).</p>
<p>Синтаксис:</p>
</li>
</ul>
<pre><code>by &lt;field1&gt; &lt;field2&gt; ....
</code></pre>
<h4 id="_50">Статистические функции</h4>
<p>Функции позволяют получить различные статистики по полю или eval-выражению, к
которому они применяются.</p>
<p>В таблице представлен перечень функций, сгруппированных по типам:</p>
<table>
<thead>
<tr>
<th><strong>Имя функции</strong></th>
<th><strong>Описание функции</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Агрегирующие функции:</strong></td>
<td></td>
</tr>
<tr>
<td><em>approxdc()</em></td>
<td>Приблизительное количество уникальных значений.</td>
</tr>
<tr>
<td><em>avg()</em></td>
<td>Среднее арифметическое.</td>
</tr>
<tr>
<td><em>count()</em></td>
<td>Количество значений.</td>
</tr>
<tr>
<td><em>distinct_count()</em></td>
<td>Количество уникальных значений.</td>
</tr>
<tr>
<td><em>max()</em></td>
<td>Наибольшее значение.</td>
</tr>
<tr>
<td><em>min()</em></td>
<td>Наименьшее значение.</td>
</tr>
<tr>
<td><em>perc()</em></td>
<td>Процентиль.</td>
</tr>
<tr>
<td><em>percentile_approx()</em></td>
<td></td>
</tr>
<tr>
<td><em>stdev()</em></td>
<td>Стандартное отклонение.</td>
</tr>
<tr>
<td><em>sum()</em></td>
<td>Сумма значений.</td>
</tr>
<tr>
<td><em>var()</em></td>
<td>Дисперсия.</td>
</tr>
<tr>
<td><strong>Порядковые функции:</strong></td>
<td></td>
</tr>
<tr>
<td><em>first()</em></td>
<td>Первое значение в таблице.</td>
</tr>
<tr>
<td><em>last()</em></td>
<td>Последнее значение в таблице.</td>
</tr>
<tr>
<td><strong>Функции для работы с multivalue-полями:</strong></td>
<td></td>
</tr>
<tr>
<td><em>list()</em></td>
<td>Список значений.</td>
</tr>
<tr>
<td><em>values()</em></td>
<td></td>
</tr>
<tr>
<td><strong>Временные функции:</strong></td>
<td></td>
</tr>
<tr>
<td><em>earliest()</em></td>
<td>Первое значение в таблице.</td>
</tr>
<tr>
<td><em>latest()</em></td>
<td>Последнее значение в таблице.</td>
</tr>
</tbody>
</table>
<h3 id="_51">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Вычисляется максимальное и минимальное значение поля <em>sum</em>. В каждом событии
создается два новых поля (<em>maxsum</em> и <em>minsum</em>), в которые записываются
результаты вычислений.</p>
<p>Запрос:</p>
<pre><code>... | eventstats  max(sum) AS maxsum min(sum) AS minsum
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
<th><strong>maxsum</strong></th>
<th><strong>minsum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
<td>21</td>
<td>3</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
<td>21</td>
<td>3</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
<td>21</td>
<td>3</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
<td>21</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
<td>21</td>
<td>3</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
<td>21</td>
<td>3</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Вычисляется сумма поля <em>sum</em> в разбивке по странам. В каждое событие добавляется
новое поле, содержащее сумму значений <em>sum</em> для каждой страны. Имя нового поля –
<em>sumTotal</em>.</p>
<p>Запрос:</p>
<pre><code>... | eventstats sum(sum) AS sumTotal by dest
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
<th><strong>sumTotal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
<td>34</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
<td>34</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
<td>40</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
<td>40</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
<td>34</td>
</tr>
</tbody>
</table>
<h1 id="_52"></h1>
<h1 id="fields-table">FIELDS (TABLE)</h1>
<p>Команда оставляет или удаляет выбранные поля из результатов запроса. В случае,
если команда помещена в конце запроса, то на экран будут выведены указанные
поля. Если команда указана в середине запроса, то дальнейшая обработка данных
будет происходить с указанными после <strong>fields</strong> полями. Синоним команды –
<strong>table</strong>.</p>
<h3 id="_53">Синтаксис команды</h3>
<pre><code>fields [-|*] &lt;field-list&gt; 
</code></pre>
<p>По умолчанию поле <em>_raw</em> не выводится на экран.</p>
<p>Обязательный параметр:</p>
<ul>
<li>
<p><strong>field-list</strong> – список полей (через запятую), к которым должна быть
    применена команда <strong>fields</strong>. Также для указания полей с похожими именами
    можно использовать * (wildcard).</p>
<p>Синтаксис:</p>
</li>
</ul>
<pre><code>&lt;field1&gt;, &lt;field2&gt;, ...
</code></pre>
<p>Опциональный параметр:</p>
<ul>
<li>
<p><strong>-|*</strong> – символ минус "-" или звездочка:</p>
<ul>
<li>
<p>"-" – поля, указанные после этого символа, будут удалены из результатов
    запроса.</p>
</li>
<li>
<p>"*" – будут получены все поля, включая поле <em>_raw</em>.</p>
</li>
</ul>
</li>
</ul>
<h3 id="_54">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Surname</strong></th>
<th><strong>age</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>John</td>
<td>Snow</td>
<td>10</td>
</tr>
<tr>
<td>Alex</td>
<td>Smith</td>
<td>7</td>
</tr>
<tr>
<td>Anna</td>
<td>Show</td>
<td>21</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Удаляем из вывода поле <em>age</em>.</p>
<p>Запрос:</p>
<pre><code>... | fields – age
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Surname</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>John</td>
<td>Snow</td>
</tr>
<tr>
<td>Alex</td>
<td>Smith</td>
</tr>
<tr>
<td>Anna</td>
<td>Show</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Выводим только поля <em>Name</em> и <em>age</em></p>
<pre><code>... | fields Name, age
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>age</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>John</td>
<td>10</td>
</tr>
<tr>
<td>Alex</td>
<td>7</td>
</tr>
<tr>
<td>Anna</td>
<td>21</td>
</tr>
</tbody>
</table>
<h1 id="_55"></h1>
<h1 id="fieldsummary">FIELDSUMMARY</h1>
<p>Команда вычисляет сводную статистику для всех полей в событиях. Сводная
информация отображается в виде таблицы результатов.</p>
<h3 id="_56">Синтаксис команды</h3>
<pre><code>fieldsummary
</code></pre>
<h3 id="_57">Использование команды</h3>
<p>Команда <strong>fieldsummary</strong> отображает сводную информацию в таблице результатов:</p>
<table>
<thead>
<tr>
<th><strong>Сводное имя поля</strong></th>
<th><strong>Описание поля</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>column</em></td>
<td>Имя поля в событии.</td>
</tr>
<tr>
<td><em>count</em></td>
<td>Количество событий с этим полем.</td>
</tr>
<tr>
<td><em>max</em></td>
<td>Максимальное значение поля.</td>
</tr>
<tr>
<td><em>mean</em></td>
<td>Среднее значение поля.</td>
</tr>
<tr>
<td><em>min</em></td>
<td>Минимальное значение поля.</td>
</tr>
<tr>
<td><em>stdev</em></td>
<td>Стандартное отклонение значений поля.</td>
</tr>
</tbody>
</table>
<h3 id="_58">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Вывести суммарную информацию из транзакций по определённой валюте.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... 
| where currency=&quot;EUR&quot; 
| table sum 
| fieldsummary
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>column</strong></th>
<th><strong>count</strong></th>
<th><strong>max</strong></th>
<th><strong>mean</strong></th>
<th><strong>min</strong></th>
<th><strong>stddev</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>sum</td>
<td>3</td>
<td>21</td>
<td>10.333333333333334</td>
<td>3</td>
<td>9.451631252505216</td>
</tr>
</tbody>
</table>
<h1 id="_59"></h1>
<h1 id="filldown">FILLDOWN</h1>
<p>Если значение поля <em>NULL</em>, то команда заполняет поле ближайшим сверху значением
этого же поля, не равным <em>NULL</em>. Если у поля не было предыдущих не-<em>NULL</em>
значений, то после применения <strong>filldown</strong> поле остаётся пустым (<em>NULL</em>).</p>
<p>Если список полей не объявлен, то команда <strong>filldown</strong> пытается отработать на
всех полях.</p>
<h3 id="_60">Синтаксис команды</h3>
<pre><code>filldown [&lt;wc-field-list&gt; [BY &lt;field-group&gt;]]
</code></pre>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>wc-field-list</strong> – разделённые запятой имена полей, к которым будет
    применена команда <strong>filldown</strong>. Синтаксис: <em>&lt;field1>, &lt;field2>,</em> ...</p>
</li>
<li>
<p><strong>BY</strong> &lt;<strong>field-group</strong>> – поле, по которому в таблице будет выполнена
    группировка для дальнейшего заполнения <em>NULL</em>-значений полей, указанных в
    параметре <strong>wc-field-list</strong>, отдельно по каждой группе.</p>
<p><strong>Важно!</strong></p>
<p><em>При использовании параметра</em> <strong>BY &lt;field-group></strong> <em>должен быть определён
параметр</em> <strong>wc-field-list</strong><em>.</em></p>
</li>
</ul>
<h3 id="_61">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045111</td>
<td>RUB</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>USA</td>
<td>20</td>
</tr>
<tr>
<td>1587045121</td>
<td>USD</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1587045121</td>
<td>EUR</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1587045111</td>
<td>RUB</td>
<td>Russia</td>
<td></td>
</tr>
<tr>
<td>1587045121</td>
<td>EUR</td>
<td>Italy</td>
<td>40</td>
</tr>
<tr>
<td>1587045111</td>
<td>RUB</td>
<td>Russia</td>
<td>30</td>
</tr>
<tr>
<td>1587045122</td>
<td>RUB</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1587045122</td>
<td>EUR</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Если значение любого поля есть <em>NULL</em>, то оно заполняется ближайшим сверху
не-<em>NULL</em> значением этого же поля.</p>
<p>Запрос:</p>
<pre><code>... | filldown
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045111</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>USA</td>
<td>20</td>
</tr>
<tr>
<td>1587045121</td>
<td>USD</td>
<td>USA</td>
<td>20</td>
</tr>
<tr>
<td>1587045121</td>
<td>EUR</td>
<td>USA</td>
<td>20</td>
</tr>
<tr>
<td>1587045111</td>
<td>RUB</td>
<td>Russia</td>
<td>20</td>
</tr>
<tr>
<td>1587045121</td>
<td>EUR</td>
<td>Italy</td>
<td>40</td>
</tr>
<tr>
<td>1587045111</td>
<td>RUB</td>
<td>Russia</td>
<td>30</td>
</tr>
<tr>
<td>1587045122</td>
<td>RUB</td>
<td>Russia</td>
<td>30</td>
</tr>
<tr>
<td>1587045122</td>
<td>EUR</td>
<td>Russia</td>
<td>30</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Если значение поля <em>dest</em> есть <em>NULL</em>, то оно заполняется ближайшим сверху
не-<em>NULL</em> значением поля <em>dest</em>.</p>
<p>Запрос:</p>
<pre><code>... | filldown dest
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045111</td>
<td>RUB</td>
<td>Russia</td>
<td></td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>USA</td>
<td>20</td>
</tr>
<tr>
<td>1587045121</td>
<td>USD</td>
<td>USA</td>
<td></td>
</tr>
<tr>
<td>1587045121</td>
<td>EUR</td>
<td>USA</td>
<td></td>
</tr>
<tr>
<td>1587045111</td>
<td>RUB</td>
<td>Russia</td>
<td></td>
</tr>
<tr>
<td>1587045121</td>
<td>EUR</td>
<td>Italy</td>
<td>40</td>
</tr>
<tr>
<td>1587045111</td>
<td>RUB</td>
<td>Russia</td>
<td>30</td>
</tr>
<tr>
<td>1587045122</td>
<td>RUB</td>
<td>Russia</td>
<td></td>
</tr>
<tr>
<td>1587045122</td>
<td>EUR</td>
<td>Russia</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Пример 3</strong></p>
<p>Если значение определённого в параметре &lt;<em>wc-field-list></em> поля есть <em>NULL,</em> и
в команде присутствует параметр <em>BY &lt;field-group></em>, то оно заполняется
ближайшим сверху не-<em>NULL</em> значением этого же поля в пределах категории,
определённой значением параметра <em>BY &lt;field-group></em>.</p>
<p>Запрос:</p>
<pre><code>... | filldown dest by currency
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045111</td>
<td>RUB</td>
<td>Russia</td>
<td></td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>USA</td>
<td>20</td>
</tr>
<tr>
<td>1587045121</td>
<td>USD</td>
<td>USA</td>
<td></td>
</tr>
<tr>
<td>1587045121</td>
<td>EUR</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1587045111</td>
<td>RUB</td>
<td>Russia</td>
<td></td>
</tr>
<tr>
<td>1587045121</td>
<td>EUR</td>
<td>Italy</td>
<td>40</td>
</tr>
<tr>
<td>1587045111</td>
<td>RUB</td>
<td>Russia</td>
<td>30</td>
</tr>
<tr>
<td>1587045122</td>
<td>RUB</td>
<td>Russia</td>
<td></td>
</tr>
<tr>
<td>1587045122</td>
<td>EUR</td>
<td>Italy</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Пример 4</strong></p>
<p>Если требуется заменить <em>NULL</em>-значения в тех полях таблицы, где значения могут
быть <em>NULL</em>, и в команде присутствует параметр <em>BY &lt;field-group></em>, то следует
явно указать эти поля.</p>
<p>Запрос:</p>
<pre><code>... | filldown datetime, dest, sum by currency
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045111</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>USA</td>
<td>20</td>
</tr>
<tr>
<td>1587045121</td>
<td>USD</td>
<td>USA</td>
<td>20</td>
</tr>
<tr>
<td>1587045121</td>
<td>EUR</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1587045111</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045121</td>
<td>EUR</td>
<td>Italy</td>
<td>40</td>
</tr>
<tr>
<td>1587045111</td>
<td>RUB</td>
<td>Russia</td>
<td>30</td>
</tr>
<tr>
<td>1587045122</td>
<td>RUB</td>
<td>Russia</td>
<td>30</td>
</tr>
<tr>
<td>1587045122</td>
<td>EUR</td>
<td>Italy</td>
<td>40</td>
</tr>
</tbody>
</table>
<h1 id="_62"></h1>
<h1 id="fillnull">FILLNULL</h1>
<p>Если значение поля отсутствует, то есть равно NULL, то оно заполняется заданным
в качестве аргумента значением. Если не определить конкретное значение для
автозаполнения NULL-поля, то оно будет заполнено нулем (0). Если не определить
список имен полей, NULL-значения которых должны быть автоматически заполнены, то
будут заполнены все NULL-значения всех полей.</p>
<h3 id="_63">Синтаксис команды</h3>
<pre><code>fillnull [value=&lt;string&gt;] [&lt;field-list&gt;]
</code></pre>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>field-list</strong> – одно или несколько полей, разделенных пробелами. Если
    параметр не задан, то команда <strong>fillnull</strong> применяется ко всем полям.
    Синтаксис: &lt;string> &lt;string> ...</p>
</li>
<li>
<p><strong>value=&lt;string></strong> – определяет, чем будут заполнены NULL-значения.
    Значение по умолчанию – <em>0</em>.</p>
</li>
</ul>
<h3 id="_64">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Если значение любого поля есть NULL, то оно заполняется значением "<em>no_value</em>".</p>
<p>Запрос:</p>
<pre><code>...  | fillnull value=&quot;no_value&quot;
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>no_value</td>
<td>no_value</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Если значение поля <em>sum</em> есть NULL, то оно заполняется значением по умолчанию то
есть <em>0</em>. Null-значения остальных полей остаются неизменными.</p>
<pre><code>... | fillnull  sum
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td></td>
<td>0</td>
</tr>
</tbody>
</table>
<h1 id="_65"></h1>
<h1 id="foreach">FOREACH</h1>
<p>Команда запускает шаблонный поисковый запрос для каждого поля, к которому есть
обращение через <em>wildcard-</em>конструкции в синтаксисе команды.</p>
<h3 id="_66">Синтаксис команды</h3>
<pre><code>foreach &lt;wc-field&gt;... &lt;subsearch&gt;
</code></pre>
<p>Обязательные параметры:</p>
<ul>
<li>
<p><strong>wc-field</strong> – список имен полей, к которым будет применяться шаблонный
    поисковый запрос. Можно использовать <em>wildcard</em>-конструкции при задании
    полей. Синтаксис: <em>&lt;field1> &lt;field2>...</em></p>
</li>
<li>
<p><strong>subsearch</strong> – поисковый запрос-шаблон, который будет применяться к полям
    wc-field, заменяя <em>wildcard</em> поля конкретными значениями. Синтаксис: <em>[
    subsearch ]</em>.</p>
</li>
</ul>
<p>В тексте шаблонного запроса допускается использование следующих
wildcard-конструкций:</p>
<ul>
<li>
<p><em>&lt;&lt;FIELD></em>> – токен <em>&lt;&lt;FIELD>></em> будет заменен именем поля целиком.</p>
</li>
<li>
<p><em>&lt;&lt;MATCHSTR>></em> – токен &lt;&lt;MATCHSTR>> будет заменен частью имени поля,
    которая определяется <em>wildcard</em>-правилами.</p>
</li>
</ul>
<h3 id="_67">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>USD</td>
<td>USA</td>
<td>20</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Создает поле <em>newfield</em> в каждой строке результата. В каждой строке поле
<em>newfield</em> определяется как сумма фиксированной части <em>newfield</em>, равной 5, и
текущего значения полей <em>sum</em> (сложение работает как сложение чисел) и
<em>currency</em> (сложение работает как строковая операция).</p>
<p>Запрос:</p>
<pre><code>...  
| eval newfield=5, sum=tonumber(sum) 
| foreach sum, currency [eval newfield = newfield+'&lt;&lt;FIELD&gt;&gt;']
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
<th><strong>newfield</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
<td>15.0RUB</td>
</tr>
<tr>
<td>USD</td>
<td>USA</td>
<td>20</td>
<td>25.0USA</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Создает поле <em>newfield</em> в каждой строке результата.</p>
<p>Создает поле <em>newfield</em> в каждой строке результата. В каждой строке поле
<em>newfield</em> определяется как сложение следующих полей: поля, совпадающего с полем
<em>currency</em> (подходит по <em>wildcard</em> = cu*cy), и фиксированной части
"<em>currency</em>". Сложение работает как строковая операция.</p>
<p>Запрос:</p>
<pre><code>... 
|eval newfield=&quot;&quot; 
| foreach cu*cy [eval newfield = newfield + '&lt;&lt;FIELD&gt;&gt;' +  &quot;_currency&quot;]
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
<th><strong>newfield</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
<td>RUS_currency</td>
</tr>
<tr>
<td>USD</td>
<td>USA</td>
<td>20</td>
<td>USA_currency</td>
</tr>
</tbody>
</table>
<h1 id="_68"></h1>
<h1 id="head">HEAD</h1>
<p>Команда возвращает первые <em>N</em> результатов поиска. Отсчет результатов будет
вестись в порядке поиска, то есть, в том порядке, в котором события поступают на
вход команды <strong>head</strong> после обработки предыдущими командами.</p>
<p><strong>Важно!<br />
</strong><em>Порядок, в котором события будут поступать на обработку в команду</em> <strong>head,</strong>
<em>определяется результатом выполнения предыдущих команд. Иногда один и тот же
порядок событий не может быть гарантирован для разных запусков запроса. В случае
необходимости сохранения одинакового порядка событий для разных запусков
запроса, необходимо предусмотреть сортировку событий до их поступления на вход
команды</em> <strong>head</strong><em>. Для этого можно использовать команду</em> <a href="#sort"><strong>sort</strong></a><em>.</em></p>
<h3 id="_69">Синтаксис команды</h3>
<pre><code>head [&lt;N&gt;] | [limit=&lt;int&gt;]
</code></pre>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>N</strong> – целое число, определяющее количество возвращаемых результатов.</p>
</li>
<li>
<p><strong>limit=&lt;int></strong> – другой вариант задания количества возвращаемых
    результатов. Если значение возвращаемых результатов не задано, то <strong>head</strong>
    возвращает 10 результатов.</p>
</li>
</ul>
<h3 id="_70">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>USD</td>
<td>USA</td>
<td>20</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Возвращает первый результат из полученных до выполнения команды <strong>head</strong>.</p>
<p>Запрос:</p>
<pre><code>...  | head 1
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
</tbody>
</table>
<h1 id="_71"></h1>
<h1 id="inputlookup">INPUTLOOKUP</h1>
<p>Команда <strong>inputlookup</strong> используется для вывода содержимого lookup-таблицы и
поиска по ней. Lookup-таблица это файл в <em>CSV</em>-формате.</p>
<p><strong>Важно!</strong></p>
<p><em>Эту команду не рекомендуется применять при поиске по датам и времени. Для
получения корректного результата поиска по датам и времени используйте команды</em>
<a href="#otstats"><strong>otstats</strong></a> <em>и</em> <a href="#search-filter"><strong>search</strong></a><em>.</em></p>
<h3 id="_72">Синтаксис команды</h3>
<pre><code>inputlookup [append=&lt;bool&gt;] &lt;filename&gt; [WHERE &lt;search-query&gt;]
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>filename</strong> – имя lookup-файла. Lookup-файл может не иметь расширения
    <em>.csv</em>, но должен быть в формате <em>CSV</em>.</li>
</ul>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>append=&lt;bool></strong>:</p>
<ul>
<li>
<p>если <strong>append</strong>=<em>true</em>, то данные lookup-файла будут присоединены к
    результатам, полученным до вызова команды <strong>inputlookup</strong>.</p>
</li>
<li>
<p>если <strong>append</strong>=<em>false</em> (значение по умолчанию), то содержимое
    lookup-файла заменит результаты, полученные до вызова команды
    <strong>inputlookup</strong>.</p>
</li>
</ul>
</li>
<li>
<p><strong>WHERE</strong> &lt;<strong>search-query</strong>> – опция для предварительной фильтрации данных
    lookup-файла. Результатом поискового запроса будут только те строки
    lookup-файла, которые попадут под условия фильтрации.<br />
    Поддерживается следующий набор операторов: <em>=, !=, &lt;, >, &lt;=, >=, AND,
    OR, NOT</em>.</p>
</li>
</ul>
<h3 id="_73">Примеры использования</h3>
<p>Исходные данные:</p>
<p>lookup-файл <em>money_senders.csv</em> со следующим содержимым:</p>
<table>
<thead>
<tr>
<th><strong>dest_country</strong></th>
<th><strong>sender</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RUS</td>
<td>John</td>
<td>20</td>
</tr>
<tr>
<td>USA</td>
<td>Mary</td>
<td>10</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Выводит содержимое lookup-файла <em>money_senders.csv</em>.</p>
<p>Запрос:</p>
<pre><code>...| inputlookup  money_senders.csv
</code></pre>
<p>Результат выполнения:</p>
<table>
<thead>
<tr>
<th><strong>dest_country</strong></th>
<th><strong>sender</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RUS</td>
<td>John</td>
<td>20</td>
</tr>
<tr>
<td>USA</td>
<td>Mary</td>
<td>10</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Присоединяет содержимое lookup-файла <em>money_senders.csv</em> к результатам
поискового запроса до вызова команды <strong>inputlookup</strong>.</p>
<p>Запрос:</p>
<pre><code>| makeresults 
| eval dest_country=&quot;France&quot;, sender=&quot;Tom&quot;,sum=99 
| inputlookup append=t  money_senders.csv
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>dest_country</strong></th>
<th><strong>sender</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>France</td>
<td>Tom</td>
<td>99</td>
</tr>
<tr>
<td>RUS</td>
<td>John</td>
<td>20</td>
</tr>
<tr>
<td>USA</td>
<td>Mary</td>
<td>10</td>
</tr>
</tbody>
</table>
<p><strong>Пример 3</strong></p>
<p>Выводит только те строки lookup-файла, в которых поле <em>sum</em> строго больше 10.</p>
<p>Запрос:</p>
<pre><code>... | inputlookup append=t  money_senders.csv where sum&gt;10
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>dest_country</strong></th>
<th><strong>sender</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RUS</td>
<td>John</td>
<td>20</td>
</tr>
</tbody>
</table>
<h1 id="_74"></h1>
<h1 id="join">JOIN</h1>
<p>Команда <strong>join</strong> комбинирует результаты поискового подзапроса с результатами
основного запроса. Основной запрос и подзапрос должны содержать в себе одно или
несколько идентичных полей.</p>
<p>Альтернативные команды. Если для решения задачи не требуется в точности
семантика <strong>join</strong>, то использование схожих по функционалу команд может быть
более целесообразно: <a href="#append-union"><strong>append</strong></a>, <a href="#appendcols"><strong>appendcols</strong></a>,
<a href="#lookup"><strong>lookup</strong></a>, <a href="#search-filter"><strong>search</strong></a>, <a href="#stats"><strong>stats</strong></a>.</p>
<h3 id="_75">Синтаксис команды</h3>
<pre><code>join [join-options...] [&lt;field-list&gt;] &lt;subsearch&gt;
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>subsearch</strong> – возвращающий результаты поисковый подзапрос, к которому
    будут присоединены результаты основного запроса.</li>
</ul>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>join-options</strong> – опции команды <strong>join</strong>.</p>
<p>Синтаксис: type=(inner | outer | left | right) | max=&lt;int>.</p>
<p>Описание:</p>
<ul>
<li>
<p><strong>type</strong> – тип команды <strong>join</strong>.</p>
<p>Синтаксис: type=inner | outer | left | right.</p>
<p>Значение по умолчанию: <em>left</em>.</p>
<p>Разница между типами заключается в том, каким образом обрабатываются
события основного запроса, которые не могут быть поставлены в
соответствие событиям поискового подзапроса. Как в <strong>inner</strong> так и в
<strong>left</strong> возвращаются только те события, которые могут быть поставлены в
соответствие друг другу по заданному полю. Однако результаты <em>inner
join</em> не включают события основного запроса, которые не имеют совпадений
в подзапросе. Результат же <em>left join</em> (или <em>outer join</em>) включает все
события основного запроса и те события из подзапроса, которые могут быть
поставлены в соответствие событиям основного запроса по заданному полю. </p>
<p>См. примеры 3, 4, 5.</p>
</li>
<li>
<p><strong>max</strong> – максимальное возвращаемое количество результатов поискового
    подзапроса, с которым будет объединён каждый результат основного
    запроса. Параметр, равный нулю (<em>0</em>), означает, что ограничений на
    количество результатов нет.</p>
<p>Значение по умолчанию: <em>0</em>.</p>
<p>Синтаксис: max=&lt;int>.</p>
</li>
</ul>
</li>
<li>
<p><strong>field-list</strong> – поля, по которым будет выполняться команда <strong>join</strong>.
    Совпадение значений полей основного запроса и подзапроса должно быть с
    точностью до регистра отдельных символов.</p>
<p>Синтаксис: &lt;field1>, &lt;field2>, ...</p>
</li>
</ul>
<h3 id="_76">Примеры использования</h3>
<p>Исходные данные:</p>
<p><em>Результат Запроса_1</em>. Для удобства результат представлен в виде таблицы
(search1.csv):</p>
<table>
<thead>
<tr>
<th><strong>currency</strong></th>
<th><strong>dest_country</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>EUR</td>
<td>Italy</td>
<td>10</td>
</tr>
<tr>
<td>USD</td>
<td>Russia</td>
<td>13</td>
</tr>
<tr>
<td>RUB</td>
<td>Canada</td>
<td>14</td>
</tr>
<tr>
<td>EUR</td>
<td>Canada</td>
<td>1</td>
</tr>
<tr>
<td>USD</td>
<td>Russia</td>
<td>3</td>
</tr>
<tr>
<td>MXN</td>
<td>Mexico</td>
<td>7</td>
</tr>
</tbody>
</table>
<p><em>Результат Запроса_2</em>. Для удобства результат представлен в виде таблицы
(search2.csv):</p>
<table>
<thead>
<tr>
<th><strong>commission</strong></th>
<th><strong>dest_country</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1,7%</td>
<td>Canada</td>
</tr>
<tr>
<td>3.3%</td>
<td>Italy</td>
</tr>
<tr>
<td>2%</td>
<td>Russia</td>
</tr>
<tr>
<td>2.1%</td>
<td>Georgia</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Соединяет результаты <em>Запроса_1</em> с результатами <em>Запроса_2</em> по полю
<em>dest_country</em>.</p>
<p>Запрос:</p>
<pre><code>...
| inputlookup  search1.csv 
| join dest_country  [| inputlookup  search2.csv]
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>commission</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest_country</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>3.3%</td>
<td>EUR</td>
<td>Italy</td>
<td>10</td>
</tr>
<tr>
<td>2%</td>
<td>USD</td>
<td>Russia</td>
<td>13</td>
</tr>
<tr>
<td>7%</td>
<td>RUB</td>
<td>Canada</td>
<td>14</td>
</tr>
<tr>
<td>7%</td>
<td>EUR</td>
<td>Canada</td>
<td>1</td>
</tr>
<tr>
<td>2%</td>
<td>USD</td>
<td>Russia</td>
<td>3</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Соединяет результаты <em>Запроса_2</em> с результатами <em>Запроса_1</em> по полю
<em>dest_country</em>. Видно, что каждому результату <em>Запроса_2</em>, который в примере
является основным запросом, ставится в соответствие один результат <em>Запроса_1</em>
(используется опция <em>max=1</em>), который в примере является подзапросом. Если
<em>max=1</em> задан не будет, то ограничений по числу "соединений" полей не будет.</p>
<pre><code>...
| inputlookup  search2.csv 
| join dest_country max=1 [| inputlookup search1.csv]
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>commission</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest_country</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2%</td>
<td>USD</td>
<td>Russia</td>
<td>3</td>
</tr>
<tr>
<td>3.3%</td>
<td>EUR</td>
<td>Italy</td>
<td>10</td>
</tr>
<tr>
<td>7%</td>
<td>EUR</td>
<td>Canada</td>
<td>1</td>
</tr>
</tbody>
</table>
<p><strong>Пример 3</strong></p>
<p>Пример операции <em>join type=outer</em>.</p>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>commission</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest_country</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>3.3%</td>
<td>EUR</td>
<td>Italy</td>
<td>10</td>
</tr>
<tr>
<td>3.4%</td>
<td>MXN</td>
<td>Mexico</td>
<td>7</td>
</tr>
<tr>
<td>1.7%</td>
<td>RUB</td>
<td>Canada</td>
<td>14</td>
</tr>
<tr>
<td>1.7%</td>
<td>EUR</td>
<td>Canada</td>
<td>1</td>
</tr>
<tr>
<td>2%</td>
<td>USD</td>
<td>Russia</td>
<td>13</td>
</tr>
<tr>
<td>2%</td>
<td>USD</td>
<td>Russia</td>
<td>3</td>
</tr>
</tbody>
</table>
<p><strong>Пример 4</strong></p>
<p>Пример операции <em>join type=left</em>.</p>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>commission</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest_country</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>3.3%</td>
<td>EUR</td>
<td>Italy</td>
<td>10</td>
</tr>
<tr>
<td>2%</td>
<td>USD</td>
<td>Russia</td>
<td>13</td>
</tr>
<tr>
<td>1.7%</td>
<td>RUB</td>
<td>Canada</td>
<td>14</td>
</tr>
<tr>
<td>1.7%</td>
<td>EUR</td>
<td>Canada</td>
<td>1</td>
</tr>
<tr>
<td>2%</td>
<td>USD</td>
<td>Russia</td>
<td>3</td>
</tr>
<tr>
<td>3.4%</td>
<td>MXN</td>
<td>Mexico</td>
<td>7</td>
</tr>
</tbody>
</table>
<p><strong>Пример 5</strong></p>
<p>Пример операции <em>join type=inner</em>.</p>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>commission</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest_country</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1.7%</td>
<td>EUR</td>
<td>Canada</td>
<td>1</td>
</tr>
<tr>
<td>1.7%</td>
<td>RUB</td>
<td>Canada</td>
<td>14</td>
</tr>
<tr>
<td>3.3%</td>
<td>EUR</td>
<td>Italy</td>
<td>10</td>
</tr>
<tr>
<td>2%</td>
<td>USD</td>
<td>Russia</td>
<td>3</td>
</tr>
<tr>
<td>2%</td>
<td>USD</td>
<td>Russia</td>
<td>13</td>
</tr>
</tbody>
</table>
<h1 id="_77"></h1>
<h1 id="lookup">LOOKUP</h1>
<p>Команда используется для добавления поля из существующей таблицы в результаты
запроса. В качестве существующей таблицы обычно выступает таблица в CSV-формате,
сохраненная в файловой системе.</p>
<h3 id="_78">Синтаксис команды</h3>
<pre><code>lookup &lt;lookup-file&gt; &lt;field-list&gt; [AS &lt;new_field_name&gt;] 
</code></pre>
<p>Команда позволяет присоединять релевантные поля из существующей таблицы в
результаты запроса при совпадении значений целевого поля или полей
<strong>field-list</strong> со значением в результатах запроса.</p>
<p>Обязательные параметры:</p>
<ul>
<li>
<p><strong>lookup-file</strong> – имя файла таблицы, сохраненное в файловой системе, в
    директории ../lookups.</p>
</li>
<li>
<p><strong>field-list</strong> – поле или список полей (через запятую), по которым
    осуществляется связка таблицы с результатами запроса.</p>
</li>
</ul>
<p>Опциональный параметр:</p>
<ul>
<li><strong>AS</strong> &lt;<strong>new_field_name</strong>> – имя, используемое для переименования поля в
    существующей таблице, если целевое поле с ним не совпадает.</li>
</ul>
<h3 id="_79">Примеры использования</h3>
<p>Исходные данные:</p>
<p>Имеем существующую таблицу <em>students.csv</em>:</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Familyname</strong></th>
<th><strong>age</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>John</td>
<td>Snow</td>
<td>10</td>
</tr>
<tr>
<td>John</td>
<td>Smith</td>
<td>7</td>
</tr>
<tr>
<td>Anna</td>
<td>Show</td>
<td>21</td>
</tr>
</tbody>
</table>
<p>И результаты запроса, в которых поле с фамилиями указано как <em>Surname</em>:</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Surname</strong></th>
<th><strong>Town</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>John</td>
<td>Snow</td>
<td>Moscow</td>
</tr>
<tr>
<td>John</td>
<td>Smith</td>
<td>Volgograd</td>
</tr>
<tr>
<td>John</td>
<td>Bond</td>
<td>Perm</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Результаты запроса нам выдают имя и фамилию без возраста. Требуется добавить в
результаты запроса возраст из сохраненной таблицы. Для этого обязательно
указываем связующие столбцы таблицы <em>Name</em> и <em>Familyname</em>, причем <em>Familyname</em>
нужно переименовать в <em>Surname</em>.</p>
<p>Запрос:</p>
<pre><code>| lookup students.csv Name, Familyname as Surname
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Familyname</strong></th>
<th><strong>Town</strong></th>
<th><strong>age</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>John</td>
<td>Snow</td>
<td>Moscow</td>
<td>10</td>
</tr>
<tr>
<td>John</td>
<td>Smith</td>
<td>Volgograd</td>
<td>7</td>
</tr>
<tr>
<td>John</td>
<td>Bond</td>
<td>Perm</td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="_80"></h1>
<h1 id="makemv">MAKEMV</h1>
<p>Команда конвертирует поле, состоящее из одного значения (<em>singlevalue</em>-поле), в
поле, состоящее из нескольких значений (<em>multivalue</em>-поле), разделяя
<em>singlevalue</em>-поле на отдельные части указанным строковым разделителем.</p>
<h3 id="_81">Синтаксис команды</h3>
<pre><code>makemv [delim=&lt;string&gt;] &lt;field&gt;
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>field</strong> – имя <em>singlevalue</em>-поля, которое будет преобразовано в
    <em>multivalue</em>-поле.</li>
</ul>
<p>Опциональный параметр:</p>
<ul>
<li>
<p><strong>delim=&lt;string></strong> – строка, которая будет использована в качестве
    разделителя при преобразовании в <em>multivalue</em>-поле.</p>
<p>Значение по умолчанию: <em>пробел (" ")</em>.</p>
</li>
</ul>
<h3 id="_82">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>dest_country</strong></th>
<th><strong>sender</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RUS</td>
<td>John OR Mary</td>
<td>20</td>
</tr>
<tr>
<td>USA</td>
<td>John OR Mary</td>
<td>10</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Преобразует <em>singlevalue</em>-поле <em>sender</em>, в <em>multivalue</em>-поле c таким же именем.
В качестве строки-разделителя используется "OR".</p>
<p>Запрос:</p>
<pre><code>...| makemv  sender delim=&quot;OR&quot;
</code></pre>
<p>Результат выполнения:</p>
<table>
<thead>
<tr>
<th><strong>dest_country</strong></th>
<th><strong>sender</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RUS</td>
<td>John Mary</td>
<td>20</td>
</tr>
<tr>
<td>USA</td>
<td>John Mary</td>
<td>10</td>
</tr>
</tbody>
</table>
<h1 id="_83"></h1>
<h1 id="makeresults">MAKERESULTS</h1>
<p>Команда создает (генерирует) требуемое количество результатов поиска. Если не
указывать опциональные параметры, то команда генерирует только один результат с
единственным полем <em>_time</em>.</p>
<p><strong>Важно!</strong></p>
<p><em>Эту команду не рекомендуется применять при поиске по датам и времени. Для
получения корректного результата поиска по датам и времени пользуйтесь
командами</em> <a href="#otstats"><strong>otstats</strong></a> <em>и</em> <a href="#search-filter"><strong>search</strong></a><em>.</em></p>
<h3 id="_84">Синтаксис команды</h3>
<pre><code>makeresults [count=&lt;num&gt;] [annotate=&lt;bool&gt;]
</code></pre>
<p>Обязательные параметры: отсутствуют.</p>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>count=&lt;num></strong> – количество результатов, которые должны быть
    сгенерированы. Значение по умолчанию: <em>1</em>.</p>
<p>Если <strong>count</strong> не указан, то команда генерирует только один результат с
единственным полем <em>_time</em>.</p>
</li>
<li>
<p><strong>annotate=&lt;bool></strong>:</p>
<ul>
<li>
<p>если <strong>annotate</strong>=<em>true</em>, то дополнительно будут сгенерированы
    результаты с полями, указанными в таблице ниже;</p>
</li>
<li>
<p>если <strong>annotate</strong>=<em>false</em>, то сгенерированные результаты будут содержать
    только поле <em>_time</em>. Значение по умолчанию: <em>false</em>.</p>
</li>
</ul>
</li>
</ul>
<p>Поля, генерируемые при указании <strong>annotate</strong>=<em>true</em>:</p>
<table>
<thead>
<tr>
<th><strong>Поле</strong></th>
<th><strong>Значение</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><em>_raw</em></td>
<td>Нет значения (NULL)</td>
</tr>
<tr>
<td><em>_time</em></td>
<td>Дата и время выполнения команды <strong>makeresults</strong></td>
</tr>
<tr>
<td><em>host</em></td>
<td>Нет значения (NULL)</td>
</tr>
<tr>
<td><em>source</em></td>
<td>Нет значения (NULL)</td>
</tr>
<tr>
<td><em>sourcetype</em></td>
<td>Нет значения (NULL)</td>
</tr>
</tbody>
</table>
<h3 id="_85">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Генерирует 3 результата. Дополняет результат полем <em>dest_country</em> со значением
"Russia".</p>
<p>Запрос:</p>
<pre><code>| makeresults count=3 
| eval dest_country=&quot;Russia&quot;
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>_time</strong></th>
<th><strong>dest_country</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1588755573</td>
<td>Russia</td>
</tr>
<tr>
<td>1588755573</td>
<td>Russia</td>
</tr>
<tr>
<td>1588755573</td>
<td>Russia</td>
</tr>
</tbody>
</table>
<h1 id="_86"></h1>
<h1 id="mvcombine">MVCOMBINE</h1>
<p>Команда берет группу событий, которые отличаются только одним полем, содержащим
определенное значение, и комбинирует их в одно событие. Значение в этом поле
становится массивом значений из скомбинированных по этому полю значений.</p>
<h3 id="_87">Синтаксис команды</h3>
<pre><code>mvcombine &lt;field&gt;
</code></pre>
<p>Команда <strong>mvcombine</strong> принимает на вход события и находит группы событий, где
все поля одинаковы в отличие от указанного после команды поля. Полученные
значения этого поля объединяются в массив и становятся новым значением этого
поля. Так как события могут содержать много разных полей (особенно часто
различающиеся поля <em>_time</em> и <em>_raw</em>), то имеет смысл предварительно отобрать
нужные поля с помощью команды <a href="#fields-table"><strong>fields</strong></a>.</p>
<p>Обязательный параметр:</p>
<ul>
<li><strong>field</strong> – имя поля, значения которого будут комбинироваться.</li>
</ul>
<h3 id="_88">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>host</strong></th>
<th><strong>ping</strong></th>
<th><strong>latency</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>www1</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>www2</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>finance_dep</td>
<td>11</td>
<td>1</td>
</tr>
<tr>
<td>it_dep</td>
<td>11</td>
<td>2</td>
</tr>
<tr>
<td>www3</td>
<td>10</td>
<td>1</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Комбинирует значения поля <em>host</em> там, где поля <em>latency</em> и <em>ping</em> содержат
одинаковые значения (то есть 1 и 10).</p>
<p>Запрос:</p>
<pre><code>... | mvcombine host
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>host</strong></th>
<th><strong>ping</strong></th>
<th><strong>latency</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>www1 www2 www3</td>
<td>10</td>
<td>1</td>
</tr>
<tr>
<td>finance_dep</td>
<td>11</td>
<td>1</td>
</tr>
<tr>
<td>it_dep</td>
<td>11</td>
<td>2</td>
</tr>
</tbody>
</table>
<h1 id="_89"></h1>
<h1 id="mvexpand">MVEXPAND</h1>
<p>Команда разворачивает значения многозначного поля в отдельные события. Для
каждого результата команда создаёт новое событие.</p>
<h3 id="_90">Синтаксис команды</h3>
<pre><code>mvexpand &lt;field&gt; [limit=&lt;int&gt;]
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>field</strong> – имя многозначного поля.</li>
</ul>
<p>Опциональный параметр:</p>
<ul>
<li><strong>limit=</strong>&lt;<strong>int</strong>> – количество значений в многозначном поле <strong>field</strong>,
    которое будет использоваться для каждого входного события.</li>
</ul>
<h3 id="_91">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>В этом примере показано, как развернуть событие с многозначным полем в отдельные
события для каждого значения поля.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>Date</strong></th>
<th><strong>fields</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>27.04.2020</td>
<td>33,55 17,18 34,54</td>
</tr>
<tr>
<td>28.04.2020</td>
<td>3,5 34,34 67,9</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... 
| mvexpand fields 
| rex field=fields &quot;(?&lt;alpha&gt;\d+),(?&lt;beta&gt;\d+)&quot; 
| table _time alpha beta 
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Date</strong></th>
<th><strong>alpha</strong></th>
<th><strong>beta</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>27.04.2020</td>
<td>33</td>
<td>55</td>
</tr>
<tr>
<td>27.04.2020</td>
<td>17</td>
<td>18</td>
</tr>
<tr>
<td>27.04.2020</td>
<td>34</td>
<td>54</td>
</tr>
<tr>
<td>28.04.2020</td>
<td>3</td>
<td>5</td>
</tr>
<tr>
<td>28.04.2020</td>
<td>34</td>
<td>34</td>
</tr>
<tr>
<td>28.04.2020</td>
<td>67</td>
<td>9</td>
</tr>
</tbody>
</table>
<h1 id="_92"></h1>
<h1 id="nomv">NOMV</h1>
<p>Команда конвертирует значения <em>multivalue</em>-поля в <em>singlevalue</em>-поле.</p>
<h3 id="_93">Синтаксис команды</h3>
<pre><code>nomv &lt;field&gt;
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>field</strong> – имя <em>multivalue</em>-поля, которое необходимо конвертировать в
    <em>singlevalue</em>-поле</li>
</ul>
<h3 id="_94">Примеры использования</h3>
<p>Исходные данные:</p>
<p>Поле <em>dest</em> является <em>multivalue</em>-полем.</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia France</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Italy USA</td>
<td>7</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Создает <em>singlevalue</em>-поле <em>dest</em> из <em>multivalue</em>-поля <em>dest</em>. Поле <em>dest</em>
становится обычной строкой.</p>
<p>Запрос:</p>
<pre><code>... | nomv dest
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia France</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Italy USA</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Теперь с полем <em>dest</em> можно проводить строковые операции, как с обычной строкой:</p>
<pre><code>... | nomv dest | eval dest=dest+&quot;Spain&quot;
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia France Spain</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Italy USA Spain</td>
<td>7</td>
</tr>
</tbody>
</table>
<h1 id="_95"></h1>
<h1 id="otloadjob">OTLOADJOB</h1>
<p>Команда извлекает из кеша результаты ранее выполненного запроса. Извлечение
результата из кеша предполагает, что запрос не выполняется заново, а
запрашиваются только его результаты.</p>
<h3 id="_96">Синтаксис команды</h3>
<pre><code>otloadjob &lt;spl-query&gt;
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li>
<p><strong>spl-query</strong> – поисковый запрос, результаты которого требуется извлечь из
    кеша. Успешное выполнение команды <strong>otloadjob</strong> возможно только при наличии
    двух условий:</p>
<ul>
<li>
<p>Запрос, результат которого требуется получить, должен быть выполнен.</p>
</li>
<li>
<p>Время хранения результата выполненного запроса не истекло.</p>
<p>Если хотя бы одно из условий отсутствует, запрос, указанный в параметре
<strong>spl-query</strong>, будет выполнен повторно.</p>
<p>Spl-запрос задается как строка. При этом, если внутри запроса
встречаются кавычки, то они должны быть заэкранированы символом обратный
слеш ("\").</p>
<p>Синтаксис: <em>spl="spl-запрос"</em>.</p>
</li>
</ul>
</li>
</ul>
<h3 id="_97">Примеры использования</h3>
<p>Исходные данные:</p>
<p>Выполнен запрос:</p>
<pre><code>index=&quot;apache&quot; 
| stats count as num
</code></pre>
<p>Получен результат:</p>
<table>
<thead>
<tr>
<th><strong>num</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>46</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>После выполнения запроса, указанного в исходных данных, выполнен следующий
запрос:</p>
<pre><code>| otloadjob spl=&quot;index=\&quot;apache\&quot; 
| stats count as num&quot;
</code></pre>
<p>Запрос выполнен до истечения времени хранения результата запроса, указанного в
исходных данных.</p>
<p>Следовательно, в качестве результата будет возвращён результат запроса,
указанного в исходных данных:</p>
<table>
<thead>
<tr>
<th><strong>num</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>46</td>
</tr>
</tbody>
</table>
<h1 id="_98"></h1>
<h1 id="otstats">OTSTATS</h1>
<p>Команда используется для получения из индекса данных с извлеченными во время
индексации полями. Вы можете получить события из индексов, указывая необходимые
поля и используя логические выражения. Также для получения более широкого поля
результатов можно использовать wildcard (*).</p>
<p>Команда <strong>otstats</strong> также может быть использована в подзапросе. После того как
данные получены из индекса, к ним можно применять различные команды
трансформации, фильтрации и т.д. Отличие от команды <a href="#search-filter"><strong>search</strong></a>
(которая читает и выводит только поля <em>_time</em> и <em>_raw</em>) заключается в том, что
<strong>otstats</strong> читает из файловой системы уже проиндексированные поля, что ускоряет
работу поиска, так как нет необходимости проводить дополнительный парсинг во
время поискового запроса.</p>
<h3 id="_99">Синтаксис команды</h3>
<pre><code>otstats index=&lt;index-name&gt; [&lt;logical-expression&gt;] [&lt;time&gt;] 
</code></pre>
<p>Для поиска по нескольким индексам и значениям полей можно использовать
логические выражения (<em>OR</em>, <em>AND</em>). При чередовании через пробел нескольких
индексов или полей к ним применяется логический оператор <em>OR</em>. Стоит отметить,
что необходимо учитывать тип данных того поля, по которому производится поиск,
так как к строковым значениям нельзя применить операции сравнения (<em>&lt;</em>, >,
<em>>=</em>, &lt;=, <em>!=</em>). Знак вертикальной черты "|" перед командой не обязателен,
так как она идет первой в запросе или подзапросе.</p>
<p>Обязательный параметр:</p>
<ul>
<li><strong>index=&lt;index-name></strong> – имя индекса, из которого будут читаться данные.
    Имя индекса необходимо заключать в двойные кавычки.</li>
</ul>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>logical-expression</strong> – логическое выражение. Выражение может содержать два
    и более вариантов поиска, соединенных логическими операторами, такими как
    <em>OR</em> или <em>AND</em>. Поиск по определенным значениям осуществляется с помощью
    знака равно "=" или "!=". Может быть использован также оператор регулярных
    выражений <em>wildcard</em> (в конце строки) и знаки сравнения (&lt;, >, >=, &lt;=,
    !=) для числовых значений.</p>
</li>
<li>
<p><strong>time</strong> – в подзапросах (или основном запросе) могут использоваться
    дополнительные опции времени (<em>latest=</em> и <em>earliest=</em>) для поиска по другому
    временному интервалу. Временные рамки указываются в формате Epoch time
    (Linux time).</p>
</li>
</ul>
<h3 id="_100">Примеры использования</h3>
<p>Исходные данные:</p>
<p>Имеются два индекса с логами данных linux-log и nginx-log с полями <em>_time</em>,
<em>_raw</em>, <em>severity</em>, <em>message</em>.</p>
<p><strong>Пример 1</strong></p>
<p>Выводим данные из индекса linux-log, где поле <em>severity</em> указывает на
возникновение ошибки:</p>
<pre><code>| otstats index=&quot;linux-log&quot; severity=&quot;ERR*&quot;
</code></pre>
<p><strong>Пример 2</strong></p>
<p>Выводим данные из индекса linux-log и nginx-log, где поле <em>severity</em> указывает
на возникновение ошибки и на критическое событие:</p>
<pre><code>| otstats index=&quot;linux-log&quot; index=&quot;nginx-log&quot; severity=&quot;ERR*&quot; OR severity=&quot;CRITICAL&quot;
</code></pre>
<p><strong>Пример 3</strong></p>
<p>Выводим данные из индекса linux-log и прибавляем к ним данные из подзапроса,
указывая другой временной интервал:</p>
<pre><code>| otstats index=&quot;linux-log&quot; severity=&quot;ERR*&quot; 
| append [otstats index=&quot;nginx-log&quot; earliest=1577836799 latest=1577858400]
</code></pre>
<h1 id="_101"></h1>
<h1 id="outputlookup">OUTPUTLOOKUP</h1>
<p>Команда сохраняет результаты запроса в статическую таблицу (lookup).</p>
<h3 id="_102">Синтаксис команды</h3>
<pre><code>outputlookup &lt;filename&gt; [append=&lt;bool&gt;]
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>filename</strong> – имя lookup-файла.</li>
</ul>
<p>Опциональный параметр:</p>
<ul>
<li>
<p><strong>append=&lt;bool></strong>:</p>
<ul>
<li>
<p>если <strong>append</strong>=<em>false</em> (по умолчанию), то команда <strong>outputlookup</strong>
    перезаписывает данные в существующем lookup-файле;</p>
</li>
<li>
<p>если <strong>append</strong>=<em>true</em>, то <strong>outputlookup</strong> пытается добавить результаты
    запроса в существующий файл.</p>
</li>
</ul>
</li>
</ul>
<h3 id="_103">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Фильтрует список транзакций и сохраняет результаты запроса в lookup-файл.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... 
| where currency=&quot;EUR&quot; 
| outputlookup transactions_eur.csv
</code></pre>
<p>Результат, записанный в lookup-файл:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<h1 id="_104"></h1>
<h1 id="rangemap">RANGEMAP</h1>
<p>Команда разбивает значения числового поля на категории. Команда добавляет новое
поле с именем <em>range</em> к каждому событию и отображает категорию в этом поле.</p>
<p>Значения в поле <em>range</em> основаны на указанных числовых диапазонах. Если значение
в числовом поле не соответствует какому-либо из указанных диапазонов, поле
<em>range</em> устанавливается в значение по умолчанию.</p>
<h3 id="_105">Синтаксис команды</h3>
<pre><code>rangemap field=&lt;string&gt; (&lt;attribute_name&gt;=&lt;numeric_range&gt;)... [default=&lt;string&gt;]
</code></pre>
<p>Обязательные параметры:</p>
<ul>
<li>
<p><strong>field=&lt;string></strong> – имя категоризируемого поля, содержащего числовые
    значения.</p>
</li>
<li>
<p>&lt;<strong>attribute_name</strong>><strong>=</strong>&lt;<strong>numeric_range</strong>>:</p>
<ul>
<li>
<p><strong>attribute_name</strong> – строка, выводимая в поле <em>range</em>, когда значение в
    <strong>field</strong> попадает в диапазон значений из <strong>numeric_range</strong>.</p>
</li>
<li>
<p><strong>numeric_range</strong> – начальное и конечное значения диапазона, заданные
    через слеш (-).</p>
<p>Значения могут быть целыми числами или числами с плавающей запятой.
Первое значение должно быть меньше, чем второе.</p>
</li>
</ul>
</li>
</ul>
<p>Опциональный параметр:</p>
<ul>
<li><strong>default=&lt;string></strong> – значение по умолчанию, которое выводится в случае,
    если категоризируемое поле не соответствует какому-либо из указанных
    диапазонов. По умолчанию значение – "None".</li>
</ul>
<h3 id="_106">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Разбивает на категории события на основании значения поля суммы транзакции
(<em>sum</em>).</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... | rangemap field=sum min=1-5 med=6-15 max=16-30
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
<th><strong>range</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
<td>med</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
<td>med</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
<td>max</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
<td>min</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
<td>max</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
<td>med</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Установите значение поля <em>range</em> в "зеленый", если <em>date_second</em> находится между
1-30, "жёлтый", если между 31-39, "красный", если между 40-59 и "серый", если
диапазон не совпадает (например, если <em>date_second</em> = 0).</p>
<p>Запрос:</p>
<pre><code>... | rangemap field=date_second green=1-30 yellow=31-39 red=40-59 default=gray
</code></pre>
<h1 id="_107"></h1>
<h1 id="rare">RARE</h1>
<p>Команда находит наименее распространённые значения в выбранных полях.</p>
<h3 id="_108">Синтаксис команды</h3>
<pre><code>| rare [&lt;limit&gt;] &lt;field-list&gt; [&lt;by-clause&gt;]
</code></pre>
<p>Команда вычисляет количество и процентное соотношение того, насколько редко
выбранные значения встречаются в событиях. Если добавлена опция <em>by-clause</em>, то
результат будет сгруппирован по полю, указанному после <em>by</em>.</p>
<p>Обязательный параметр:</p>
<ul>
<li><strong>field-list</strong> – поле или список полей (через запятую или пробел), по
    которым проводится подсчёт.</li>
</ul>
<p>Опциональный параметр:</p>
<ul>
<li>
<p><strong>limit</strong> – количество нижних строк, которые должны быть выведены в
    результате. По умолчанию: <em>10</em>.</p>
</li>
<li>
<p><strong>by-clause</strong> – одно или несколько полей, значения которых будут названиями
    столбцов в результирующей таблице.</p>
</li>
</ul>
<h3 id="_109">Пример использования</h3>
<p>Выводит 3 наименее часто встречающихся имени.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Surname</strong></th>
<th><strong>age</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>John</td>
<td>Snow</td>
<td>10</td>
</tr>
<tr>
<td>Alex</td>
<td>Smith</td>
<td>7</td>
</tr>
<tr>
<td>Anna</td>
<td>Show</td>
<td>21</td>
</tr>
<tr>
<td>John</td>
<td>Bond</td>
<td>3</td>
</tr>
<tr>
<td>John</td>
<td>Smith</td>
<td>19</td>
</tr>
<tr>
<td>Tony</td>
<td>Stark</td>
<td>5</td>
</tr>
<tr>
<td>John</td>
<td>Dow</td>
<td>19</td>
</tr>
<tr>
<td>Tony</td>
<td>Pitt</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... | rare 2 Name
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>count</strong></th>
<th><strong>percent</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Anna</td>
<td>1</td>
<td>12,5</td>
</tr>
<tr>
<td>Tony</td>
<td>2</td>
<td>25</td>
</tr>
</tbody>
</table>
<h1 id="_110"></h1>
<h1 id="rename">RENAME</h1>
<p>Команда переименовывает одно или несколько полей. Для переименования полей с
похожими именами можно использовать подстановочный знак (*).</p>
<h3 id="_111">Синтаксис команды</h3>
<pre><code>rename &lt;wc-field&gt; AS &lt;wc-field&gt;...
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>&lt;wc-field> AS &lt;wc-field></strong> – название поля и через оператор <em>AS</em> имя
    для его замены. В именах полей можно использовать подстановочные знаки.
    Имена с пробелами должны быть заключены в кавычки.</li>
</ul>
<h3 id="_112">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Переименовывает поле <em>dest</em> в поле <em>destination country</em>.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... | rename dest as &quot;destination country&quot;
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>destination country</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Переименовывает несколько полей с похожими именами, используя подстановочный
знак (*).</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>Date</strong></th>
<th><strong>TerminalA</strong></th>
<th><strong>TerminalB</strong></th>
<th><strong>TerminalC</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>27.03.2019</td>
<td>235</td>
<td>178</td>
<td>79</td>
</tr>
<tr>
<td>28.03.2019</td>
<td>116</td>
<td>265</td>
<td>64</td>
</tr>
<tr>
<td>29.03.2019</td>
<td>223</td>
<td>98</td>
<td>187</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... | rename Terminal* as &quot;Terminal *&quot;
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Date</strong></th>
<th><strong>Terminal A</strong></th>
<th><strong>Terminal B</strong></th>
<th><strong>Terminal C</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>27.03.2019</td>
<td>235</td>
<td>178</td>
<td>79</td>
</tr>
<tr>
<td>28.03.2019</td>
<td>116</td>
<td>265</td>
<td>64</td>
</tr>
<tr>
<td>29.03.2019</td>
<td>223</td>
<td>98</td>
<td>187</td>
</tr>
</tbody>
</table>
<h1 id="_113"></h1>
<h1 id="replace">REPLACE</h1>
<p>Команда заменяет значение поля указанным значением. Заменяет единственное
вхождение первой строки другой строкой в указанном поле.</p>
<h3 id="_114">Синтаксис команды</h3>
<pre><code>replace (&lt;wc-string&gt; WITH &lt;wc-string&gt;)[IN &lt;field&gt;]
</code></pre>
<p>Обязательные параметры:</p>
<ul>
<li>
<p><strong>&lt;wc-string> WITH &lt;wc-string></strong> – значение поля и значение для его
    замены, разделённые оператором <em>WITH</em>. Можно использовать символы
    подстановки для соответствия одному или нескольким значениям.</p>
</li>
<li>
<p><strong>IN &lt;field></strong> – имя поля, в котором происходит замена значения. Чтобы
    заменить значения в поле <strong>field</strong>, необходимо указать имя поля с оператором
    <em>IN</em>.</p>
</li>
</ul>
<h3 id="_115">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Заменяет сокращённое название валют на полное.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... 
| replace EUR with Euro in currency 
| replace RUB with Ruble in currency 
| replace USD with Dollar in currency 
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>Ruble</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>Dollar</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>Euro</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>Euro</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>Ruble</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>Euro</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<h1 id="_116"></h1>
<h1 id="return">RETURN</h1>
<p>Команда используется в подзапросах, чтобы подставить в исходный запрос значение
из определенной колонки полученного набора данных. Если при вычислении
подзапроса будет получено более одной записи, то команда вернёт только первое
значение из указанной колонки.</p>
<p>Команда возвращает значение из подзапроса в виде строки (не датафрейма). Это
позволяет использовать команду в подзапросах для генерации сложных выражений,
которые далее в основном запросе могут быть вычислены командой <strong>eval</strong> (команда
<strong>eval</strong> принимает строковое выражение для вычисления поля).</p>
<h3 id="_117">Синтаксис команды</h3>
<pre><code>return $&lt;column_name&gt;
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>$&lt;column_name></strong> – колонка, значения которой вернутся из подзапроса.</li>
</ul>
<p>Опциональные параметры отсутствуют.</p>
<h3 id="_118">Пример использования</h3>
<p>Исходные данные:</p>
<p>Набор представляет результаты измерений температуры на скважинах нескольких
месторождений. На одно месторождение может приходиться несколько скважин.</p>
<table>
<thead>
<tr>
<th><strong>_time</strong></th>
<th><strong>deposit</strong></th>
<th><strong>well</strong></th>
<th><strong>metric_name</strong></th>
<th><strong>value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>16744164</td>
<td>deposit_1</td>
<td>well_1</td>
<td>temperature</td>
<td>27</td>
</tr>
<tr>
<td>16744164</td>
<td>deposit_1</td>
<td>well_2</td>
<td>temperature</td>
<td>24</td>
</tr>
<tr>
<td>16744164</td>
<td>deposit_2</td>
<td>well_1</td>
<td>temperature</td>
<td>27</td>
</tr>
<tr>
<td>16744164</td>
<td>deposit_2</td>
<td>well_2</td>
<td>temperature</td>
<td>25</td>
</tr>
<tr>
<td>16744164</td>
<td>deposit_3</td>
<td>well_1</td>
<td>temperature</td>
<td>27</td>
</tr>
<tr>
<td>16744164</td>
<td>deposit_3</td>
<td>well_1</td>
<td>temperature</td>
<td>26</td>
</tr>
<tr>
<td>16744364</td>
<td>deposit_1</td>
<td>well_1</td>
<td>temperature</td>
<td>26</td>
</tr>
<tr>
<td>16744364</td>
<td>deposit_2</td>
<td>well_2</td>
<td>temperature</td>
<td>25</td>
</tr>
<tr>
<td>16744364</td>
<td>deposit_3</td>
<td>well_2</td>
<td>temperature</td>
<td>27</td>
</tr>
<tr>
<td>16744364</td>
<td>deposit_3</td>
<td>well_2</td>
<td>temperature</td>
<td>22</td>
</tr>
</tbody>
</table>
<p>Используем команду для возврата значения из подзапроса. Добавим к исходному
набору данных новое поле логического типа, которое будет принимать значение
<em>true</em>, если температура отклонилась от средней величины (по всем скважинам всех
месторождений) более чем на 5%. При этом для вычисления средней температуры
воспользуемся подзапросом.</p>
<p>В подзапросе для перечитывания исходного набора используется команда
<strong>inputlookup</strong> (исходный набор представлен в виде <em>csv</em>-файла).</p>
<p>... | eval alarm=abs(value / [| inputlookup test.csv | eventstats avg(value)
as avgTemp | return avgTemp] - 1) > 0.05</p>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>_time</strong></th>
<th><strong>deposit</strong></th>
<th><strong>well</strong></th>
<th><strong>metric_name</strong></th>
<th><strong>value</strong></th>
<th><strong>alarm</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1641744164</td>
<td>deposit_1</td>
<td>well_1</td>
<td>temperature</td>
<td>27</td>
<td>true</td>
</tr>
<tr>
<td>1641744164</td>
<td>deposit_1</td>
<td>well_2</td>
<td>temperature</td>
<td>24</td>
<td>true</td>
</tr>
<tr>
<td>1641744164</td>
<td>deposit_2</td>
<td>well_1</td>
<td>temperature</td>
<td>27</td>
<td>true</td>
</tr>
<tr>
<td>1641744164</td>
<td>deposit_2</td>
<td>well_2</td>
<td>temperature</td>
<td>25</td>
<td>false</td>
</tr>
<tr>
<td>1641744164</td>
<td>deposit_3</td>
<td>well_1</td>
<td>temperature</td>
<td>27</td>
<td>true</td>
</tr>
<tr>
<td>1641744164</td>
<td>deposit_3</td>
<td>well_1</td>
<td>temperature</td>
<td>26</td>
<td>false</td>
</tr>
<tr>
<td>1641744364</td>
<td>deposit_1</td>
<td>well_1</td>
<td>temperature</td>
<td>26</td>
<td>false</td>
</tr>
<tr>
<td>1641744364</td>
<td>deposit_2</td>
<td>well_2</td>
<td>temperature</td>
<td>25</td>
<td>false</td>
</tr>
<tr>
<td>1641744364</td>
<td>deposit_3</td>
<td>well_2</td>
<td>temperature</td>
<td>27</td>
<td>true</td>
</tr>
<tr>
<td>1641744364</td>
<td>deposit_3</td>
<td>well_2</td>
<td>temperature</td>
<td>22</td>
<td>true</td>
</tr>
</tbody>
</table>
<h1 id="_119"></h1>
<h1 id="reverse">REVERSE</h1>
<p>Команда инвертирует порядок результатов.</p>
<p><strong>Важно!<br />
</strong><em>Порядок, в котором события будут поступать на обработку в команду</em>
<strong>reverse,</strong> <em>определяется результатом выполнения предыдущих команд. В случае
необходимости сохранения одинакового порядка событий для разных запусков
запроса, необходимо предусмотреть сортировку событий до их передачи на вход
команды</em> <strong>reverse</strong><em>. Для этого можно использовать, например, команду</em>
<a href="#sort"><strong>sort</strong></a><em>.</em></p>
<h3 id="_120">Синтаксис команды</h3>
<pre><code>reverse
</code></pre>
<h3 id="_121">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>USA</td>
<td>20</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Инвертирует порядок строк в таблице.</p>
<p>Запрос:</p>
<pre><code>... | reverse
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>USA</td>
<td>20</td>
</tr>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
</tbody>
</table>
<h1 id="_122"></h1>
<h1 id="rex">REX</h1>
<p>Команда позволяет находить совпадения в значениях полей согласно регулярным
выражениям.</p>
<h3 id="_123">Синтаксис команды</h3>
<pre><code>rex (field=&lt;field&gt; &lt;regex-expression&gt; [max_match=&lt;int&gt;])
</code></pre>
<p>Команда позволяет выделять поля, используя именованные группы регулярных
выражений.</p>
<p>Команда <strong>rex</strong> находит совпадения в строках указанного поля, согласно
регулярному выражению, и выделяет его в отдельное поле с соответствующим именем
(указанным в качестве группы именования регулярного выражения – ?&lt;groupname>).</p>
<p>Запуск команды <strong>rex</strong> по отношению к полю <em>_raw</em> может сильно влиять на
производительность.</p>
<p>Обязательные параметры:</p>
<ul>
<li>
<p><strong>field=&lt;field></strong> – поле, по которому осуществляется поиск.</p>
</li>
<li>
<p><strong>regex-expression</strong> -– регулярное выражение, согласно которому производится
    поиск совпадений.</p>
</li>
</ul>
<p>Опциональный параметр:</p>
<ul>
<li>
<p><strong>max_match=&lt;int></strong> – определяет максимальное количество совпадений,
    которые должны быть найдены в поле. По умолчанию: <em>1</em> (первое совпадение).  </p>
<p>Если поле содержит multivalue-список, то совпадения будут определяться по
каждому элементу списка в отдельности.</p>
</li>
</ul>
<h3 id="_124">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>time</strong></th>
<th><strong>phrase</strong></th>
<th><strong>mvword</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2020</td>
<td>world is never be the same</td>
<td>step stone moon</td>
</tr>
<tr>
<td>2021</td>
<td>be quick or be dad</td>
<td>rapid quick fast</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Создает новое multivalue поле <em>first_word</em>, которое содержит первое слово в
фразе.</p>
<p>Запрос:</p>
<pre><code>... | rex field=phrase &quot;(?&lt;first_word&gt;^\w+).&quot;
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>time</strong></th>
<th><strong>phrase</strong></th>
<th><strong>mvword</strong></th>
<th><strong>first_word</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2020</td>
<td>world is never be the same</td>
<td>step stone moon</td>
<td>world</td>
</tr>
<tr>
<td>2021</td>
<td>be quick or be dad</td>
<td>rapid quick fast</td>
<td>be</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Создает новое поле, которое содержит последнюю букву каждого слова из
multivalue-значений поля <em>mvword</em>.</p>
<p>Запрос:</p>
<pre><code>... | rex field=mvword &quot;(^\w+)(?&lt;last_letter&gt;\w$)&quot;
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>time</strong></th>
<th><strong>phrase</strong></th>
<th><strong>mvword</strong></th>
<th><strong>last_letter</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2020</td>
<td>world is never be the same</td>
<td>step stone moon</td>
<td>p e n</td>
</tr>
<tr>
<td>2021</td>
<td>be quick or be dad</td>
<td>rapid quick fast</td>
<td>d k t</td>
</tr>
</tbody>
</table>
<p><strong>Пример 3</strong></p>
<p>Создает новое поле, которое объединяет до трех совпадений буквы "e" в поле
<em>phrase</em>.</p>
<p>Запрос:</p>
<pre><code>... | rex field=phrase max_match=3 &quot;(?&lt;e_letter&gt;e)&quot;
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>time</strong></th>
<th><strong>phrase</strong></th>
<th><strong>mvword</strong></th>
<th><strong>e_letter</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2020</td>
<td>world is never be the same</td>
<td>step stone moon</td>
<td>e e e</td>
</tr>
<tr>
<td>2021</td>
<td>be quick or be dad</td>
<td>rapid quick fast</td>
<td>e e</td>
</tr>
</tbody>
</table>
<h1 id="_125"></h1>
<h1 id="search-filter">SEARCH (FILTER)</h1>
<p>Команда используется для получения из индекса необработанных данных.</p>
<p>Также команду можно применить для осуществления поиска по результатам запроса. В
этом случае можно фильтровать события, указывая необходимые поля и используя
ключевые слова или логические выражения. В том числе допустимо использование
wildcard (*) для получения более широкого поля результатов.</p>
<p>Команда <strong>search</strong> также может быть использована в подзапросе. После получения
данных из индекса, к ним можно применять различные команды трансформации,
фильтрации и т.д. Отличие от команды <a href="#otstats"><strong>otstats</strong></a> (которая читает
проиндексированные данные) заключается в том, что <strong>search</strong> читает из файловой
системы только поля <em>_time</em> и <em>_raw</em>, что может привести к необходимости
проводить дополнительный парсинг во время поискового запроса.</p>
<h3 id="_126">Синтаксис команды</h3>
<pre><code>search &lt;logical-expression&gt; [&lt;time&gt;]
</code></pre>
<p>Для поиска по нескольким индексам и значениям полей можно использовать
логические выражения (<em>OR</em>, <em>AND</em>). При чередовании через пробел нескольких
индексов или полей, к ним применяется логический оператор <em>OR</em>. Стоит отметить,
что необходимо учитывать тип данных поля, по которому производится поиск, так
как к строковым значениям нельзя применить операции сравнения (&lt;, >, >=,
&lt;=).</p>
<p>Обязательный параметр:</p>
<ul>
<li>
<p><strong>logical-expression</strong> – логическое выражение.</p>
<p>Выражение может содержать два и более варианта поиска, соединяемых
логическими операторами, такими как <em>OR</em> или <em>AND</em>. Поиск по определенным
значениям осуществляется с помощью знака равно "=" или не равно "!=". Может
быть использован также оператор регулярных выражений <em>wildcard</em> (в конце
строки) и знаки сравнения (&lt;, >, >=, &lt;=, !=) для числовых значений.</p>
<p>В случае, если команда используется в начале запроса для чтения
необработанных данных, то должен быть указан индекс, из которого будет
производиться чтение.</p>
</li>
</ul>
<p>Опциональный параметр:</p>
<ul>
<li><strong>time</strong> – в подзапросах (или основном запросе) могут использоваться
    дополнительные опции времени (<em>latest</em>= и <em>earliest</em>=) для поиска по другому
    временному интервалу. Временные рамки указываются в формате Epoch time
    (Linux time).</li>
</ul>
<h3 id="_127">Примеры использования</h3>
<p>Исходные данные:</p>
<p>Имеются два индекса с логами данных linux-log и nginx-log с полями <em>_time</em>,
<em>_raw</em>.</p>
<p><strong>Пример 1</strong></p>
<p>Выводим данные из индекса linux-log:</p>
<pre><code>... | search index=&quot;linux-log&quot; | ...
</code></pre>
<p><strong>Пример 2</strong></p>
<p>Выводим данные из индекса linux-log и nginx-log:</p>
<pre><code>... | search index=&quot;linux-log&quot; index=&quot;nginx-log&quot; | ...
</code></pre>
<p><strong>Пример 3</strong></p>
<p>Фильтруем данные, полученные в результате запроса. Ищем значение поля <em>ID</em>,
равное 298, и значение результата, равное "DONE":</p>
<pre><code>... | search ID=298 AND RESULT=&quot;DONE&quot;
</code></pre>
<h1 id="_128"></h1>
<h1 id="sort">SORT</h1>
<p>Команда <strong>sort</strong> сортирует результаты по указанному полю. События, в которых
поле сортировки отсутствует, рассматриваются как имеющие <em>наибольшее значение</em>
(в случае сортировки по возрастанию) и как имеющие <em>наименьшее значение</em> (в
случае сортировки по убыванию).</p>
<h3 id="_129">Синтаксис команды</h3>
<pre><code>sort [count=&lt;int&gt;] [- | +]&lt;sort-by-clause&gt;...
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li>
<p><strong>[-|+]&lt;sort-by-clause></strong> – список полей, по которым будет выполнена
    сортировка:</p>
<ul>
<li>
<p>При указании опционального знака минус (-) используется убывающий
    порядок сортировки.</p>
</li>
<li>
<p>При указании опционального знака плюс (+) используется возрастающий
    порядок сортировки.</p>
<p>По умолчанию используется возрастающий порядок сортировки.</p>
<p>При указании нескольких полей для сортировки, поля должны быть разделены
запятыми или пробелами.</p>
<p>Синтаксис : [ - | + ] &lt;sort-field1>, [ - | + ] &lt;sort-field2> …</p>
</li>
</ul>
</li>
</ul>
<p>Опциональный параметр:</p>
<ul>
<li><strong>count=&lt;int></strong> – если первым аргументом команды <strong>sort</strong> является
    <strong>count</strong><em>=&lt;целое число></em>, то результатом сортировки будет только заданное
    <em>число</em> событий, а не отсортированные исходные данные в полном объеме.</li>
</ul>
<h3 id="_130">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Сортирует по убыванию по полю <em>sum</em> и выводит три первых результата.</p>
<pre><code>... | sort count=3 -sum
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Сортирует сначала по полю <em>dest_country</em>, а затем, в пределах набора событий с
одинаковым значением поля <em>dest_country</em>, выполняет сортировку по полю <em>sum</em>.</p>
<pre><code>... | sort dest_country sum
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
</tbody>
</table>
<h1 id="_131"></h1>
<h1 id="spath">SPATH</h1>
<p>Команда <strong>spath</strong> позволяет извлекать информацию из структурированных данных в
формате JSON. Команда сохраняет эту информацию в одном или нескольких полях.</p>
<h3 id="_132">Синтаксис команды</h3>
<pre><code>spath [input=&lt;field&gt;] [output=&lt;field&gt;] path=&lt;datapath&gt;
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li><strong>path=&lt;datapath></strong> – путь к значению, которое необходимо извлечь. Путь
    состоит из одного или нескольких шагов местоположения, разделенных точками.
    Шаг местоположения состоит из имени поля и необязательного индекса,
    заключенного в фигурные скобки. Индекс должен быть целым числом, чтобы
    ссылаться на положение данных в массиве (индексация начинается с нуля).
    Например, 'foo.bar.baz' или 'foo.bar.baz{2}'.</li>
</ul>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>input=&lt;field></strong> – поле для чтения и извлечения значений.</p>
<p>Значение по умолчанию: <em>_raw.</em></p>
</li>
<li>
<p><strong>output=&lt;field></strong> – поле, в которое будет записано извлечённое значение.
    Если параметр не определён, именем поля для извлечённого значения становится
    значение параметра <strong>path</strong>.</p>
</li>
</ul>
<h3 id="_133">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Извлекает из поля в JSON-формате сумму необходимой нам транзакции.</p>
<p>Исходные данные:</p>
<pre><code>{
  &quot;transaction&quot; : {
    &quot;1587045110&quot; : {
      &quot;Russia&quot;: {
        &quot;RUB&quot;: 10
      }
    },
    &quot;1587045120&quot; : {
      &quot;Russia&quot; : {
        &quot;USD&quot;: 7
      }
    },
    &quot;1587045130&quot; : {
      &quot;Germany&quot;: {
        &quot;EUR&quot;: 21
      }
    },
    &quot;1587045140&quot; : {
      &quot;USA&quot;: {
        &quot;EUR&quot;: 3
      }
    } 
  }
}
</code></pre>
<p>Запрос:</p>
<pre><code>... | spath input=_raw output=result path=transaction.1587045130.Germany.EUR
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>result</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>21</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Извлекает из поля в JSON-формате размер необходимой нам транзакции, ссылаясь на
её положение в массиве (индекс).</p>
<p>Исходные данные:</p>
<pre><code>{
  &quot;transaction&quot; : {
    &quot;1587045110&quot; : {
      &quot;Russia&quot; : {
        &quot;RUB&quot; : [144332, 345446, 2342456, 242456, 78856],
        &quot;EUR&quot; : [353, 6556, 7676],
        &quot;USD&quot; : [3535, 7676, 7668]
      },
      &quot;Germany&quot; : {
        &quot;RUB&quot; : [13455],
        &quot;EUR&quot; : [1445, 45656, 1000, 2543, 345336]
      },
      &quot;USA&quot; : {
        &quot;EUR&quot; : [324343, 54664, 66565],
        &quot;USD&quot; : [1000, 4545, 333, 500]
      }
    }
  }
}
</code></pre>
<p>Запрос:</p>
<pre><code>... | spath input=_raw output=result path=transaction.1587045110.Russia.RUB{2}
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>result</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2342456</td>
</tr>
</tbody>
</table>
<h1 id="_134"></h1>
<h1 id="stats">STATS</h1>
<p>Команда считает агрегирующую статистику, такую как среднее, количество, сумма и
т.п., по имеющемуся набору данных. Процесс аналогичен SQL-агрегации. Если
команда <strong>stats</strong> используется без <em>BY</em> группировки, то возвращается только один
ряд, как совокупность всех данных входящего набора. Если применяется группировка
<em>BY</em>, то возвращается один ряд для каждого уникального значения, входящего в
набор, указанный после <em>BY</em>.</p>
<h3 id="_135">Синтаксис команды</h3>
<pre><code>stats &lt;stats-функция&gt;(field) [AS &lt;field&gt;] ... [BY &lt;field-list&gt;]
</code></pre>
<p>Синтаксис команды <strong>stats</strong> зависит от используемой функции (см. таблицу
поддерживаемых функций). При выполнении команды можно использовать одну или
более функций, но может быть использована только одна группировка <em>BY</em>.</p>
<p>Обязательные параметры:</p>
<ul>
<li>
<p><strong>stats-функция</strong> – статистическая функция, которая будет применена к полю.
    Перечень функций представлен в разделе ниже.</p>
</li>
<li>
<p><strong>field</strong> – имя поля, к которому будет применена статистическая функция.</p>
</li>
</ul>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>AS &lt;field></strong> – имя поля, в которое будет записан результат
    статистической функции. По умолчанию, если не указывается <strong>AS &lt;field></strong>,
    то именем поля будет сама применяемая функция.</p>
</li>
<li>
<p><strong>BY &lt;field-list></strong> – группировка по определенному полю или списку полей.</p>
</li>
</ul>
<h4 id="_136">Статистические функции</h4>
<p>Функции позволяют получить различные статистики по полю или eval-выражению, к
которому они применяются.</p>
<p>В таблице представлен перечень функций, сгруппированных по типам:</p>
<table>
<thead>
<tr>
<th><strong>Имя функции</strong></th>
<th><strong>Описание функции</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Агрегирующие функции:</strong></td>
<td></td>
</tr>
<tr>
<td><em>approxdc()</em></td>
<td>Приблизительное количество уникальных значений.</td>
</tr>
<tr>
<td><em>avg()</em></td>
<td>Среднее арифметическое.</td>
</tr>
<tr>
<td><em>count()</em></td>
<td>Количество значений.</td>
</tr>
<tr>
<td><em>distinct_count()</em></td>
<td>Количество уникальных значений.</td>
</tr>
<tr>
<td><em>max()</em></td>
<td>Наибольшее значение.</td>
</tr>
<tr>
<td><em>min()</em></td>
<td>Наименьшее значение.</td>
</tr>
<tr>
<td><em>perc()</em></td>
<td>Процентиль.</td>
</tr>
<tr>
<td><em>percentile_approx()</em></td>
<td></td>
</tr>
<tr>
<td><em>stdev()</em></td>
<td>Стандартное отклонение.</td>
</tr>
<tr>
<td><em>sum()</em></td>
<td>Сумма значений.</td>
</tr>
<tr>
<td><em>var()</em></td>
<td>Дисперсия.</td>
</tr>
<tr>
<td><strong>Порядковые функции:</strong></td>
<td></td>
</tr>
<tr>
<td><em>first()</em></td>
<td>Первое значение в таблице.</td>
</tr>
<tr>
<td><em>last()</em></td>
<td>Последнее значение в таблице.</td>
</tr>
<tr>
<td><strong>Функции для работы с multivalue-полями:</strong></td>
<td></td>
</tr>
<tr>
<td><em>list()</em></td>
<td>Список значений.</td>
</tr>
<tr>
<td><em>values()</em></td>
<td></td>
</tr>
<tr>
<td><strong>Временные функции:</strong></td>
<td></td>
</tr>
<tr>
<td><em>earliest()</em></td>
<td>Первое значение в таблице.</td>
</tr>
<tr>
<td><em>latest()</em></td>
<td>Последнее значение в таблице.</td>
</tr>
</tbody>
</table>
<h3 id="_137">Примеры использования</h3>
<p>Исходные данные:</p>
<p>Имеются таблица студентов разных возрастов.</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Surname</strong></th>
<th><strong>age</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>John</td>
<td>Snow</td>
<td>10</td>
</tr>
<tr>
<td>Alex</td>
<td>Smith</td>
<td>7</td>
</tr>
<tr>
<td>Anna</td>
<td>Show</td>
<td>21</td>
</tr>
<tr>
<td>James</td>
<td>Bond</td>
<td>3</td>
</tr>
<tr>
<td>John</td>
<td>Dow</td>
<td>14</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Считаем средний возраст студента.</p>
<p>Запрос:</p>
<pre><code>... | stats avg(age) as AvgAge
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>AvgAge</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>11</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Выводим количество с группировкой по имени.</p>
<p>Запрос:</p>
<pre><code>... | stats count(Surname) by Name
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>count</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>John</td>
<td>2</td>
</tr>
<tr>
<td>James</td>
<td>1</td>
</tr>
<tr>
<td>Alex</td>
<td>1</td>
</tr>
<tr>
<td>Anna</td>
<td>1</td>
</tr>
</tbody>
</table>
<p><strong>Пример 3</strong></p>
<p>Выводим и средний возраст и количество с агрегацией по имени.</p>
<p>Запрос:</p>
<pre><code>... | stats avg(age) as AvgAge, count(Surname) by Name
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>AvgAge</strong></th>
<th><strong>count</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Anna</td>
<td>21</td>
<td>1</td>
</tr>
<tr>
<td>Alex</td>
<td>7</td>
<td>1</td>
</tr>
<tr>
<td>John</td>
<td>12</td>
<td>2</td>
</tr>
<tr>
<td>James</td>
<td>3</td>
<td>1</td>
</tr>
</tbody>
</table>
<h1 id="_138"></h1>
<h1 id="streamstats">STREAMSTATS</h1>
<p>Команда вычисляет статистику по значениям полей и добавляет поле результата к
каждому событию.</p>
<p>Команда <strong>streamstats</strong> считает статистику от события к событию, формируя каждый
раз новый результат в момент поступления очередного события на обработку. Такая
обработка событий для подсчета статистики называется <em>потоковой</em> или
<em>стриминговой</em>. Другими словами, команда <strong>streamstats</strong> рассчитывает статистику
"по мере просмотра" событий, обновляя результат статистики для каждого
просматриваемого события в момент его поступления на обработку.</p>
<p><strong>Важно!</strong><em><br />
Порядок, в котором события будут поступать на обработку в команду</em>
<strong>streamstats</strong>, <em>определяется результатом выполнения предыдущих команд. Иногда,
при этом, одинаковый порядок событий не может быть гарантирован для разных
запусков запроса. В случае необходимости сохранения одного и того же порядка
событий для разных запусков запроса, необходимо предусмотреть сортировку событий
до их поступления на вход команды</em> <strong>streamstats</strong><em>. Для этого можно
использовать команду</em> <a href="#sort"><strong>sort</strong></a><em>.</em></p>
<h3 id="_139">Синтаксис команды</h3>
<pre><code>streamstats [window=&lt;int&gt;] [time_window=&lt;span-length&gt;] &lt;stats-agg-term&gt;... [BY &lt;field-list&gt;]
</code></pre>
<p>Обязательный параметр:</p>
<ul>
<li>
<p><strong>stats-agg-term</strong> – статистические функции, применяемые к полям и
    eval-выражениям. Результат выполнения функции может быть помещён в отдельное
    поле с именем, указанным после операнда <em>AS</em>.</p>
<p>Синтаксис: <br />
<em>&lt;stats-func> ( &lt;evaled-field> | &lt;field> ) [AS &lt;newfield>]</em></p>
<p>Перечень функций представлен в разделе ниже.</p>
</li>
</ul>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>BY &lt;field-list></strong> – одно или несколько полей, по которым будет
    производиться группировка вычисляемой статистики.</p>
</li>
<li>
<p><strong>time_window=&lt;span-length></strong> – временное окно для выполнения "потоковых
    вычислений". Статистика, определенная аргументом <strong>stats-agg-term</strong>,
    считается для событий, которые попадают во временное окно, заданное
    аргументом <strong>time_window</strong>. Аргумент <strong>time_window</strong> ограничен диапазоном
    значения поля _<em>time</em> для обрабатываемых событий. Для использования
    аргумента <strong>time_window</strong> события должны быть отсортированы в убывающем или
    возрастающем порядке по полю _<em>time</em>. Аргумент <strong>time_window</strong> может
    использоваться вместе с аргументом <strong>window</strong>.</p>
<p>Синтаксис: <strong>time_window=&lt;span-length></strong>, где <em>&lt;span-length></em> – диапазон
времени в секундах.</p>
</li>
<li>
<p><strong>window=&lt;int></strong> – количество событий, в пределах которого происходит
    подсчет статистики. Если <strong>window</strong> равно нулю, то расчет статистики будет
    выполнен только для одного события – того, которое обрабатывается в данный
    момент.</p>
</li>
</ul>
<h4 id="_140">Статистические функции</h4>
<p>Функции позволяют получить различные статистики по полю или eval-выражению, к
которому они применяются.</p>
<p>В таблице представлен перечень функций, сгруппированных по типам:</p>
<table>
<thead>
<tr>
<th><strong>Имя функции</strong></th>
<th><strong>Описание функции</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Агрегирующие функции:</strong></td>
<td></td>
</tr>
<tr>
<td><em>approxdc()</em></td>
<td>Приблизительное количество уникальных значений.</td>
</tr>
<tr>
<td><em>avg()</em></td>
<td>Среднее арифметическое.</td>
</tr>
<tr>
<td><em>count()</em></td>
<td>Количество значений.</td>
</tr>
<tr>
<td><em>distinct_count()</em></td>
<td>Количество уникальных значений.</td>
</tr>
<tr>
<td><em>max()</em></td>
<td>Наибольшее значение.</td>
</tr>
<tr>
<td><em>min()</em></td>
<td>Наименьшее значение.</td>
</tr>
<tr>
<td><em>perc()</em></td>
<td>Процентиль.</td>
</tr>
<tr>
<td><em>percentile_approx()</em></td>
<td></td>
</tr>
<tr>
<td><em>stdev()</em></td>
<td>Стандартное отклонение.</td>
</tr>
<tr>
<td><em>sum()</em></td>
<td>Сумма значений.</td>
</tr>
<tr>
<td><em>var()</em></td>
<td>Дисперсия.</td>
</tr>
<tr>
<td><strong>Порядковые функции:</strong></td>
<td></td>
</tr>
<tr>
<td><em>first()</em></td>
<td>Первое значение в таблице.</td>
</tr>
<tr>
<td><em>last()</em></td>
<td>Последнее значение в таблице.</td>
</tr>
<tr>
<td><strong>Функции для работы с multivalue-полями:</strong></td>
<td></td>
</tr>
<tr>
<td><em>list()</em></td>
<td>Список значений.</td>
</tr>
<tr>
<td><em>values()</em></td>
<td></td>
</tr>
<tr>
<td><strong>Временные функции:</strong></td>
<td></td>
</tr>
<tr>
<td><em>earliest()</em></td>
<td>Первое значение в таблице.</td>
</tr>
<tr>
<td><em>latest()</em></td>
<td>Последнее значение в таблице.</td>
</tr>
</tbody>
</table>
<h3 id="_141">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>_time</strong></th>
<th><strong>dest_country</strong></th>
<th><strong>currency</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2019-10-02 12:20:00</td>
<td>Italy</td>
<td>EUR</td>
<td>10</td>
</tr>
<tr>
<td>2019-10-02 12:20:01</td>
<td>Russia</td>
<td>USD</td>
<td>13</td>
</tr>
<tr>
<td>2019-10-02 12:20:02</td>
<td>Canada</td>
<td>RUB</td>
<td>14</td>
</tr>
<tr>
<td>2019-10-02 12:20:03</td>
<td>Canada</td>
<td>EUR</td>
<td>1</td>
</tr>
<tr>
<td>2019-10-02 12:20:04</td>
<td>Russia</td>
<td>USD</td>
<td>3</td>
</tr>
<tr>
<td>2019-10-02 12:20:05</td>
<td>Italy</td>
<td>RUB</td>
<td>4</td>
</tr>
<tr>
<td>2019-10-02 12:20:06</td>
<td>Italy</td>
<td>RUB</td>
<td>5</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Просматривает подряд события в таблице и, по мере просмотра, вычисляет три новых
поля. Вычисление происходит таким образом, что на момент просмотра очередного
события в трех новых полях находятся, соответственно, максимальное, минимальное
и сумма значений этого поля <em>sum</em> среди тех событий, которые уже просмотрены.</p>
<p>Запрос:</p>
<pre><code>... | streamstats count as count max(sum) as &quot;max num&quot; min(sum) as &quot;min num&quot; sum(sum) as &quot;sum num&quot;
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>_time</strong></th>
<th><strong>count</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest_country</strong></th>
<th><strong>max num</strong></th>
<th><strong>min num</strong></th>
<th><strong>sum</strong></th>
<th><strong>sum num</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2019-10-02 12:20:00</td>
<td>1</td>
<td>EUR</td>
<td>Italy</td>
<td>10</td>
<td>10</td>
<td>10</td>
<td>10</td>
</tr>
<tr>
<td>2019-10-02 12:20:01</td>
<td>2</td>
<td>USD</td>
<td>Russia</td>
<td>13</td>
<td>10</td>
<td>13</td>
<td>23</td>
</tr>
<tr>
<td>2019-10-02 12:20:02</td>
<td>3</td>
<td>RUB</td>
<td>Canada</td>
<td>14</td>
<td>10</td>
<td>14</td>
<td>37</td>
</tr>
<tr>
<td>2019-10-02 12:20:03</td>
<td>4</td>
<td>EUR</td>
<td>Canada</td>
<td>14</td>
<td>1</td>
<td>1</td>
<td>38</td>
</tr>
<tr>
<td>2019-10-02 12:20:04</td>
<td>5</td>
<td>USD</td>
<td>Russia</td>
<td>14</td>
<td>1</td>
<td>3</td>
<td>41</td>
</tr>
<tr>
<td>2019-10-02 12:20:05</td>
<td>6</td>
<td>RUB</td>
<td>Italy</td>
<td>14</td>
<td>1</td>
<td>4</td>
<td>45</td>
</tr>
<tr>
<td>2019-10-02 12:20:06</td>
<td>7</td>
<td>RUB</td>
<td>Italy</td>
<td>14</td>
<td>1</td>
<td>5</td>
<td>50</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Просматривает подряд события в таблице и, по мере просмотра, вычисляет новое
поле <em>count</em> – количество переводов в разрезе валюты (<em>currency</em>). Вычисление
происходит таким образом, что на момент просмотра очередного события поле
<em>count</em> содержит статистику только в отношении тех событий, которые уже
просмотрены.</p>
<p>Запрос:</p>
<pre><code>... | streamstats count by currency
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>_time</strong></th>
<th><strong>count</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest_country</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2019-10-02 12:20:00.000+0300</td>
<td>1</td>
<td>EUR</td>
<td>Italy</td>
<td>10</td>
</tr>
<tr>
<td>2019-10-02 12:20:01.000+0300</td>
<td>1</td>
<td>USD</td>
<td>Russia</td>
<td>13</td>
</tr>
<tr>
<td>2019-10-02 12:20:02.000+0300</td>
<td>1</td>
<td>RUB</td>
<td>Canada</td>
<td>14</td>
</tr>
<tr>
<td>2019-10-02 12:20:03.000+0300</td>
<td>2</td>
<td>EUR</td>
<td>Canada</td>
<td>1</td>
</tr>
<tr>
<td>2019-10-02 12:20:04.000+0300</td>
<td>2</td>
<td>USD</td>
<td>Russia</td>
<td>3</td>
</tr>
<tr>
<td>2019-10-02 12:20:05.000+0300</td>
<td>2</td>
<td>RUB</td>
<td>Italy</td>
<td>4</td>
</tr>
<tr>
<td>2019-10-02 12:20:06.000+0300</td>
<td>3</td>
<td>RUB</td>
<td>Italy</td>
<td>5</td>
</tr>
</tbody>
</table>
<p><strong>Пример 3</strong></p>
<p>Просматривает подряд события в таблице и, по мере просмотра, вычисляет новое
поле <em>total</em> – сумма переводов за определенное количество транзакций. Вычисление
происходит таким образом, что на момент просмотра очередного события поле
<em>total</em> содержит статистику только в отношении тех событий, которые уже
просмотрены. Статистика вычисляется в бегущем окне из трех событий. То есть
событие, которое отстает от текущего просматриваемого на 3 события и более, не
участвует в статистике.</p>
<p>Запрос:</p>
<pre><code>... | streamstats window=3 sum(sum) as &quot;total&quot;
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>_time</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest_country</strong></th>
<th><strong>sum</strong></th>
<th><strong>total</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2019-10-02 12:20:00</td>
<td>EUR</td>
<td>Italy</td>
<td>10</td>
<td>10</td>
</tr>
<tr>
<td>2019-10-02 12:20:01</td>
<td>USD</td>
<td>Russia</td>
<td>13</td>
<td>23</td>
</tr>
<tr>
<td>2019-10-02 12:20:02</td>
<td>RUB</td>
<td>Canada</td>
<td>14</td>
<td>37</td>
</tr>
<tr>
<td>2019-10-02 12:20:03</td>
<td>EUR</td>
<td>Canada</td>
<td>1</td>
<td>28</td>
</tr>
<tr>
<td>2019-10-02 12:20:04</td>
<td>USD</td>
<td>Russia</td>
<td>3</td>
<td>18</td>
</tr>
<tr>
<td>2019-10-02 12:20:05</td>
<td>RUB</td>
<td>Italy</td>
<td>4</td>
<td>8</td>
</tr>
<tr>
<td>2019-10-02 12:20:06</td>
<td>RUB</td>
<td>Italy</td>
<td>5</td>
<td>12</td>
</tr>
</tbody>
</table>
<h1 id="_142"></h1>
<h1 id="superjoin">SUPERJOIN</h1>
<p>Команда <strong>superjoin</strong> комбинирует данные из таблицы, указанной в параметрах
команды <strong>superjoin</strong>, с результатами основного запроса без каких-либо
ограничений на размер таблицы.</p>
<p><strong>Важно!<br />
</strong><em>Команда superjoin не является частью стандартного набора команд. Находится в
плагине OTLExtend.</em></p>
<h3 id="_143">Синтаксис команды</h3>
<pre><code>superjoin &lt;field-list&gt; &lt;superjoin-params&gt;
</code></pre>
<p>Обязательные параметры:</p>
<ul>
<li>
<p><strong>field-list</strong> – поля, по которым будет выполнена команда <strong>superjoin</strong>.
    Совпадение значений полей основного запроса и подзапроса должно быть с
    точностью до регистра отдельных символов.</p>
<p>Синтаксис: <em>&lt;field1>, &lt;field2>, ...</em></p>
</li>
<li>
<p><strong>superjoin-params</strong> – опции команды <strong>superjoin</strong>.</p>
<p>Синтаксис:</p>
</li>
</ul>
<pre><code>type=(inner|outer|left) format=(parquet|csv|orc|)  path=(parquet|csv|orc|)
</code></pre>
<p>Описание:</p>
<ul>
<li>
<p><strong>type</strong> – тип команды <strong>superjoin</strong>.</p>
<p>Синтаксис: <em>type=inner | outer | left</em>.</p>
<p>Значение по умолчанию отсутствует.</p>
<p>Разница между типами заключается в том, каким образом обрабатываются события
основного запроса, которые не могут быть поставлены в соответствие событиям
из таблицы. Как в <em>inner</em> так и в <em>left</em> возвращаются только те события,
которые могут быть поставлены в соответствие друг другу по заданному полю.
Однако результаты <em>inner join</em> не включают события основного запроса,
которые не имеют совпадений в присоединяемой таблице. Результат же <em>left
join</em> (или <em>outer join</em>) включает все события основного запроса и те события
из присоединяемой таблицы, которые могут быть поставлены в соответствие
событиям основного запроса по заданному полю.</p>
<ul>
<li>
<p><strong>format</strong> – формат таблицы, с которой соединяются результаты основного
    запроса.</p>
<p>Синтаксис: <em>format=(parquet|csv|orc|)</em>.</p>
<p>Значение по умолчанию отсутствует.</p>
</li>
<li>
<p><strong>path</strong> – путь к таблице с которой соединяются результаты основного
    запроса в external_data.</p>
<p>Синтаксис: <em>path=(path/to/table)</em>.</p>
<p>Значение по умолчанию отсутствует.</p>
</li>
</ul>
</li>
</ul>
<h3 id="_144">Пример использования</h3>
<pre><code>...| superjoin id, day type=left format=parquet path=folder/table1 
</code></pre>
<h1 id="_145"></h1>
<h1 id="tail">TAIL</h1>
<p>Возвращает последнее N число указанных результатов. События возвращаются в
обратном порядке, начиная с конца набора результатов.</p>
<p><strong>Важно!<br />
</strong><em>Порядок, в котором события будут поступать на обработку в команду</em> <strong>tail</strong><em>,
определяется результатам выполнения предыдущих команд. В случае необходимости
сохранения одного и того же порядка событий, необходимо предусмотреть сортировку
событий внутри запроса. Например, с помощью команды</em> <a href="#sort"><strong>sort</strong></a><em>.</em></p>
<h3 id="_146">Синтаксис команды</h3>
<pre><code>tail [&lt;N&gt;] | [limit=&lt;int&gt;]
</code></pre>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>N</strong> – количество возвращаемых результатов.</p>
<p>Значение по умолчанию = 10.</p>
</li>
<li>
<p><strong>limit=&lt;int></strong> – другой вариант задания количества возвращаемых
    результатов.</p>
</li>
</ul>
<h3 id="_147">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Возвращает последние четыре транзакции из списка.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045110</td>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>1587045120</td>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... | tail 4
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>datetime</strong></th>
<th><strong>currency</strong></th>
<th><strong>dest</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1587045130</td>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>1587045140</td>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>1587045150</td>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>1587045160</td>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<h1 id="_148"></h1>
<h1 id="timechart">TIMECHART</h1>
<p>Команда создает <em>диаграмму временного ряда</em> с соответствующей ей статистической
таблицей.</p>
<p><strong>Диаграмма временного ряда</strong> – это диаграмма с отображением времени на оси X.
По оси Y отображаются значения, вычисленные применением к какому-либо полю
статистической агрегации.</p>
<h3 id="_149">Синтаксис команды</h3>
<pre><code>timechart [span=&lt;timescale&gt;] (&lt;stats-agg-term&gt; 
BY &lt;split-by-clause&gt;)
</code></pre>
<p>Обязательные параметры:</p>
<ul>
<li>
<p><strong>stats-agg-term</strong> – статистические функции (перечень см. в разделе ниже),
    применяемые к полям и eval-выражениям. Результат выполнения функции может
    быть помещён в отдельное поле с именем, указанным после операнда <em>AS</em>.</p>
<p>Синтаксис: <em>&lt;stats-func>( &lt;evaled-field> | &lt;wc-field> ) [AS
&lt;new-field>]</em>.</p>
</li>
<li>
<p><strong>BY &lt;split-by-clause></strong> – поле для разделения результатов.</p>
</li>
</ul>
<p>Каждый раз, когда вызывается команда <strong>timechart</strong>, можно использовать одну или
несколько функций. Однако оператор <strong>BY</strong> можно использовать только один раз.</p>
<p>Опциональный параметр:</p>
<ul>
<li><strong>span=&lt;timescale></strong> – временной интервал для группировки. Возможные
    варианты указаны в таблице ниже.</li>
</ul>
<table>
<thead>
<tr>
<th><strong>Временные рамки</strong></th>
<th><strong>Доступный синтаксис</strong></th>
<th><strong>Описание</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt;sec></td>
<td>"s"</td>
<td>"sec"</td>
</tr>
<tr>
<td>&lt;min></td>
<td>"m"</td>
<td>"min"</td>
</tr>
<tr>
<td>&lt;hr></td>
<td>"h"</td>
<td>Шкала времени в часах</td>
</tr>
<tr>
<td>&lt;day></td>
<td>"d"</td>
<td>Шкала времени в днях</td>
</tr>
<tr>
<td>&lt;week></td>
<td>"w"</td>
<td>Шкала времени в неделях</td>
</tr>
<tr>
<td>&lt;month></td>
<td>"mon"</td>
<td>Шкала времени в месяцах</td>
</tr>
</tbody>
</table>
<h4 id="_150">Статистические функции</h4>
<p>Функции позволяют получить различные статистики по полю или eval-выражению, к
которому они применяются.</p>
<p>В таблице представлен перечень функций, сгруппированных по типам:</p>
<table>
<thead>
<tr>
<th><strong>Имя функции</strong></th>
<th><strong>Описание функции</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Агрегирующие функции:</strong></td>
<td></td>
</tr>
<tr>
<td><em>approxdc()</em></td>
<td>Приблизительное количество уникальных значений.</td>
</tr>
<tr>
<td><em>avg()</em></td>
<td>Среднее арифметическое.</td>
</tr>
<tr>
<td><em>count()</em></td>
<td>Количество значений.</td>
</tr>
<tr>
<td><em>distinct_count()</em></td>
<td>Количество уникальных значений.</td>
</tr>
<tr>
<td><em>max()</em></td>
<td>Наибольшее значение.</td>
</tr>
<tr>
<td><em>min()</em></td>
<td>Наименьшее значение.</td>
</tr>
<tr>
<td><em>perc()</em></td>
<td>Процентиль.</td>
</tr>
<tr>
<td><em>percentile_approx()</em></td>
<td></td>
</tr>
<tr>
<td><em>stdev()</em></td>
<td>Стандартное отклонение.</td>
</tr>
<tr>
<td><em>sum()</em></td>
<td>Сумма значений.</td>
</tr>
<tr>
<td><em>var()</em></td>
<td>Дисперсия.</td>
</tr>
<tr>
<td><strong>Порядковые функции:</strong></td>
<td></td>
</tr>
<tr>
<td><em>first()</em></td>
<td>Первое значение в таблице.</td>
</tr>
<tr>
<td><em>last()</em></td>
<td>Последнее значение в таблице.</td>
</tr>
<tr>
<td><strong>Функции для работы с multivalue-полями:</strong></td>
<td></td>
</tr>
<tr>
<td><em>list()</em></td>
<td>Список значений.</td>
</tr>
<tr>
<td><em>values()</em></td>
<td></td>
</tr>
<tr>
<td><strong>Временные функции:</strong></td>
<td></td>
</tr>
<tr>
<td><em>earliest()</em></td>
<td>Первое значение в таблице.</td>
</tr>
<tr>
<td><em>latest()</em></td>
<td>Последнее значение в таблице.</td>
</tr>
</tbody>
</table>
<h3 id="_151">Примеры использования</h3>
<p><strong>Пример 1</strong></p>
<p>Агрегирует в интервалы по двое суток статистику размеров авиатрафика.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>Terminal</strong></th>
<th><strong>_time</strong></th>
<th><strong>Arrivals</strong></th>
<th><strong>Departures</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>TerminalA</td>
<td>1556704800</td>
<td>235</td>
<td>321</td>
</tr>
<tr>
<td>TerminalB</td>
<td>1556704800</td>
<td>178</td>
<td>167</td>
</tr>
<tr>
<td>TerminalC</td>
<td>1556704800</td>
<td>79</td>
<td>68</td>
</tr>
<tr>
<td>TerminalA</td>
<td>1556791200</td>
<td>216</td>
<td>278</td>
</tr>
<tr>
<td>TerminalB</td>
<td>1556791200</td>
<td>165</td>
<td>145</td>
</tr>
<tr>
<td>TerminalC</td>
<td>1556791200</td>
<td>64</td>
<td>60</td>
</tr>
<tr>
<td>TerminalA</td>
<td>1556877600</td>
<td>223</td>
<td>216</td>
</tr>
<tr>
<td>TerminalB</td>
<td>1556877600</td>
<td>143</td>
<td>120</td>
</tr>
<tr>
<td>TerminalC</td>
<td>1556877600</td>
<td>87</td>
<td>98</td>
</tr>
<tr>
<td>TerminalA</td>
<td>1556964000</td>
<td>145</td>
<td>256</td>
</tr>
<tr>
<td>TerminalB</td>
<td>1556964000</td>
<td>124</td>
<td>167</td>
</tr>
<tr>
<td>TerminalC</td>
<td>1556964000</td>
<td>89</td>
<td>51</td>
</tr>
<tr>
<td>TerminalA</td>
<td>1557050400</td>
<td>256</td>
<td>170</td>
</tr>
<tr>
<td>TerminalB</td>
<td>1557050400</td>
<td>146</td>
<td>198</td>
</tr>
<tr>
<td>TerminalC</td>
<td>1557050400</td>
<td>95</td>
<td>101</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... 
| eval Air_traffic=Arrivals+Departures 
| timechart span=2d sum(Air_traffic) by Terminal 
| rename _time as Time 
| eval Time=strftime(Time, &quot;%Y-%m-%dT%H:%M:%S&quot;)
</code></pre>
<p>В запросе время конвертируется из Unix-time формата в понятный для человека
формат.</p>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Time</strong></th>
<th><strong>TerminalA</strong></th>
<th><strong>TerminalB</strong></th>
<th><strong>TerminalC</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2019-04-30T03:00:00</td>
<td>556</td>
<td>345</td>
<td>147</td>
</tr>
<tr>
<td>2019-05-02T03:00:00</td>
<td>933</td>
<td>573</td>
<td>309</td>
</tr>
<tr>
<td>2019-05-04T03:00:00</td>
<td>827</td>
<td>635</td>
<td>336</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Агрегирует в интервалы по двое суток минимальное и максимальное значения
авиатрафика.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>Terminal</strong></th>
<th><strong>_time</strong></th>
<th><strong>Arrivals</strong></th>
<th><strong>Departures</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>TerminalA</td>
<td>1556704800</td>
<td>235</td>
<td>321</td>
</tr>
<tr>
<td>TerminalB</td>
<td>1556704800</td>
<td>178</td>
<td>167</td>
</tr>
<tr>
<td>TerminalC</td>
<td>1556704800</td>
<td>79</td>
<td>68</td>
</tr>
<tr>
<td>TerminalA</td>
<td>1556791200</td>
<td>216</td>
<td>278</td>
</tr>
<tr>
<td>TerminalB</td>
<td>1556791200</td>
<td>165</td>
<td>145</td>
</tr>
<tr>
<td>TerminalC</td>
<td>1556791200</td>
<td>64</td>
<td>60</td>
</tr>
<tr>
<td>TerminalA</td>
<td>1556877600</td>
<td>223</td>
<td>216</td>
</tr>
<tr>
<td>TerminalB</td>
<td>1556877600</td>
<td>143</td>
<td>120</td>
</tr>
<tr>
<td>TerminalC</td>
<td>1556877600</td>
<td>87</td>
<td>98</td>
</tr>
<tr>
<td>TerminalA</td>
<td>1556964000</td>
<td>145</td>
<td>256</td>
</tr>
<tr>
<td>TerminalB</td>
<td>1556964000</td>
<td>124</td>
<td>167</td>
</tr>
<tr>
<td>TerminalC</td>
<td>1556964000</td>
<td>89</td>
<td>51</td>
</tr>
<tr>
<td>TerminalA</td>
<td>1557050400</td>
<td>256</td>
<td>170</td>
</tr>
<tr>
<td>TerminalB</td>
<td>1557050400</td>
<td>146</td>
<td>198</td>
</tr>
<tr>
<td>TerminalC</td>
<td>1557050400</td>
<td>95</td>
<td>101</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... 
| eval Air_traffic=Arrivals+Departures 
| timechart span=2d max(Air_traffic) as &quot;max&quot; min(Air_traffic) as &quot;min&quot; by Terminal 
| rename _time as Time 
| eval Time=strftime(Time, &quot;%Y-%m-%dT%H:%M:%S&quot;)
</code></pre>
<p>В запросе время конвертируется из Unix-time формата в понятный для человека
формат.</p>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Time</strong></th>
<th><strong>max: TerminalA</strong></th>
<th><strong>min: TerminalA</strong></th>
<th><strong>max: TerminalB</strong></th>
<th><strong>min: TerminalB</strong></th>
<th><strong>max: TerminalC</strong></th>
<th><strong>min: TerminalC</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2019-05-02T03:00:00</td>
<td>494</td>
<td>439</td>
<td>310</td>
<td>263</td>
<td>185</td>
<td>124</td>
</tr>
<tr>
<td>2019-05-04T03:00:00</td>
<td>426</td>
<td>401</td>
<td>344</td>
<td>291</td>
<td>196</td>
<td>140</td>
</tr>
</tbody>
</table>
<h1 id="_152"></h1>
<h1 id="top">TOP</h1>
<p>Команда находит наиболее часто встречающиеся значения в выбранных полях.</p>
<h3 id="_153">Синтаксис команды</h3>
<pre><code>top [&lt;number&gt;] &lt;field-list&gt; [&lt;by-clause&gt;]
</code></pre>
<p>Команда вычисляет количество и процентное соотношение того, как часто выбранные
значения встречаются в событиях. Если добавлена опция <em>by-clause</em>, то результат
будет сгруппирован по полю, указанному после <em>by</em>.</p>
<p>Обязательный параметр:</p>
<ul>
<li><strong>field-list</strong> – поле или список полей (через запятую или пробел), по
    которым проводится подсчёт.</li>
</ul>
<p>Опциональный параметр:</p>
<ul>
<li>
<p><strong>number</strong> – указывается количество верхних строк, которые должны быть
    выведены в результате. По умолчанию: <em>10</em>.</p>
</li>
<li>
<p><strong>by-clause</strong> – одно или несколько полей, значения которых будут названиями
    столбцов в результирующей таблице.</p>
</li>
</ul>
<h3 id="_154">Пример использования</h3>
<p>Выводит 3 наиболее часто встречающихся Имени.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Surname</strong></th>
<th><strong>age</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>John</td>
<td>Snow</td>
<td>10</td>
</tr>
<tr>
<td>Alex</td>
<td>Smith</td>
<td>7</td>
</tr>
<tr>
<td>Anna</td>
<td>Show</td>
<td>21</td>
</tr>
<tr>
<td>John</td>
<td>Bond</td>
<td>3</td>
</tr>
<tr>
<td>John</td>
<td>Smith</td>
<td>19</td>
</tr>
<tr>
<td>Tony</td>
<td>Stark</td>
<td>5</td>
</tr>
<tr>
<td>John</td>
<td>Dow</td>
<td>19</td>
</tr>
<tr>
<td>Tony</td>
<td>Pitt</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... | top 3 Name
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>count</strong></th>
<th><strong>percent</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>John</td>
<td>4</td>
<td>50</td>
</tr>
<tr>
<td>Tony</td>
<td>2</td>
<td>25</td>
</tr>
<tr>
<td>Alex</td>
<td>1</td>
<td>12.5</td>
</tr>
</tbody>
</table>
<h1 id="_155"></h1>
<h1 id="transaction">TRANSACTION</h1>
<p>Команда позволяет найти среди множества записей, сгруппированных по указанному
набору полей, первую по времени запись (в своей группе).</p>
<p>Например, исходные данные содержат название месторождения, название метрики и
значение метрики. Для такого набора данных команда <strong>transaction</strong> позволяет
найти первую по времени запись для каждого уникального значения каждой
уникальной метрики для каждого уникального месторождения. Транзакцией в данном
случае называется совокупность следующих данных: название месторождения,
название метрики, значение метрики.</p>
<p>Исходя из описания, следует отметить, что исходный набор данных должен содержать
временную отметку в виде поля <em>_time</em> (время измерения). Если поле <em>_time</em>
отсутствует, то команда вернет набор данных, сгруппированный по полям, указанным
в параметрах. При этом поля, не указанные в параметрах команды, но
присутствующие в наборе данных, будут представлены массивами своих значений.</p>
<p>Например, если в описанном выше наборе данных есть поле с номером скважины (при
этом на одном месторождении может располагаться несколько скважин), но его нет
среди параметров команды <strong>transaction</strong> (то есть группировка по нему не
производится), то в результирующем наборе это поле будет представлено массивом
значений, соответствующих транзакции с полями название месторождения, название
метрики, значение метрики.</p>
<p>Использование команды <strong>transaction</strong> c набором данных без поля <em>_time</em>, а
также включение данного поля в список параметров команды <em>нежелательно</em>. Если
поле <em>_time</em> будет указано среди параметров, то группировка будет производиться
в том числе и по нему, что лишает смысла использование команды.</p>
<p>Более детально рассмотрим правила работы команды на примерах ниже.</p>
<h3 id="_156">Синтаксис команды</h3>
<pre><code>transaction [field-list]
</code></pre>
<p>Обязательные параметры: отсутствуют.</p>
<p>Опциональный параметр:</p>
<ul>
<li><strong>field-list –</strong> непустой список полей, по которым будет формироваться
    транзакция. Синтаксис: <em>, , ... .</em></li>
</ul>
<h3 id="_157">Примеры использования</h3>
<p>Исходные данные:</p>
<p>Набор представляет результаты измерений двух метрик – температуры и влажности –
на скважинах нескольких месторождений. На одно месторождение может приходиться
несколько скважин.</p>
<table>
<thead>
<tr>
<th><strong>_time</strong></th>
<th><strong>deposit</strong></th>
<th><strong>well</strong></th>
<th><strong>metric_name</strong></th>
<th><strong>value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1641744164</td>
<td>"deposit_1"</td>
<td>"well_1"</td>
<td>temperature</td>
<td>27</td>
</tr>
<tr>
<td>1641744164</td>
<td>"deposit_1"</td>
<td>"well_2"</td>
<td>temperature</td>
<td>27</td>
</tr>
<tr>
<td>1641744164</td>
<td>"deposit_2"</td>
<td>"well_1"</td>
<td>temperature</td>
<td>27</td>
</tr>
<tr>
<td>1641744164</td>
<td>"deposit_2"</td>
<td>"well_2"</td>
<td>temperature</td>
<td>27</td>
</tr>
<tr>
<td>1641744164</td>
<td>"deposit_3"</td>
<td>"well_1"</td>
<td>temperature</td>
<td>27</td>
</tr>
<tr>
<td>1641744364</td>
<td>"deposit_1"</td>
<td>"well_1"</td>
<td>temperature</td>
<td>26</td>
</tr>
<tr>
<td>1641744364</td>
<td>"deposit_2"</td>
<td>"well_2"</td>
<td>temperature</td>
<td>25</td>
</tr>
<tr>
<td>1641744364</td>
<td>"deposit_3"</td>
<td>"well_1"</td>
<td>temperature</td>
<td>27</td>
</tr>
<tr>
<td>1641744164</td>
<td>"deposit_1"</td>
<td>"well_2"</td>
<td>humidity</td>
<td>47</td>
</tr>
<tr>
<td>1641744164</td>
<td>"deposit_2"</td>
<td>"well_1"</td>
<td>humidity</td>
<td>67</td>
</tr>
<tr>
<td>1641744164</td>
<td>"deposit_3"</td>
<td>"well_2"</td>
<td>humidity</td>
<td>57</td>
</tr>
<tr>
<td>1641744364</td>
<td>"deposit_1"</td>
<td>"well_1"</td>
<td>humidity</td>
<td>36</td>
</tr>
<tr>
<td>1641744364</td>
<td>"deposit_1"</td>
<td>"well_2"</td>
<td>humidity</td>
<td>36</td>
</tr>
<tr>
<td>1641744364</td>
<td>"deposit_2"</td>
<td>"well_2"</td>
<td>humidity</td>
<td>55</td>
</tr>
<tr>
<td>1641744364</td>
<td>"deposit_3"</td>
<td>"well_1"</td>
<td>humidity</td>
<td>57</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Исходные данные содержат поле <em>_time</em>, однако среди параметров команды поле
<em>_time</em> отсутствует. При этом <em>все поля</em> исходных данных указаны в списке
параметров команды. В этом случае команда вернёт набор уникальных транзакций с
полями <em>deposit</em>, <em>well</em>, <em>metric_name</em> и <em>value</em>. Каждая уникальная транзакция
при этом будет иметь в качестве поля <em>_time</em> минимальное значение времени среди
всех записей исходных данных, подходящих под ограничения данной транзакции.</p>
<p>Запрос:</p>
<pre><code>... | transaction deposit, well, metric_name, value
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>deposit</strong></th>
<th><strong>well</strong></th>
<th><strong>metric_name</strong></th>
<th><strong>value</strong></th>
<th><strong>_time</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>"deposit_2"</td>
<td>"well_2"</td>
<td>humidity</td>
<td>55</td>
<td>1641744364</td>
</tr>
<tr>
<td>"deposit_1"</td>
<td>"well_1"</td>
<td>humidity</td>
<td>36</td>
<td>1641744364</td>
</tr>
<tr>
<td>"deposit_1"</td>
<td>"well_1"</td>
<td>temperature</td>
<td>27</td>
<td>1641744164</td>
</tr>
<tr>
<td>"deposit_2"</td>
<td>"well_1"</td>
<td>temperature</td>
<td>27</td>
<td>1641744164</td>
</tr>
<tr>
<td>"deposit_2"</td>
<td>"well_1"</td>
<td>humidity</td>
<td>67</td>
<td>1641744164</td>
</tr>
<tr>
<td>"deposit_3"</td>
<td>"well_1"</td>
<td>temperature</td>
<td>27</td>
<td>1641744164</td>
</tr>
<tr>
<td>"deposit_1"</td>
<td>"well_1"</td>
<td>temperature</td>
<td>26</td>
<td>1641744364</td>
</tr>
<tr>
<td>"deposit_1"</td>
<td>"well_2"</td>
<td>humidity</td>
<td>36</td>
<td>1641744364</td>
</tr>
<tr>
<td>"deposit_1"</td>
<td>"well_2"</td>
<td>humidity</td>
<td>47</td>
<td>1641744164</td>
</tr>
<tr>
<td>"deposit_3"</td>
<td>"well_2"</td>
<td>humidity</td>
<td>57</td>
<td>1641744164</td>
</tr>
<tr>
<td>"deposit_3"</td>
<td>"well_1"</td>
<td>humidity</td>
<td>57</td>
<td>1641744364</td>
</tr>
<tr>
<td>"deposit_2"</td>
<td>"well_2"</td>
<td>temperature</td>
<td>27</td>
<td>1641744164</td>
</tr>
<tr>
<td>"deposit_2"</td>
<td>"well_2"</td>
<td>temperature</td>
<td>25</td>
<td>1641744364</td>
</tr>
<tr>
<td>"deposit_1"</td>
<td>"well_2"</td>
<td>temperature</td>
<td>27</td>
<td>1641744164</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Исходные данные содержат поле <em>_time</em>, однако среди параметров команды поле
<em>_time</em> отсутствует. При этом <em>не все поля</em> исходных данных указаны в списке
параметров команды (отсутствует <em>well</em>). В этом случае команда вернёт набор
уникальных транзакций с полями <em>deposit</em>, <em>metric_name</em> и <em>value</em>. Поле с
названием скважины <em>well</em> будет представлено массивом. Если одно и то же
значение конкретной метрики на конкретном месторождении встречается одновременно
на нескольких скважинах, то в этом поле будут указаны все такие скважины (одному
уникальному сочетанию значений полей <em>deposit</em>, <em>metric_name</em>, <em>value</em>
соответствует несколько скважин, которые и представлены массивом названий).
Каждая уникальная транзакция при этом будет иметь в качестве поля <em>_time</em>
минимальное значение времени среди всех записей исходных данных, подходящих под
ограничения данной транзакции.</p>
<p>Запрос:</p>
<pre><code>... | transaction deposit, metric_name, value
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>deposit</strong></th>
<th><strong>metric_name</strong></th>
<th><strong>value</strong></th>
<th><strong>_time</strong></th>
<th><strong>well</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>"deposit_2"</td>
<td>humidity</td>
<td>55</td>
<td>1641744364</td>
<td>[ "well_2" ]</td>
</tr>
<tr>
<td>"deposit_3"</td>
<td>humidity</td>
<td>57</td>
<td>1641744164</td>
<td>[ "well_2", "well_1" ]</td>
</tr>
<tr>
<td>"deposit_3"</td>
<td>temperature</td>
<td>27</td>
<td>1641744164</td>
<td>[ "well_1" ]</td>
</tr>
<tr>
<td>"deposit_1"</td>
<td>humidity</td>
<td>47</td>
<td>1641744164</td>
<td>[ "well_2" ]</td>
</tr>
<tr>
<td>"deposit_1"</td>
<td>temperature</td>
<td>26</td>
<td>1641744364</td>
<td>[ "well_1" ]</td>
</tr>
<tr>
<td>"deposit_2"</td>
<td>temperature</td>
<td>27</td>
<td>1641744164</td>
<td>[ "well_2" , "well_1" ]</td>
</tr>
<tr>
<td>"deposit_2"</td>
<td>temperature</td>
<td>25</td>
<td>1641744364</td>
<td>[ "well_2" ]</td>
</tr>
<tr>
<td>"deposit_1"</td>
<td>humidity</td>
<td>36</td>
<td>1641744364</td>
<td>[ "well_2" , "well_1" ]</td>
</tr>
<tr>
<td>"deposit_1"</td>
<td>temperature</td>
<td>27</td>
<td>1641744164</td>
<td>[ "well_2" , "well_1" ]</td>
</tr>
<tr>
<td>"deposit_2"</td>
<td>humidity</td>
<td>67</td>
<td>1641744164</td>
<td>[ "well_1" ]</td>
</tr>
</tbody>
</table>
<p><strong>Пример 3</strong></p>
<p>Исходные данные содержат поле <em>_time</em>, поле <em>_time</em> присутствует среди
параметров команды. При этом <em>все поля</em> исходных данных указаны в списке
параметров команды. В этом случае команда вернет набор записей, сгруппированных
по параметрам, которые присутствуют в наборе данных, но отсутствуют среди
параметров команды. А поскольку в параметрах команды указаны все поля исходного
набора, группировка будет производиться по всем полям в наборе данных. Таким
образом, команда вернёт набор данных, аналогичный исходному (порядок записей при
этом может отличаться от исходного).</p>
<p>Запрос:</p>
<pre><code>... | transaction deposit, well, metric_name, value, _time
</code></pre>
<p><strong>Пример 4</strong></p>
<p>Исходные данные содержат поле <em>_time</em>, поле <em>_time</em> присутствует среди
параметров команды. При этом <em>не все поля</em> исходных данных указаны в списке
параметров (отсутствует – <em>well</em>). В этом случае команда вернет набор записей,
сгруппированных по параметрам, которые присутствуют в наборе данных, но
отсутствуют среди параметров команды. В данном случае среди параметров
отсутствует только поле <em>well</em>, поэтому данное поле будет представлено массивом,
содержащим все названия скважин, соответствующие уникальному сочетанию значений
полей <em>_time</em>, <em>deposit</em>, <em>metric_name</em>, <em>value</em>.</p>
<p>Запрос:</p>
<pre><code>... | transaction deposit, metric_name, value, _time
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>deposit</strong></th>
<th><strong>metric_name</strong></th>
<th><strong>value</strong></th>
<th><strong>_time</strong></th>
<th><strong>well</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>"deposit_1"</td>
<td>temperature</td>
<td>26</td>
<td>1641744364</td>
<td>[ "well_1" ]</td>
</tr>
<tr>
<td>"deposit_3"</td>
<td>temperature</td>
<td>27</td>
<td>1641744364</td>
<td>[ "well_1" ]</td>
</tr>
<tr>
<td>"deposit_3"</td>
<td>temperature</td>
<td>27</td>
<td>1641744164</td>
<td>[ "well_1" ]</td>
</tr>
<tr>
<td>"deposit_2"</td>
<td>humidity</td>
<td>55</td>
<td>1641744364</td>
<td>[ "well_2" ]</td>
</tr>
<tr>
<td>"deposit_3"</td>
<td>humidity</td>
<td>57</td>
<td>1641744364</td>
<td>[ "well_1" ]</td>
</tr>
<tr>
<td>"deposit_1"</td>
<td>humidity</td>
<td>47</td>
<td>1641744164</td>
<td>[ "well_2" ]</td>
</tr>
<tr>
<td>"deposit_1"</td>
<td>humidity</td>
<td>36</td>
<td>1641744364</td>
<td>[ "well_2" , "well_1" ]</td>
</tr>
<tr>
<td>"deposit_1"</td>
<td>temperature</td>
<td>27</td>
<td>1641744164</td>
<td>[ "well_2" , "well_1" ]</td>
</tr>
<tr>
<td>"deposit_2"</td>
<td>temperature</td>
<td>27</td>
<td>1641744164</td>
<td>[ "well_2" , "well_1" ]</td>
</tr>
<tr>
<td>"deposit_3"</td>
<td>humidity</td>
<td>57</td>
<td>1641744164</td>
<td>[ "well_2" ]</td>
</tr>
<tr>
<td>"deposit_2"</td>
<td>humidity</td>
<td>67</td>
<td>1641744164</td>
<td>[ "well_1" ]</td>
</tr>
<tr>
<td>"deposit_2"</td>
<td>temperature</td>
<td>25</td>
<td>1641744364</td>
<td>[ "well_2" ]</td>
</tr>
</tbody>
</table>
<h1 id="_158"></h1>
<h1 id="transpose">TRANSPOSE</h1>
<p>Команда возвращает заданное число рядов поисковых результатов в виде колонок –
происходит операция транспонирования.</p>
<h3 id="_159">Синтаксис команды</h3>
<pre><code>transpose [int] [column_name=&lt;string&gt;] [header_field=&lt;field&gt;] [include_empty=&lt;bool&gt;]
</code></pre>
<p>Обязательные параметры: отсутствуют.</p>
<p>Опциональные параметры:</p>
<ul>
<li>
<p><strong>column_name</strong> – имя, которое будет носить первая колонка. Значениями ячеек
    в этой колонке будут наименования столбцов до применения команды
    <strong>transpose</strong>.</p>
<p>Значение по умолчанию: <em>column</em>.</p>
</li>
<li>
<p><strong>header_field</strong> – имя колонки до трансформации, значения из которой будут
    использованы как имена колонок (кроме первой колонки) в транспонированных
    данных.</p>
<p>Значение по умолчанию: <em>row 1, row 2, row 3, и т.д.</em></p>
</li>
<li>
<p><strong>include_empty</strong> – определяет включать (<em>true</em>) или нет (<em>false</em>) в
    операцию транспонирования те поля, которые содержат пустые и только пустые
    значения.</p>
<p>Значение по умолчанию: <em>true</em>.</p>
</li>
<li>
<p><strong>int</strong> – определяет количество рядов для транспонирования. Чтобы
    транспонировать все ряды, значения должно быть равным нулю.</p>
<p>Значение по умолчанию: 5.</p>
</li>
</ul>
<h3 id="_160">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>currency</strong></th>
<th><strong>dest_country</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RUB</td>
<td>Russia</td>
<td>10</td>
</tr>
<tr>
<td>USD</td>
<td>Russia</td>
<td>7</td>
</tr>
<tr>
<td>EUR</td>
<td>Germany</td>
<td>21</td>
</tr>
<tr>
<td>EUR</td>
<td>USA</td>
<td>3</td>
</tr>
<tr>
<td>RUB</td>
<td>Germany</td>
<td>19</td>
</tr>
<tr>
<td>EUR</td>
<td>Russia</td>
<td>7</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Транспонирует таблицу, выводит 5 результатов транспонирования (значение по
умолчанию), переименовывает первую колонку из названия по умолчанию в
<em>col_values</em> (из <em>column</em> в <em>col_values</em>).</p>
<p>Запрос:</p>
<pre><code>... | transpose column_name=col_values
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>col_values</strong></th>
<th><strong>row 1</strong></th>
<th><strong>row 2</strong></th>
<th><strong>row 3</strong></th>
<th><strong>row 4</strong></th>
<th><strong>row 5</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>currency</td>
<td>RUB</td>
<td>USD</td>
<td>EUR</td>
<td>EUR</td>
<td>RUB</td>
</tr>
<tr>
<td>dest_country</td>
<td>Russia</td>
<td>Russia</td>
<td>Germany</td>
<td>USA</td>
<td>Germany</td>
</tr>
<tr>
<td>sum</td>
<td>10</td>
<td>7</td>
<td>21</td>
<td>3</td>
<td>19</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Транспонирует таблицу, в качестве имен столбцов берутся значения столбца
<em>dest_country</em> до транспонирования.</p>
<pre><code>... | transpose  header_field=dest_country
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>column</strong></th>
<th><strong>Russia</strong></th>
<th><strong>Germany</strong></th>
<th><strong>USA</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>currency</td>
<td>USD</td>
<td>USD</td>
<td>RUB</td>
</tr>
<tr>
<td>sum</td>
<td>7</td>
<td>7</td>
<td>19</td>
</tr>
</tbody>
</table>
<h1 id="_161"></h1>
<h1 id="untable">UNTABLE</h1>
<p>Команда преобразует данные, изначально представленные в виде широкой таблицы, в
длинную таблицу.</p>
<p><em>Примечание.<br />
В широкой таблице каждая метрика представлена в отдельной колонке. В длинной
таблице есть колонка, содержащая имена метрик, колонка, содержащая значения
метрик (пара "ключ-значение").</em></p>
<p>Команда позволяет, зафиксировав значение одной из колонок (например, поле
<em>_time</em>), разбить каждую из строк исходной таблицы на несколько строк в
результирующей таблице.</p>
<h3 id="_162">Синтаксис команды</h3>
<pre><code>untable &lt;fixed_column=&lt;string&gt;&gt;, &lt;field_column=&lt;string&gt;&gt;, &lt;value_column=&lt;string&gt;&gt;
</code></pre>
<p>Обязательные параметры:</p>
<ul>
<li>
<p><strong>fixed_column</strong> – имя колонки, по которой будут группироваться данные (чаще
    всего используется колонка с полем <em>_time</em>).</p>
</li>
<li>
<p><strong>field_column</strong> – имя колонки, которая будет содержать имена метрик.</p>
</li>
<li>
<p><strong>value_column</strong> – имя колонки, в которую нужно поместить значения метрик.</p>
</li>
</ul>
<p>Опциональные параметры отсутствуют.</p>
<h3 id="_163">Пример использования</h3>
<p>Нужно преобразовать широкую таблицу в длинную. Данные группируются по полю
<em>_time</em>. Каждая исходная строка разбивается на 4 строки.</p>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>_time</strong></th>
<th><strong>temperature</strong></th>
<th><strong>humidity</strong></th>
<th><strong>carbon_dioxide_level</strong></th>
<th><strong>air_pressure</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1641744664</td>
<td>27</td>
<td>42</td>
<td>452</td>
<td>756</td>
</tr>
<tr>
<td>1641744774</td>
<td>18</td>
<td>37</td>
<td>537</td>
<td>759</td>
</tr>
<tr>
<td>1641744884</td>
<td>23</td>
<td>47</td>
<td>425</td>
<td>763</td>
</tr>
</tbody>
</table>
<p>Запрос:</p>
<pre><code>... | untable _time, metric_name, value
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>_time</strong></th>
<th><strong>metric_name</strong></th>
<th><strong>value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1641744664</td>
<td>temperature</td>
<td>27</td>
</tr>
<tr>
<td>1641744664</td>
<td>humidity</td>
<td>42</td>
</tr>
<tr>
<td>1641744664</td>
<td>carbon_dioxide_level</td>
<td>452</td>
</tr>
<tr>
<td>1641744664</td>
<td>air_pressure</td>
<td>756</td>
</tr>
<tr>
<td>1641744774</td>
<td>temperature</td>
<td>18</td>
</tr>
<tr>
<td>1641744774</td>
<td>humidity</td>
<td>37</td>
</tr>
<tr>
<td>1641744774</td>
<td>carbon_dioxide_level</td>
<td>537</td>
</tr>
<tr>
<td>1641744774</td>
<td>air_pressure</td>
<td>759</td>
</tr>
<tr>
<td>1641744884</td>
<td>temperature</td>
<td>23</td>
</tr>
<tr>
<td>1641744884</td>
<td>humidity</td>
<td>47</td>
</tr>
<tr>
<td>1641744884</td>
<td>carbon_dioxide_level</td>
<td>425</td>
</tr>
<tr>
<td>1641744884</td>
<td>air_pressure</td>
<td>763</td>
</tr>
</tbody>
</table>
<h1 id="_164"></h1>
<h1 id="where">WHERE</h1>
<p>Команда <strong>where</strong> использует eval-выражения для фильтрации результатов запроса.
Эти eval-выражения должны быть булевыми выражениями, то есть возвращать <em>true</em>
или <em>false</em> значения. Команда <strong>where</strong> пропускает только те результаты, для
которых eval-выражения возвращают <em>true</em>.</p>
<h3 id="_165">Синтаксис команды</h3>
<pre><code>where &lt;eval-expression&gt;
</code></pre>
<p>Команда <strong>where</strong> использует синтаксис, схожий с командой <a href="#eval"><strong>eval</strong></a>.</p>
<p>Команда интерпретирует строки, заключенные в кавычки, как строковые значения.
Если строка не имеет кавычек, то она обрабатывается как поле. Эта особенность
позволяет, в отличие от команды <a href="#search-filter"><strong>search</strong></a>, сравнивать два
отдельных поля.</p>
<p>Для поиска по нескольким значениям полей можно использовать логические
выражения: <em>or</em>, <em>and</em>. Также необходимо учитывать тип данных того поля, по
которому производится поиск, так как к строковым значениям нельзя применить
операции сравнения (&lt;, >, >=, &lt;=).</p>
<p>Обязательный параметр:</p>
<ul>
<li><strong>eval-expression</strong> – операции сравнения, логические выражения, в том числе
    содержащие функции (перечень функций представлен ниже).</li>
</ul>
<p>Таблица указывает на особенности синтаксиса, которые нужно учитывать при
построении запроса:</p>
<table>
<thead>
<tr>
<th><strong>Символы в выражениях</strong></th>
<th><strong>Описание</strong></th>
<th><strong>Пример</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Имена полей начинаются с числа</td>
<td>Если выражение обращается к полю, имя которого начинается с цифры, рекомендуется такое поле заключать в одинарные кавычки (апострофы).</td>
<td>'10km'="far"  Это выражение представляет собой поле, которое сравнивается со строкой.  Так как поле начинается с цифры, оно заключено в одинарные кавычки, а строка заключена в двойные кавычки.</td>
</tr>
<tr>
<td>Имена полей, содержащие не цифро-буквенные символы.</td>
<td>Если выражение обращается к полю, имя которого содержит не цифро-буквенные символы, то это поле должно быть заключено в одинарные кавычки (апострофы).</td>
<td>coord=xy+'point-1'  Это выражение могло быть интерпретировано как математическое сравнение, где дефис считался бы минусом. Для того, чтобы избежать этого, нужно заключить поле point-1 в одинарные кавычки.</td>
</tr>
<tr>
<td>Строки</td>
<td>Если выражение указывает определенную строку, то эту строку следует заключать в двойные кавычки.</td>
<td>coord="position-"+count  Здесь position- могло бы быть интерпретировано как поле или как часть математического сравнения, которое использует знаки плюс и минус. Чтобы убедиться, что строка интерпретируется правильно, position- заключается в двойные кавычки.</td>
</tr>
</tbody>
</table>
<p>Булевые выражения проходят обработку командой <strong>where</strong> в следующей
последовательности:</p>
<p><strong>NOT условие</strong></p>
<p><strong>AND условие</strong></p>
<p><strong>OR условие</strong></p>
<p>Символ регулярного выражения звездочка (wildcard) может быть использован только
в функции <strong>like()</strong>.</p>
<p>Сравнительная функция <strong>like()</strong> возвращает <em>TRUE</em> если значение поля (или
просто строка) согласуется с заданным выражением.</p>
<p>Синтаксис: <strong>like(TEXT, PATTERN)</strong></p>
<p>Аргументы функции:</p>
<ul>
<li>
<p>TEXT – строка или поле, которое проверяется.</p>
</li>
<li>
<p>PATTERN – строка-выражение, с которым сравнивается <em>TEXT</em>.</p>
<p>Можно использовать символ процент (%) для нескольких (одного и более)
строковых символов или символ подчёркивания (_) для одного символа.</p>
</li>
</ul>
<p>Символ процента ( % ) является заменой символа wildcard (<strong>*</strong>).</p>
<p>Вы можете использовать довольно широкий набор функций в команде <strong>where</strong>. Все
они представлены в таблице:</p>
<table>
<thead>
<tr>
<th><strong>Тип функции</strong></th>
<th><strong>Функции и синтаксис</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Сравнительные и условные функции</td>
<td>case(X,"Y",...), coalesce(X,...), if(X,Y,Z), like(TEXT, PATTERN), match(SUBJECT, "REGEX"), nullif(X,Y), true()</td>
</tr>
<tr>
<td>Функции конвертации</td>
<td>printf, tonumber(NUMSTR,BASE), tostring(X,Y)</td>
</tr>
<tr>
<td>Криптографические функции</td>
<td>md5(X), sha1(X)</td>
</tr>
<tr>
<td>Функции даты и времени</td>
<td>now(), relative_time(X,Y), strptime(X,Y)</td>
</tr>
<tr>
<td>Информационные функции</td>
<td>isnotnull(X), isnull(X)</td>
</tr>
<tr>
<td>Математические функции</td>
<td>abs(X), ceiling(X) или ceil(X), exp(X), floor(X), ln(X), log(X,Y), pi(), pow(X,Y), round(X,Y), sqrt(X)</td>
</tr>
<tr>
<td>Функции преобразования для мультизначений</td>
<td>mvappend(X,...), mvcount(MVFIELD), mvdedup(X), mvfind(MVFIELD,"REGEX"), mvindex(MVFIELD,STARTINDEX, ENDINDEX), mvjoin(MVFIELD,STR), mvrange(X,Y,Z), mvsort(X), mvzip(X,Y,"Z"), split(X,"Y")</td>
</tr>
<tr>
<td>Статистические функции</td>
<td><a href="#kix.1zxydq6ysi8j">max</a>(X,...), <a href="#kix.15ujkcr9n03x">min</a>(X,...)</td>
</tr>
<tr>
<td>Текстовые функции</td>
<td>len(X), lower(X), replace(X,Y,Z), substr(X,Y,Z), upper(X)</td>
</tr>
<tr>
<td>Тригонометрические и гиперболические функции</td>
<td>acos(X), asin(X), atan(X), atan2(Y, X), cos(X), hypot(X,Y), sin(X), tan(X)</td>
</tr>
</tbody>
</table>
<h3 id="_166">Примеры использования</h3>
<p>Исходные данные:</p>
<p>Имеются таблица студентов разных возрастов.</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Surname</strong></th>
<th><strong>age</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>John</td>
<td>Snow</td>
<td>10</td>
</tr>
<tr>
<td>Alex</td>
<td>Smith</td>
<td>7</td>
</tr>
<tr>
<td>Anna</td>
<td>Show</td>
<td>21</td>
</tr>
<tr>
<td>James</td>
<td>Bond</td>
<td>3</td>
</tr>
<tr>
<td>John</td>
<td>SMITH</td>
<td>19</td>
</tr>
<tr>
<td>Tony</td>
<td>Stark</td>
<td>5</td>
</tr>
<tr>
<td>John</td>
<td>Dow</td>
<td>14</td>
</tr>
<tr>
<td>Tony</td>
<td>Pitt</td>
<td>5</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Выводим всех студентов по фамилии "Smith", учитывая, что фамилии написаны в
разных регистрах.</p>
<p>Запрос:</p>
<pre><code>... | where lower(Surname)=&quot;smith&quot;
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Surname</strong></th>
<th><strong>age</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Alex</td>
<td>Smith</td>
<td>7</td>
</tr>
<tr>
<td>John</td>
<td>SMITH</td>
<td>19</td>
</tr>
</tbody>
</table>
<p><strong>Пример 2</strong></p>
<p>Выводим всех студентов старше 10 лет и с именем, начинающимся на букву "J".</p>
<p>Запрос:</p>
<pre><code>... | where age&gt;10 and like(Name,&quot;J%&quot;)
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>Name</strong></th>
<th><strong>Surname</strong></th>
<th><strong>age</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>John</td>
<td>Snow</td>
<td>10</td>
</tr>
<tr>
<td>James</td>
<td>Bond</td>
<td>3</td>
</tr>
<tr>
<td>John</td>
<td>SMITH</td>
<td>19</td>
</tr>
<tr>
<td>John</td>
<td>Dow</td>
<td>14</td>
</tr>
</tbody>
</table>
<h1 id="_167"></h1>
<h1 id="xyseries">XYSERIES</h1>
<p>Команда конвертирует результаты в табличный формат, пригодный для визуализации
результата в формате диаграммы или графика.</p>
<h3 id="_168">Синтаксис команды</h3>
<pre><code>xyseries &lt;x-field&gt; &lt;y-name-field&gt; &lt;y-data-field&gt;
</code></pre>
<p>Обязательные параметры:</p>
<ul>
<li>
<p><strong>x-field</strong> – значения поля, которые будут отложены на оси Х при рисовании
    графика. Синтаксис: <em>&lt;field></em>.</p>
</li>
<li>
<p><strong>y-name-field</strong> – значения поля, которые будут отложены на оси Y при
    рисовании графика. Синтаксис: <em>&lt;field></em>.</p>
</li>
<li>
<p><strong>y-data-field</strong> – значения поля, которые будут точками графика. <br />
    Синтаксис: <em>&lt;field></em>.</p>
</li>
</ul>
<p>Опциональные параметры: отсутствуют.</p>
<h3 id="_169">Примеры использования</h3>
<p>Исходные данные:</p>
<table>
<thead>
<tr>
<th><strong>currency</strong></th>
<th><strong>dest_country</strong></th>
<th><strong>sum</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>EUR</td>
<td>Italy</td>
<td>10</td>
</tr>
<tr>
<td>USD</td>
<td>Russia</td>
<td>13</td>
</tr>
<tr>
<td>RUB</td>
<td>Canada</td>
<td>14</td>
</tr>
<tr>
<td>EUR</td>
<td>Canada</td>
<td>1</td>
</tr>
<tr>
<td>USD</td>
<td>Russia</td>
<td>3</td>
</tr>
<tr>
<td>MXN</td>
<td>Mexico</td>
<td>7</td>
</tr>
</tbody>
</table>
<p><strong>Пример 1</strong></p>
<p>Форматирует данные к пригодному для визуализации виду. По оси Х будут отложены
значения поля <em>dest_country</em>, по оси Y значения поля <em>currency</em>, точками графика
(или диаграммы) будут значения поля <em>sum</em>. Результат может быть визуализирован,
например, в формате столбчатой диаграммы.</p>
<p>Запрос:</p>
<pre><code>| xyseries dest_country currency sum 
</code></pre>
<p>Результат:</p>
<table>
<thead>
<tr>
<th><strong>EUR</strong></th>
<th><strong>MXN</strong></th>
<th><strong>RUB</strong></th>
<th><strong>USD</strong></th>
<th><strong>dest_country</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>10</td>
<td></td>
<td></td>
<td></td>
<td>Italy</td>
</tr>
<tr>
<td></td>
<td>7</td>
<td></td>
<td></td>
<td>Mexico</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>13</td>
<td>Russia</td>
</tr>
<tr>
<td>1</td>
<td></td>
<td>14</td>
<td></td>
<td>Canada</td>
</tr>
</tbody>
</table>
<h1 id="_170"></h1>
<h1 id="_171">Приложение</h1>
<h2 id="_172">Использование макросов в запросах</h2>
<p>Реализация данной функциональности связана с оптимизацией использования в
OTL-запросах повторяющихся наборов команд. Для этих целей повторяющиеся
последовательности можно оформить в виде макросов.</p>
<h3 id="_173">Синтаксис использования макроса</h3>
<p><strong>|__&lt;имя макроса>__ &lt;аргументы макроса></strong></p>
<p><strong>_<em>&lt;имя макроса></em>_</strong> – имя макроса с двух сторон обрамляется двойным
подчёркиванием (__);</p>
<p><strong>&lt;аргументы макроса></strong> – аргументы макроса, разделённые пробелами; аргументы
могут быть следующих типов:</p>
<ul>
<li>
<p><strong>Аргументы значений:</strong></p>
<ul>
<li>
<p><em>&lt;имя поля/токена></em><strong>=</strong><em>&lt;значения через запятую></em>;</p>
</li>
<li>
<p>отсутствие аргумента/аргументов при наличии токена макрос интерпретирует
    как: absent_arg=*.</p>
</li>
</ul>
</li>
<li>
<p><strong>Аргументы времени.</strong></p>
<p>В качестве аргументов времени используются ключевые слова:</p>
<ul>
<li>
<p><strong>latest</strong> – начальная граница временного интервала;</p>
</li>
<li>
<p><strong>earliest</strong> – конечная граница временного интервала.</p>
<p>Формат даты в аргументе: YYYY-MM-DD. В процессе обработки макроса дата
преобразуется в формат Epoch time (Linux time).</p>
<p>Возможные комбинации значений аргументов:</p>
</li>
<li>
<p>earliest=2019-11-01 latest=2019-12-31 – задаёт период с 2019/11/01 по
    2019/12/31;</p>
</li>
<li>
<p>earliest=2019-11-01 – задаёт период с 2019/11/01 по настоящее время;</p>
</li>
<li>
<p>latest=2019-12-31 – задаёт период с 1970/01/01 по 2019/12/31;</p>
</li>
<li>
<p>аргументы не заданы – временное окно определяется в границах с
    1970/01/01 по настоящее время.</p>
</li>
</ul>
</li>
<li>
<p><strong>Аргументы фильтрации полей.</strong></p>
<p>В качестве аргумента указываются шаблоны поиска заданной последовательности
символов в именах полей, которые должны быть отражены в итоговой таблице
после выполнения запроса.</p>
<p>По заданным шаблонам происходит поиск имен полей в файле алиасов (см. в
разделе ниже) без учета регистра.</p>
<p>В случае отсутствия полей, удовлетворяющих условиям фильтрации, макрос
отработает по всем полям.</p>
</li>
</ul>
<p>Пример.</p>
<pre><code>      | __getwell__ wellNum=4,12,1898 padNum=4 earliest=2019-11-01 
        latest=2019-12-31 debit freq
</code></pre>
<p><strong>Имя макроса:</strong>  <em>_ _ getwell _ _</em></p>
<p><strong>Аргументы значений:</strong> <em>wellNum, padNum</em></p>
<p>аргумент wellNum=4,12,1898</p>
<p>интерпретируется как wellNum=4 OR wellNum=12 OR wellNum=1898</p>
<p><strong>Аргументы времени:</strong> <em>earliest, latest</em></p>
<p>earliest=2019-11-01 latest=2019-12-31 – аргументы задают период с 2019/11/01 по
2019/12/31</p>
<p><strong>Аргументы фильтрации полей:</strong> <em>debit</em>, <em>freq</em></p>
<p>По заданным шаблонам <em>debit</em> и <em>freq</em> будут отобраны следующие поля (см. пример
в файле алиасов ниже):</p>
<p><strong>debit</strong>:</p>
<p><em>adkuLiquid</em><strong>Debit</strong></p>
<p><em>wellopLiquid</em><strong>Debit</strong><em>TM</em></p>
<p><strong>freq</strong>:</p>
<p><em>ksADKUEngine</em><strong>Freq</strong></p>
<p><em>wellopPump</em><strong>Freq</strong><em>Tm</em></p>
<p>На выходе получим следующий текст сгенерированного запроса:</p>
<pre><code>            | table _time, wellNum, padNum, adkuLiquidDebit,
              wellopLiquidDebitTM, ksADKUEngineFreq, wellopPumpFreqTm
</code></pre>
<h3 id="_174">Конфигурационный файл макроса</h3>
<p>Конфигурационный файл макроса должен быть размещён в распределенном файловом
хранилище, путь к которому настраивается в конфигурационном файле OT.REST.</p>
<p>Файл должен содержать только один макрос.</p>
<p>В случае отсутствия аргумента в команде – строка, содержащая одноименный токен,
не будет изменена. В случае наличия лишнего аргумента - он будет проигнорирован.</p>
<p>Пример.</p>
<p><em>../macros/getwell.macros</em></p>
<pre><code>| readFile format=parquet path=omds_well_adku_v2
| search $wellNum$
| search _time&gt;=$earliest$ AND _time&lt;$latest$
| ``` Джойним номер куста и ID станции управления по ID скважины ```
| join type=inner ID [ 
  | readFile format=parquet path=oms_v5
  | fields IDObj, geoNum, Description, IDPad, IDWell
  | eval geoPad = if(Description=&quot;Pad&quot;, geoNum, null)
  | eval idKS = if(Description=&quot;controlStation&quot;, IDObj, null)
  | eventstats min(geoPad) as padNum by IDPad
  | eventstats min(idKS) as IDKs by IDWell
  | search Description=&quot;Well&quot; AND ($padNum$)
  | rename IDObj as ID
  | fields ID, padNum, IDKs ]
| ``` Джойним данные из ШТР по ID скважины ```
| join _time, ID type=outer [ 
  | readFile format=parquet path=omds_well_wellop_v15 
  | search _time&gt;=$earliest$ AND _time&lt;$latest$ 
  | table _time, ID, wellop* ]
| fields _time, ID, adku*, wellop*
| ``` Джойним данные со станции управления по ID скважины ```
| join  _time, IDKs type=outer [ 
  | readFile format=parquet path=omds_ks_v3 
  | search _time&gt;=$earliest$ AND _time&lt;$latest$ 
  | rename ID as IDKs 
  | table _time, IDKs, ks* ] 
| sort _time
</code></pre>
<h3 id="_175">Конфигурационный файл алиасов</h3>
<p>Конфигурационный файл алиасов – <em>csv-файл –</em> предназначен для установки
соответствия между именами полей в базе данных и названиями столбцов, выводимых
в пользовательские таблицы.</p>
<p>Файл размещается в распределенном файловом хранилище.</p>
<p>Макрос использует из <em>csv-</em>файла только имена полей.</p>
<p>Пример:</p>
<p><em>../macros/names.csv</em></p>
<p>adkuLiquidDebit,Дебит жидкости,3</p>
<p>adkuWellStatus,ТС Скважины,3</p>
<p>adkuTorLiquidDebit,ТОР. Дебит жидкости,3</p>
<p>adkuGazConsumption,Расход газа,3</p>
<h3 id="_176">Механизм работы</h3>
<ol>
<li>
<p>Оригинальный запрос попадает на OT.REST.</p>
</li>
<li>
<p>В оригинальном запросе выполняется поиск точек начала работы макросов,
    выполняется генерация текста запроса с учетом заданных аргументов.</p>
</li>
<li>
<p>Сформированный запрос обрабатывается аналогично обычным поисковым запросам.</p>
</li>
</ol>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            К началу
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Нижний колонтитул">
      
        
        <a href="../../../General/EVA/EVA/" class="md-footer__link md-footer__link--prev" aria-label="Назад: EVA" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Назад
              </span>
              EVA
            </div>
          </div>
        </a>
      
      
        
        <a href="../../../SMaLL/SMaLL/" class="md-footer__link md-footer__link--next" aria-label="Вперед: SMaLL" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Вперед
              </span>
              SMaLL
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["header.autohide", "navigation.sections", "navigation.indexes", "navigation.top", "navigation.tabs"], "translations": {"clipboard.copy": "\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0431\u0443\u0444\u0435\u0440", "clipboard.copied": "\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u0432 \u0431\u0443\u0444\u0435\u0440", "search.config.lang": "ru", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "\u041f\u043e\u0438\u0441\u043a", "search.result.placeholder": "\u041d\u0430\u0447\u043d\u0438\u0442\u0435 \u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430", "search.result.none": "\u0421\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e", "search.result.one": "\u041d\u0430\u0439\u0434\u0435\u043d\u043e 1 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435", "search.result.other": "\u041d\u0430\u0439\u0434\u0435\u043d\u043e \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439: #", "search.result.more.one": "\u0415\u0449\u0451 1 \u043d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435", "search.result.more.other": "\u0415\u0449\u0451 # \u043d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435", "search.result.term.missing": "\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442", "select.version.title": "\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0435\u0440\u0441\u0438\u044e"}, "search": "../../../assets/javascripts/workers/search.bd0b6b67.min.js", "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.467223ff.min.js"></script>
      
        <script src="../../../javascripts/extra.js"></script>
      
    
  </body>
</html>